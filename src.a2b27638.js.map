{"version":3,"sources":["node_modules/orderedmap/index.es.js","../src/diff.js","../src/fragment.js","../src/comparedeep.js","../src/mark.js","../src/replace.js","../src/resolvedpos.js","../src/node.js","../src/content.js","../src/schema.js","../src/from_dom.js","../src/to_dom.js","../src/map.js","../src/transform.js","../src/step.js","../src/replace_step.js","../src/structure.js","../src/mark_step.js","../src/selection.js","../src/transaction.js","../src/state.js","../src/plugin.js","../src/browser.js","../src/dom.js","../src/domcoords.js","../src/viewdesc.js","../src/capturekeys.js","../src/domchange.js","../src/clipboard.js","../src/domobserver.js","../src/input.js","../src/decoration.js","../src/index.js","node_modules/w3c-keyname/index.es.js","../src/keymap.js","node_modules/rope-sequence/dist/index.es.js","../src/history.js","../src/commands.js","../src/dropcursor.js","../src/gapcursor.js","node_modules/crelt/index.es.js","../src/icons.js","../src/menu.js","../src/menubar.js","../src/schema-list.js","../src/inputrules.js","../src/rules.js","../src/rulebuilders.js","../src/prompt.js","src/index.js","node_modules/parcel-bundler/src/builtins/bundle-url.js","node_modules/parcel-bundler/src/builtins/css-loader.js","node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["OrderedMap","content","prototype","constructor","find","key","i","length","get","found","undefined","update","value","newKey","self","remove","slice","push","splice","addToStart","concat","addToEnd","addBefore","place","without","forEach","f","prepend","map","from","size","subtract","append","result","prop","orderedmap","let","const","p","prototypeAccessors","n","prototypeAccessors$1","super","type","loop","next","states","text","mark","this","rules","name","space","d","splitting","index","match","browser","pos","box","rect","target","desc","search","j","child","anchor","tr","sel","move","span","base","shift","chrome","navigator","exec","userAgent","safari","test","vendor","gecko","mac","platform","ie","brokenModifierNames","String","fromCharCode","code","hasOwnProperty","keyName","event","ignoreKey","ctrlKey","altKey","metaKey","shiftKey","keyCode","GOOD_LEAF_SIZE","RopeSequence","other","leafAppend","leafPrepend","appendInner","Append","to","empty","sliceInner","Math","max","min","getInner","forEachInner","forEachInvertedInner","elt","values","Leaf","call","__proto__","Object","create","configurable","depth","flatten","start","defineProperties","left","right","leftLen","inner","ropeSequence","$from","$to","$cur","crelt","arguments","document","createElement","nodeType","Array","isArray","setAttribute","add","appendChild","createTextNode","RangeError","prefix","schema","Schema","marks","example","parseDOM","tag","toDOM","class","nodes","doc","paragraph","group","testDecoToDom","decoClass","side","view","getPos","el","classList","innerHTML","style","paddingLeft","paddingRight","pluginKey","PluginKey","noOfDecos","decoStartPos","MODIFY_OFFSET","DECREMENT_OFFSET","INCREMENT_OFFSET","getSide","cursorPos","offset","createPluginDecorations","state","decos","fill","_","getState","orderOffset","selection","isRange","relativeSide","Decoration","widget","random","ignoreSelection","getElementById","getDebugId","spec","toString","substring","join","DecorationSet","createPlugin","Plugin","props","decorations","init","apply","plState","oldState","newState","modifyOffset","getMeta","appendTransaction","trs","$oldCursor","$cursor","movement","setMeta","setSelection","Selection","near","createStateFromContent","plugin","EditorState","DOMParser","fromSchema","parse","plugins","menuBar","examples","root","description","docRootEl","descriptionEl","innerText","contentEl","debugEl","id","EditorView","bundleURL","getBundleURLCached","getBundleURL","Error","err","matches","stack","getBaseURL","url","replace","exports","bundle","require","updateLink","link","newLink","cloneNode","onload","href","split","Date","now","parentNode","insertBefore","nextSibling","cssTimeout","reloadCSS","setTimeout","links","querySelectorAll","module","OVERLAY_ID","OldModule","Module","moduleName","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","JSON","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","console","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","error","message","overlay","createErrorOverlay","body","stackTrace","getParents","modules","parents","k","dep","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"src.a2b27638.js","sourceRoot":"..","sourcesContent":["// ::- Persistent data structure representing an ordered mapping from\n// strings to values, with some convenient update methods.\nfunction OrderedMap(content) {\n  this.content = content;\n}\n\nOrderedMap.prototype = {\n  constructor: OrderedMap,\n\n  find: function(key) {\n    for (var i = 0; i < this.content.length; i += 2)\n      if (this.content[i] === key) return i\n    return -1\n  },\n\n  // :: (string)  ?any\n  // Retrieve the value stored under `key`, or return undefined when\n  // no such key exists.\n  get: function(key) {\n    var found = this.find(key);\n    return found == -1 ? undefined : this.content[found + 1]\n  },\n\n  // :: (string, any, ?string)  OrderedMap\n  // Create a new map by replacing the value of `key` with a new\n  // value, or adding a binding to the end of the map. If `newKey` is\n  // given, the key of the binding will be replaced with that key.\n  update: function(key, value, newKey) {\n    var self = newKey && newKey != key ? this.remove(newKey) : this;\n    var found = self.find(key), content = self.content.slice();\n    if (found == -1) {\n      content.push(newKey || key, value);\n    } else {\n      content[found + 1] = value;\n      if (newKey) content[found] = newKey;\n    }\n    return new OrderedMap(content)\n  },\n\n  // :: (string)  OrderedMap\n  // Return a map with the given key removed, if it existed.\n  remove: function(key) {\n    var found = this.find(key);\n    if (found == -1) return this\n    var content = this.content.slice();\n    content.splice(found, 2);\n    return new OrderedMap(content)\n  },\n\n  // :: (string, any)  OrderedMap\n  // Add a new key to the start of the map.\n  addToStart: function(key, value) {\n    return new OrderedMap([key, value].concat(this.remove(key).content))\n  },\n\n  // :: (string, any)  OrderedMap\n  // Add a new key to the end of the map.\n  addToEnd: function(key, value) {\n    var content = this.remove(key).content.slice();\n    content.push(key, value);\n    return new OrderedMap(content)\n  },\n\n  // :: (string, string, any)  OrderedMap\n  // Add a key after the given key. If `place` is not found, the new\n  // key is added to the end.\n  addBefore: function(place, key, value) {\n    var without = this.remove(key), content = without.content.slice();\n    var found = without.find(place);\n    content.splice(found == -1 ? content.length : found, 0, key, value);\n    return new OrderedMap(content)\n  },\n\n  // :: ((key: string, value: any))\n  // Call the given function for each key/value pair in the map, in\n  // order.\n  forEach: function(f) {\n    for (var i = 0; i < this.content.length; i += 2)\n      f(this.content[i], this.content[i + 1]);\n  },\n\n  // :: (union<Object, OrderedMap>)  OrderedMap\n  // Create a new map by prepending the keys in this map that don't\n  // appear in `map` before the keys in `map`.\n  prepend: function(map) {\n    map = OrderedMap.from(map);\n    if (!map.size) return this\n    return new OrderedMap(map.content.concat(this.subtract(map).content))\n  },\n\n  // :: (union<Object, OrderedMap>)  OrderedMap\n  // Create a new map by appending the keys in this map that don't\n  // appear in `map` after the keys in `map`.\n  append: function(map) {\n    map = OrderedMap.from(map);\n    if (!map.size) return this\n    return new OrderedMap(this.subtract(map).content.concat(map.content))\n  },\n\n  // :: (union<Object, OrderedMap>)  OrderedMap\n  // Create a map containing all the keys in this map that don't\n  // appear in `map`.\n  subtract: function(map) {\n    var result = this;\n    map = OrderedMap.from(map);\n    for (var i = 0; i < map.content.length; i += 2)\n      result = result.remove(map.content[i]);\n    return result\n  },\n\n  // :: number\n  // The amount of keys in this map.\n  get size() {\n    return this.content.length >> 1\n  }\n};\n\n// :: (?union<Object, OrderedMap>)  OrderedMap\n// Return a map with the given content. If null, create an empty\n// map. If given an ordered map, return that map itself. If given an\n// object, create a map from the object's properties.\nOrderedMap.from = function(value) {\n  if (value instanceof OrderedMap) return value\n  var content = [];\n  if (value) for (var prop in value) content.push(prop, value[prop]);\n  return new OrderedMap(content)\n};\n\nvar orderedmap = OrderedMap;\n\nexport default orderedmap;\n","export function findDiffStart(a, b, pos) {\n  for (let i = 0;; i++) {\n    if (i == a.childCount || i == b.childCount)\n      return a.childCount == b.childCount ? null : pos\n\n    let childA = a.child(i), childB = b.child(i)\n    if (childA == childB) { pos += childA.nodeSize; continue }\n\n    if (!childA.sameMarkup(childB)) return pos\n\n    if (childA.isText && childA.text != childB.text) {\n      for (let j = 0; childA.text[j] == childB.text[j]; j++)\n        pos++\n      return pos\n    }\n    if (childA.content.size || childB.content.size) {\n      let inner = findDiffStart(childA.content, childB.content, pos + 1)\n      if (inner != null) return inner\n    }\n    pos += childA.nodeSize\n  }\n}\n\nexport function findDiffEnd(a, b, posA, posB) {\n  for (let iA = a.childCount, iB = b.childCount;;) {\n    if (iA == 0 || iB == 0)\n      return iA == iB ? null : {a: posA, b: posB}\n\n    let childA = a.child(--iA), childB = b.child(--iB), size = childA.nodeSize\n    if (childA == childB) {\n      posA -= size; posB -= size\n      continue\n    }\n\n    if (!childA.sameMarkup(childB)) return {a: posA, b: posB}\n\n    if (childA.isText && childA.text != childB.text) {\n      let same = 0, minSize = Math.min(childA.text.length, childB.text.length)\n      while (same < minSize && childA.text[childA.text.length - same - 1] == childB.text[childB.text.length - same - 1]) {\n        same++; posA--; posB--\n      }\n      return {a: posA, b: posB}\n    }\n    if (childA.content.size || childB.content.size) {\n      let inner = findDiffEnd(childA.content, childB.content, posA - 1, posB - 1)\n      if (inner) return inner\n    }\n    posA -= size; posB -= size\n  }\n}\n","import {findDiffStart, findDiffEnd} from \"./diff\"\n\n// ::- A fragment represents a node's collection of child nodes.\n//\n// Like nodes, fragments are persistent data structures, and you\n// should not mutate them or their content. Rather, you create new\n// instances whenever needed. The API tries to make this easy.\nexport class Fragment {\n  constructor(content, size) {\n    this.content = content\n    // :: number\n    // The size of the fragment, which is the total of the size of its\n    // content nodes.\n    this.size = size || 0\n    if (size == null) for (let i = 0; i < content.length; i++)\n      this.size += content[i].nodeSize\n  }\n\n  // :: (number, number, (node: Node, start: number, parent: Node, index: number)  ?bool, ?number)\n  // Invoke a callback for all descendant nodes between the given two\n  // positions (relative to start of this fragment). Doesn't descend\n  // into a node when the callback returns `false`.\n  nodesBetween(from, to, f, nodeStart = 0, parent) {\n    for (let i = 0, pos = 0; pos < to; i++) {\n      let child = this.content[i], end = pos + child.nodeSize\n      if (end > from && f(child, nodeStart + pos, parent, i) !== false && child.content.size) {\n        let start = pos + 1\n        child.nodesBetween(Math.max(0, from - start),\n                           Math.min(child.content.size, to - start),\n                           f, nodeStart + start)\n      }\n      pos = end\n    }\n  }\n\n  // :: ((node: Node, pos: number, parent: Node)  ?bool)\n  // Call the given callback for every descendant node. The callback\n  // may return `false` to prevent traversal of a given node's children.\n  descendants(f) {\n    this.nodesBetween(0, this.size, f)\n  }\n\n  // : (number, number, ?string, ?string)  string\n  textBetween(from, to, blockSeparator, leafText) {\n    let text = \"\", separated = true\n    this.nodesBetween(from, to, (node, pos) => {\n      if (node.isText) {\n        text += node.text.slice(Math.max(from, pos) - pos, to - pos)\n        separated = !blockSeparator\n      } else if (node.isLeaf && leafText) {\n        text += leafText\n        separated = !blockSeparator\n      } else if (!separated && node.isBlock) {\n        text += blockSeparator\n        separated = true\n      }\n    }, 0)\n    return text\n  }\n\n  // :: (Fragment)  Fragment\n  // Create a new fragment containing the combined content of this\n  // fragment and the other.\n  append(other) {\n    if (!other.size) return this\n    if (!this.size) return other\n    let last = this.lastChild, first = other.firstChild, content = this.content.slice(), i = 0\n    if (last.isText && last.sameMarkup(first)) {\n      content[content.length - 1] = last.withText(last.text + first.text)\n      i = 1\n    }\n    for (; i < other.content.length; i++) content.push(other.content[i])\n    return new Fragment(content, this.size + other.size)\n  }\n\n  // :: (number, ?number)  Fragment\n  // Cut out the sub-fragment between the two given positions.\n  cut(from, to) {\n    if (to == null) to = this.size\n    if (from == 0 && to == this.size) return this\n    let result = [], size = 0\n    if (to > from) for (let i = 0, pos = 0; pos < to; i++) {\n      let child = this.content[i], end = pos + child.nodeSize\n      if (end > from) {\n        if (pos < from || end > to) {\n          if (child.isText)\n            child = child.cut(Math.max(0, from - pos), Math.min(child.text.length, to - pos))\n          else\n            child = child.cut(Math.max(0, from - pos - 1), Math.min(child.content.size, to - pos - 1))\n        }\n        result.push(child)\n        size += child.nodeSize\n      }\n      pos = end\n    }\n    return new Fragment(result, size)\n  }\n\n  cutByIndex(from, to) {\n    if (from == to) return Fragment.empty\n    if (from == 0 && to == this.content.length) return this\n    return new Fragment(this.content.slice(from, to))\n  }\n\n  // :: (number, Node)  Fragment\n  // Create a new fragment in which the node at the given index is\n  // replaced by the given node.\n  replaceChild(index, node) {\n    let current = this.content[index]\n    if (current == node) return this\n    let copy = this.content.slice()\n    let size = this.size + node.nodeSize - current.nodeSize\n    copy[index] = node\n    return new Fragment(copy, size)\n  }\n\n  // : (Node)  Fragment\n  // Create a new fragment by prepending the given node to this\n  // fragment.\n  addToStart(node) {\n    return new Fragment([node].concat(this.content), this.size + node.nodeSize)\n  }\n\n  // : (Node)  Fragment\n  // Create a new fragment by appending the given node to this\n  // fragment.\n  addToEnd(node) {\n    return new Fragment(this.content.concat(node), this.size + node.nodeSize)\n  }\n\n  // :: (Fragment)  bool\n  // Compare this fragment to another one.\n  eq(other) {\n    if (this.content.length != other.content.length) return false\n    for (let i = 0; i < this.content.length; i++)\n      if (!this.content[i].eq(other.content[i])) return false\n    return true\n  }\n\n  // :: ?Node\n  // The first child of the fragment, or `null` if it is empty.\n  get firstChild() { return this.content.length ? this.content[0] : null }\n\n  // :: ?Node\n  // The last child of the fragment, or `null` if it is empty.\n  get lastChild() { return this.content.length ? this.content[this.content.length - 1] : null }\n\n  // :: number\n  // The number of child nodes in this fragment.\n  get childCount() { return this.content.length }\n\n  // :: (number)  Node\n  // Get the child node at the given index. Raise an error when the\n  // index is out of range.\n  child(index) {\n    let found = this.content[index]\n    if (!found) throw new RangeError(\"Index \" + index + \" out of range for \" + this)\n    return found\n  }\n\n  // :: (number)  ?Node\n  // Get the child node at the given index, if it exists.\n  maybeChild(index) {\n    return this.content[index]\n  }\n\n  // :: ((node: Node, offset: number, index: number))\n  // Call `f` for every child node, passing the node, its offset\n  // into this parent node, and its index.\n  forEach(f) {\n    for (let i = 0, p = 0; i < this.content.length; i++) {\n      let child = this.content[i]\n      f(child, p, i)\n      p += child.nodeSize\n    }\n  }\n\n  // :: (Fragment)  ?number\n  // Find the first position at which this fragment and another\n  // fragment differ, or `null` if they are the same.\n  findDiffStart(other, pos = 0) {\n    return findDiffStart(this, other, pos)\n  }\n\n  // :: (Fragment)  ?{a: number, b: number}\n  // Find the first position, searching from the end, at which this\n  // fragment and the given fragment differ, or `null` if they are the\n  // same. Since this position will not be the same in both nodes, an\n  // object with two separate positions is returned.\n  findDiffEnd(other, pos = this.size, otherPos = other.size) {\n    return findDiffEnd(this, other, pos, otherPos)\n  }\n\n  // : (number, ?number)  {index: number, offset: number}\n  // Find the index and inner offset corresponding to a given relative\n  // position in this fragment. The result object will be reused\n  // (overwritten) the next time the function is called. (Not public.)\n  findIndex(pos, round = -1) {\n    if (pos == 0) return retIndex(0, pos)\n    if (pos == this.size) return retIndex(this.content.length, pos)\n    if (pos > this.size || pos < 0) throw new RangeError(`Position ${pos} outside of fragment (${this})`)\n    for (let i = 0, curPos = 0;; i++) {\n      let cur = this.child(i), end = curPos + cur.nodeSize\n      if (end >= pos) {\n        if (end == pos || round > 0) return retIndex(i + 1, end)\n        return retIndex(i, curPos)\n      }\n      curPos = end\n    }\n  }\n\n  // :: ()  string\n  // Return a debugging string that describes this fragment.\n  toString() { return \"<\" + this.toStringInner() + \">\" }\n\n  toStringInner() { return this.content.join(\", \") }\n\n  // :: ()  ?Object\n  // Create a JSON-serializeable representation of this fragment.\n  toJSON() {\n    return this.content.length ? this.content.map(n => n.toJSON()) : null\n  }\n\n  // :: (Schema, ?Object)  Fragment\n  // Deserialize a fragment from its JSON representation.\n  static fromJSON(schema, value) {\n    if (!value) return Fragment.empty\n    if (!Array.isArray(value)) throw new RangeError(\"Invalid input for Fragment.fromJSON\")\n    return new Fragment(value.map(schema.nodeFromJSON))\n  }\n\n  // :: ([Node])  Fragment\n  // Build a fragment from an array of nodes. Ensures that adjacent\n  // text nodes with the same marks are joined together.\n  static fromArray(array) {\n    if (!array.length) return Fragment.empty\n    let joined, size = 0\n    for (let i = 0; i < array.length; i++) {\n      let node = array[i]\n      size += node.nodeSize\n      if (i && node.isText && array[i - 1].sameMarkup(node)) {\n        if (!joined) joined = array.slice(0, i)\n        joined[joined.length - 1] = node.withText(joined[joined.length - 1].text + node.text)\n      } else if (joined) {\n        joined.push(node)\n      }\n    }\n    return new Fragment(joined || array, size)\n  }\n\n  // :: (?union<Fragment, Node, [Node]>)  Fragment\n  // Create a fragment from something that can be interpreted as a set\n  // of nodes. For `null`, it returns the empty fragment. For a\n  // fragment, the fragment itself. For a node or array of nodes, a\n  // fragment containing those nodes.\n  static from(nodes) {\n    if (!nodes) return Fragment.empty\n    if (nodes instanceof Fragment) return nodes\n    if (Array.isArray(nodes)) return this.fromArray(nodes)\n    if (nodes.attrs) return new Fragment([nodes], nodes.nodeSize)\n    throw new RangeError(\"Can not convert \" + nodes + \" to a Fragment\" +\n                         (nodes.nodesBetween ? \" (looks like multiple versions of prosemirror-model were loaded)\" : \"\"))\n  }\n}\n\nconst found = {index: 0, offset: 0}\nfunction retIndex(index, offset) {\n  found.index = index\n  found.offset = offset\n  return found\n}\n\n// :: Fragment\n// An empty fragment. Intended to be reused whenever a node doesn't\n// contain anything (rather than allocating a new empty fragment for\n// each leaf node).\nFragment.empty = new Fragment([], 0)\n","export function compareDeep(a, b) {\n  if (a === b) return true\n  if (!(a && typeof a == \"object\") ||\n      !(b && typeof b == \"object\")) return false\n  let array = Array.isArray(a)\n  if (Array.isArray(b) != array) return false\n  if (array) {\n    if (a.length != b.length) return false\n    for (let i = 0; i < a.length; i++) if (!compareDeep(a[i], b[i])) return false\n  } else {\n    for (let p in a) if (!(p in b) || !compareDeep(a[p], b[p])) return false\n    for (let p in b) if (!(p in a)) return false\n  }\n  return true\n}\n","import {compareDeep} from \"./comparedeep\"\n\n// ::- A mark is a piece of information that can be attached to a node,\n// such as it being emphasized, in code font, or a link. It has a type\n// and optionally a set of attributes that provide further information\n// (such as the target of the link). Marks are created through a\n// `Schema`, which controls which types exist and which\n// attributes they have.\nexport class Mark {\n  constructor(type, attrs) {\n    // :: MarkType\n    // The type of this mark.\n    this.type = type\n    // :: Object\n    // The attributes associated with this mark.\n    this.attrs = attrs\n  }\n\n  // :: ([Mark])  [Mark]\n  // Given a set of marks, create a new set which contains this one as\n  // well, in the right position. If this mark is already in the set,\n  // the set itself is returned. If any marks that are set to be\n  // [exclusive](#model.MarkSpec.excludes) with this mark are present,\n  // those are replaced by this one.\n  addToSet(set) {\n    let copy, placed = false\n    for (let i = 0; i < set.length; i++) {\n      let other = set[i]\n      if (this.eq(other)) return set\n      if (this.type.excludes(other.type)) {\n        if (!copy) copy = set.slice(0, i)\n      } else if (other.type.excludes(this.type)) {\n        return set\n      } else {\n        if (!placed && other.type.rank > this.type.rank) {\n          if (!copy) copy = set.slice(0, i)\n          copy.push(this)\n          placed = true\n        }\n        if (copy) copy.push(other)\n      }\n    }\n    if (!copy) copy = set.slice()\n    if (!placed) copy.push(this)\n    return copy\n  }\n\n  // :: ([Mark])  [Mark]\n  // Remove this mark from the given set, returning a new set. If this\n  // mark is not in the set, the set itself is returned.\n  removeFromSet(set) {\n    for (let i = 0; i < set.length; i++)\n      if (this.eq(set[i]))\n        return set.slice(0, i).concat(set.slice(i + 1))\n    return set\n  }\n\n  // :: ([Mark])  bool\n  // Test whether this mark is in the given set of marks.\n  isInSet(set) {\n    for (let i = 0; i < set.length; i++)\n      if (this.eq(set[i])) return true\n    return false\n  }\n\n  // :: (Mark)  bool\n  // Test whether this mark has the same type and attributes as\n  // another mark.\n  eq(other) {\n    return this == other ||\n      (this.type == other.type && compareDeep(this.attrs, other.attrs))\n  }\n\n  // :: ()  Object\n  // Convert this mark to a JSON-serializeable representation.\n  toJSON() {\n    let obj = {type: this.type.name}\n    for (let _ in this.attrs) {\n      obj.attrs = this.attrs\n      break\n    }\n    return obj\n  }\n\n  // :: (Schema, Object)  Mark\n  static fromJSON(schema, json) {\n    if (!json) throw new RangeError(\"Invalid input for Mark.fromJSON\")\n    let type = schema.marks[json.type]\n    if (!type) throw new RangeError(`There is no mark type ${json.type} in this schema`)\n    return type.create(json.attrs)\n  }\n\n  // :: ([Mark], [Mark])  bool\n  // Test whether two sets of marks are identical.\n  static sameSet(a, b) {\n    if (a == b) return true\n    if (a.length != b.length) return false\n    for (let i = 0; i < a.length; i++)\n      if (!a[i].eq(b[i])) return false\n    return true\n  }\n\n  // :: (?union<Mark, [Mark]>)  [Mark]\n  // Create a properly sorted mark set from null, a single mark, or an\n  // unsorted array of marks.\n  static setFrom(marks) {\n    if (!marks || marks.length == 0) return Mark.none\n    if (marks instanceof Mark) return [marks]\n    let copy = marks.slice()\n    copy.sort((a, b) => a.type.rank - b.type.rank)\n    return copy\n  }\n}\n\n// :: [Mark] The empty set of marks.\nMark.none = []\n","import {Fragment} from \"./fragment\"\n\n// ReplaceError:: class extends Error\n// Error type raised by [`Node.replace`](#model.Node.replace) when\n// given an invalid replacement.\n\nexport function ReplaceError(message) {\n  let err = Error.call(this, message)\n  err.__proto__ = ReplaceError.prototype\n  return err\n}\n\nReplaceError.prototype = Object.create(Error.prototype)\nReplaceError.prototype.constructor = ReplaceError\nReplaceError.prototype.name = \"ReplaceError\"\n\n// ::- A slice represents a piece cut out of a larger document. It\n// stores not only a fragment, but also the depth up to which nodes on\n// both side are open (cut through).\nexport class Slice {\n  // :: (Fragment, number, number)\n  // Create a slice. When specifying a non-zero open depth, you must\n  // make sure that there are nodes of at least that depth at the\n  // appropriate side of the fragmenti.e. if the fragment is an empty\n  // paragraph node, `openStart` and `openEnd` can't be greater than 1.\n  //\n  // It is not necessary for the content of open nodes to conform to\n  // the schema's content constraints, though it should be a valid\n  // start/end/middle for such a node, depending on which sides are\n  // open.\n  constructor(content, openStart, openEnd) {\n    // :: Fragment The slice's content.\n    this.content = content\n    // :: number The open depth at the start.\n    this.openStart = openStart\n    // :: number The open depth at the end.\n    this.openEnd = openEnd\n  }\n\n  // :: number\n  // The size this slice would add when inserted into a document.\n  get size() {\n    return this.content.size - this.openStart - this.openEnd\n  }\n\n  insertAt(pos, fragment) {\n    let content = insertInto(this.content, pos + this.openStart, fragment, null)\n    return content && new Slice(content, this.openStart, this.openEnd)\n  }\n\n  removeBetween(from, to) {\n    return new Slice(removeRange(this.content, from + this.openStart, to + this.openStart), this.openStart, this.openEnd)\n  }\n\n  // :: (Slice)  bool\n  // Tests whether this slice is equal to another slice.\n  eq(other) {\n    return this.content.eq(other.content) && this.openStart == other.openStart && this.openEnd == other.openEnd\n  }\n\n  toString() {\n    return this.content + \"(\" + this.openStart + \",\" + this.openEnd + \")\"\n  }\n\n  // :: ()  ?Object\n  // Convert a slice to a JSON-serializable representation.\n  toJSON() {\n    if (!this.content.size) return null\n    let json = {content: this.content.toJSON()}\n    if (this.openStart > 0) json.openStart = this.openStart\n    if (this.openEnd > 0) json.openEnd = this.openEnd\n    return json\n  }\n\n  // :: (Schema, ?Object)  Slice\n  // Deserialize a slice from its JSON representation.\n  static fromJSON(schema, json) {\n    if (!json) return Slice.empty\n    let openStart = json.openStart || 0, openEnd = json.openEnd || 0\n    if (typeof openStart != \"number\" || typeof openEnd != \"number\")\n      throw new RangeError(\"Invalid input for Slice.fromJSON\")\n    return new Slice(Fragment.fromJSON(schema, json.content), json.openStart || 0, json.openEnd || 0)\n  }\n\n  // :: (Fragment, ?bool)  Slice\n  // Create a slice from a fragment by taking the maximum possible\n  // open value on both side of the fragment.\n  static maxOpen(fragment, openIsolating=true) {\n    let openStart = 0, openEnd = 0\n    for (let n = fragment.firstChild; n && !n.isLeaf && (openIsolating || !n.type.spec.isolating); n = n.firstChild) openStart++\n    for (let n = fragment.lastChild; n && !n.isLeaf && (openIsolating || !n.type.spec.isolating); n = n.lastChild) openEnd++\n    return new Slice(fragment, openStart, openEnd)\n  }\n}\n\nfunction removeRange(content, from, to) {\n  let {index, offset} = content.findIndex(from), child = content.maybeChild(index)\n  let {index: indexTo, offset: offsetTo} = content.findIndex(to)\n  if (offset == from || child.isText) {\n    if (offsetTo != to && !content.child(indexTo).isText) throw new RangeError(\"Removing non-flat range\")\n    return content.cut(0, from).append(content.cut(to))\n  }\n  if (index != indexTo) throw new RangeError(\"Removing non-flat range\")\n  return content.replaceChild(index, child.copy(removeRange(child.content, from - offset - 1, to - offset - 1)))\n}\n\nfunction insertInto(content, dist, insert, parent) {\n  let {index, offset} = content.findIndex(dist), child = content.maybeChild(index)\n  if (offset == dist || child.isText) {\n    if (parent && !parent.canReplace(index, index, insert)) return null\n    return content.cut(0, dist).append(insert).append(content.cut(dist))\n  }\n  let inner = insertInto(child.content, dist - offset - 1, insert)\n  return inner && content.replaceChild(index, child.copy(inner))\n}\n\n// :: Slice\n// The empty slice.\nSlice.empty = new Slice(Fragment.empty, 0, 0)\n\nexport function replace($from, $to, slice) {\n  if (slice.openStart > $from.depth)\n    throw new ReplaceError(\"Inserted content deeper than insertion position\")\n  if ($from.depth - slice.openStart != $to.depth - slice.openEnd)\n    throw new ReplaceError(\"Inconsistent open depths\")\n  return replaceOuter($from, $to, slice, 0)\n}\n\nfunction replaceOuter($from, $to, slice, depth) {\n  let index = $from.index(depth), node = $from.node(depth)\n  if (index == $to.index(depth) && depth < $from.depth - slice.openStart) {\n    let inner = replaceOuter($from, $to, slice, depth + 1)\n    return node.copy(node.content.replaceChild(index, inner))\n  } else if (!slice.content.size) {\n    return close(node, replaceTwoWay($from, $to, depth))\n  } else if (!slice.openStart && !slice.openEnd && $from.depth == depth && $to.depth == depth) { // Simple, flat case\n    let parent = $from.parent, content = parent.content\n    return close(parent, content.cut(0, $from.parentOffset).append(slice.content).append(content.cut($to.parentOffset)))\n  } else {\n    let {start, end} = prepareSliceForReplace(slice, $from)\n    return close(node, replaceThreeWay($from, start, end, $to, depth))\n  }\n}\n\nfunction checkJoin(main, sub) {\n  if (!sub.type.compatibleContent(main.type))\n    throw new ReplaceError(\"Cannot join \" + sub.type.name + \" onto \" + main.type.name)\n}\n\nfunction joinable($before, $after, depth) {\n  let node = $before.node(depth)\n  checkJoin(node, $after.node(depth))\n  return node\n}\n\nfunction addNode(child, target) {\n  let last = target.length - 1\n  if (last >= 0 && child.isText && child.sameMarkup(target[last]))\n    target[last] = child.withText(target[last].text + child.text)\n  else\n    target.push(child)\n}\n\nfunction addRange($start, $end, depth, target) {\n  let node = ($end || $start).node(depth)\n  let startIndex = 0, endIndex = $end ? $end.index(depth) : node.childCount\n  if ($start) {\n    startIndex = $start.index(depth)\n    if ($start.depth > depth) {\n      startIndex++\n    } else if ($start.textOffset) {\n      addNode($start.nodeAfter, target)\n      startIndex++\n    }\n  }\n  for (let i = startIndex; i < endIndex; i++) addNode(node.child(i), target)\n  if ($end && $end.depth == depth && $end.textOffset)\n    addNode($end.nodeBefore, target)\n}\n\nfunction close(node, content) {\n  if (!node.type.validContent(content))\n    throw new ReplaceError(\"Invalid content for node \" + node.type.name)\n  return node.copy(content)\n}\n\nfunction replaceThreeWay($from, $start, $end, $to, depth) {\n  let openStart = $from.depth > depth && joinable($from, $start, depth + 1)\n  let openEnd = $to.depth > depth && joinable($end, $to, depth + 1)\n\n  let content = []\n  addRange(null, $from, depth, content)\n  if (openStart && openEnd && $start.index(depth) == $end.index(depth)) {\n    checkJoin(openStart, openEnd)\n    addNode(close(openStart, replaceThreeWay($from, $start, $end, $to, depth + 1)), content)\n  } else {\n    if (openStart)\n      addNode(close(openStart, replaceTwoWay($from, $start, depth + 1)), content)\n    addRange($start, $end, depth, content)\n    if (openEnd)\n      addNode(close(openEnd, replaceTwoWay($end, $to, depth + 1)), content)\n  }\n  addRange($to, null, depth, content)\n  return new Fragment(content)\n}\n\nfunction replaceTwoWay($from, $to, depth) {\n  let content = []\n  addRange(null, $from, depth, content)\n  if ($from.depth > depth) {\n    let type = joinable($from, $to, depth + 1)\n    addNode(close(type, replaceTwoWay($from, $to, depth + 1)), content)\n  }\n  addRange($to, null, depth, content)\n  return new Fragment(content)\n}\n\nfunction prepareSliceForReplace(slice, $along) {\n  let extra = $along.depth - slice.openStart, parent = $along.node(extra)\n  let node = parent.copy(slice.content)\n  for (let i = extra - 1; i >= 0; i--)\n    node = $along.node(i).copy(Fragment.from(node))\n  return {start: node.resolveNoCache(slice.openStart + extra),\n          end: node.resolveNoCache(node.content.size - slice.openEnd - extra)}\n}\n","import {Mark} from \"./mark\"\n\n// ::- You can [_resolve_](#model.Node.resolve) a position to get more\n// information about it. Objects of this class represent such a\n// resolved position, providing various pieces of context information,\n// and some helper methods.\n//\n// Throughout this interface, methods that take an optional `depth`\n// parameter will interpret undefined as `this.depth` and negative\n// numbers as `this.depth + value`.\nexport class ResolvedPos {\n  constructor(pos, path, parentOffset) {\n    // :: number The position that was resolved.\n    this.pos = pos\n    this.path = path\n    // :: number\n    // The number of levels the parent node is from the root. If this\n    // position points directly into the root node, it is 0. If it\n    // points into a top-level paragraph, 1, and so on.\n    this.depth = path.length / 3 - 1\n    // :: number The offset this position has into its parent node.\n    this.parentOffset = parentOffset\n  }\n\n  resolveDepth(val) {\n    if (val == null) return this.depth\n    if (val < 0) return this.depth + val\n    return val\n  }\n\n  // :: Node\n  // The parent node that the position points into. Note that even if\n  // a position points into a text node, that node is not considered\n  // the parenttext nodes are flat in this model, and have no content.\n  get parent() { return this.node(this.depth) }\n\n  // :: Node\n  // The root node in which the position was resolved.\n  get doc() { return this.node(0) }\n\n  // :: (?number)  Node\n  // The ancestor node at the given level. `p.node(p.depth)` is the\n  // same as `p.parent`.\n  node(depth) { return this.path[this.resolveDepth(depth) * 3] }\n\n  // :: (?number)  number\n  // The index into the ancestor at the given level. If this points at\n  // the 3rd node in the 2nd paragraph on the top level, for example,\n  // `p.index(0)` is 1 and `p.index(1)` is 2.\n  index(depth) { return this.path[this.resolveDepth(depth) * 3 + 1] }\n\n  // :: (?number)  number\n  // The index pointing after this position into the ancestor at the\n  // given level.\n  indexAfter(depth) {\n    depth = this.resolveDepth(depth)\n    return this.index(depth) + (depth == this.depth && !this.textOffset ? 0 : 1)\n  }\n\n  // :: (?number)  number\n  // The (absolute) position at the start of the node at the given\n  // level.\n  start(depth) {\n    depth = this.resolveDepth(depth)\n    return depth == 0 ? 0 : this.path[depth * 3 - 1] + 1\n  }\n\n  // :: (?number)  number\n  // The (absolute) position at the end of the node at the given\n  // level.\n  end(depth) {\n    depth = this.resolveDepth(depth)\n    return this.start(depth) + this.node(depth).content.size\n  }\n\n  // :: (?number)  number\n  // The (absolute) position directly before the wrapping node at the\n  // given level, or, when `depth` is `this.depth + 1`, the original\n  // position.\n  before(depth) {\n    depth = this.resolveDepth(depth)\n    if (!depth) throw new RangeError(\"There is no position before the top-level node\")\n    return depth == this.depth + 1 ? this.pos : this.path[depth * 3 - 1]\n  }\n\n  // :: (?number)  number\n  // The (absolute) position directly after the wrapping node at the\n  // given level, or the original position when `depth` is `this.depth + 1`.\n  after(depth) {\n    depth = this.resolveDepth(depth)\n    if (!depth) throw new RangeError(\"There is no position after the top-level node\")\n    return depth == this.depth + 1 ? this.pos : this.path[depth * 3 - 1] + this.path[depth * 3].nodeSize\n  }\n\n  // :: number\n  // When this position points into a text node, this returns the\n  // distance between the position and the start of the text node.\n  // Will be zero for positions that point between nodes.\n  get textOffset() { return this.pos - this.path[this.path.length - 1] }\n\n  // :: ?Node\n  // Get the node directly after the position, if any. If the position\n  // points into a text node, only the part of that node after the\n  // position is returned.\n  get nodeAfter() {\n    let parent = this.parent, index = this.index(this.depth)\n    if (index == parent.childCount) return null\n    let dOff = this.pos - this.path[this.path.length - 1], child = parent.child(index)\n    return dOff ? parent.child(index).cut(dOff) : child\n  }\n\n  // :: ?Node\n  // Get the node directly before the position, if any. If the\n  // position points into a text node, only the part of that node\n  // before the position is returned.\n  get nodeBefore() {\n    let index = this.index(this.depth)\n    let dOff = this.pos - this.path[this.path.length - 1]\n    if (dOff) return this.parent.child(index).cut(0, dOff)\n    return index == 0 ? null : this.parent.child(index - 1)\n  }\n\n  // :: ()  [Mark]\n  // Get the marks at this position, factoring in the surrounding\n  // marks' [`inclusive`](#model.MarkSpec.inclusive) property. If the\n  // position is at the start of a non-empty node, the marks of the\n  // node after it (if any) are returned.\n  marks() {\n    let parent = this.parent, index = this.index()\n\n    // In an empty parent, return the empty array\n    if (parent.content.size == 0) return Mark.none\n\n    // When inside a text node, just return the text node's marks\n    if (this.textOffset) return parent.child(index).marks\n\n    let main = parent.maybeChild(index - 1), other = parent.maybeChild(index)\n    // If the `after` flag is true of there is no node before, make\n    // the node after this position the main reference.\n    if (!main) { let tmp = main; main = other; other = tmp }\n\n    // Use all marks in the main node, except those that have\n    // `inclusive` set to false and are not present in the other node.\n    let marks = main.marks\n    for (var i = 0; i < marks.length; i++)\n      if (marks[i].type.spec.inclusive === false && (!other || !marks[i].isInSet(other.marks)))\n        marks = marks[i--].removeFromSet(marks)\n\n    return marks\n  }\n\n  // :: (ResolvedPos)  ?[Mark]\n  // Get the marks after the current position, if any, except those\n  // that are non-inclusive and not present at position `$end`. This\n  // is mostly useful for getting the set of marks to preserve after a\n  // deletion. Will return `null` if this position is at the end of\n  // its parent node or its parent node isn't a textblock (in which\n  // case no marks should be preserved).\n  marksAcross($end) {\n    let after = this.parent.maybeChild(this.index())\n    if (!after || !after.isInline) return null\n\n    let marks = after.marks, next = $end.parent.maybeChild($end.index())\n    for (var i = 0; i < marks.length; i++)\n      if (marks[i].type.spec.inclusive === false && (!next || !marks[i].isInSet(next.marks)))\n        marks = marks[i--].removeFromSet(marks)\n    return marks\n  }\n\n  // :: (number)  number\n  // The depth up to which this position and the given (non-resolved)\n  // position share the same parent nodes.\n  sharedDepth(pos) {\n    for (let depth = this.depth; depth > 0; depth--)\n      if (this.start(depth) <= pos && this.end(depth) >= pos) return depth\n    return 0\n  }\n\n  // :: (?ResolvedPos, ?(Node)  bool)  ?NodeRange\n  // Returns a range based on the place where this position and the\n  // given position diverge around block content. If both point into\n  // the same textblock, for example, a range around that textblock\n  // will be returned. If they point into different blocks, the range\n  // around those blocks in their shared ancestor is returned. You can\n  // pass in an optional predicate that will be called with a parent\n  // node to see if a range into that parent is acceptable.\n  blockRange(other = this, pred) {\n    if (other.pos < this.pos) return other.blockRange(this)\n    for (let d = this.depth - (this.parent.inlineContent || this.pos == other.pos ? 1 : 0); d >= 0; d--)\n      if (other.pos <= this.end(d) && (!pred || pred(this.node(d))))\n        return new NodeRange(this, other, d)\n  }\n\n  // :: (ResolvedPos)  bool\n  // Query whether the given position shares the same parent node.\n  sameParent(other) {\n    return this.pos - this.parentOffset == other.pos - other.parentOffset\n  }\n\n  // :: (ResolvedPos)  ResolvedPos\n  // Return the greater of this and the given position.\n  max(other) {\n    return other.pos > this.pos ? other : this\n  }\n\n  // :: (ResolvedPos)  ResolvedPos\n  // Return the smaller of this and the given position.\n  min(other) {\n    return other.pos < this.pos ? other : this\n  }\n\n  toString() {\n    let str = \"\"\n    for (let i = 1; i <= this.depth; i++)\n      str += (str ? \"/\" : \"\") + this.node(i).type.name + \"_\" + this.index(i - 1)\n    return str + \":\" + this.parentOffset\n  }\n\n  static resolve(doc, pos) {\n    if (!(pos >= 0 && pos <= doc.content.size)) throw new RangeError(\"Position \" + pos + \" out of range\")\n    let path = []\n    let start = 0, parentOffset = pos\n    for (let node = doc;;) {\n      let {index, offset} = node.content.findIndex(parentOffset)\n      let rem = parentOffset - offset\n      path.push(node, index, start + offset)\n      if (!rem) break\n      node = node.child(index)\n      if (node.isText) break\n      parentOffset = rem - 1\n      start += offset + 1\n    }\n    return new ResolvedPos(pos, path, parentOffset)\n  }\n\n  static resolveCached(doc, pos) {\n    for (let i = 0; i < resolveCache.length; i++) {\n      let cached = resolveCache[i]\n      if (cached.pos == pos && cached.doc == doc) return cached\n    }\n    let result = resolveCache[resolveCachePos] = ResolvedPos.resolve(doc, pos)\n    resolveCachePos = (resolveCachePos + 1) % resolveCacheSize\n    return result\n  }\n}\n\nlet resolveCache = [], resolveCachePos = 0, resolveCacheSize = 12\n\n// ::- Represents a flat range of content, i.e. one that starts and\n// ends in the same node.\nexport class NodeRange {\n  // :: (ResolvedPos, ResolvedPos, number)\n  // Construct a node range. `$from` and `$to` should point into the\n  // same node until at least the given `depth`, since a node range\n  // denotes an adjacent set of nodes in a single parent node.\n  constructor($from, $to, depth) {\n    // :: ResolvedPos A resolved position along the start of the\n    // content. May have a `depth` greater than this object's `depth`\n    // property, since these are the positions that were used to\n    // compute the range, not re-resolved positions directly at its\n    // boundaries.\n    this.$from = $from\n    // :: ResolvedPos A position along the end of the content. See\n    // caveat for [`$from`](#model.NodeRange.$from).\n    this.$to = $to\n    // :: number The depth of the node that this range points into.\n    this.depth = depth\n  }\n\n  // :: number The position at the start of the range.\n  get start() { return this.$from.before(this.depth + 1) }\n  // :: number The position at the end of the range.\n  get end() { return this.$to.after(this.depth + 1) }\n\n  // :: Node The parent node that the range points into.\n  get parent() { return this.$from.node(this.depth) }\n  // :: number The start index of the range in the parent node.\n  get startIndex() { return this.$from.index(this.depth) }\n  // :: number The end index of the range in the parent node.\n  get endIndex() { return this.$to.indexAfter(this.depth) }\n}\n","import {Fragment} from \"./fragment\"\nimport {Mark} from \"./mark\"\nimport {Slice, replace} from \"./replace\"\nimport {ResolvedPos} from \"./resolvedpos\"\nimport {compareDeep} from \"./comparedeep\"\n\nconst emptyAttrs = Object.create(null)\n\n// ::- This class represents a node in the tree that makes up a\n// ProseMirror document. So a document is an instance of `Node`, with\n// children that are also instances of `Node`.\n//\n// Nodes are persistent data structures. Instead of changing them, you\n// create new ones with the content you want. Old ones keep pointing\n// at the old document shape. This is made cheaper by sharing\n// structure between the old and new data as much as possible, which a\n// tree shape like this (without back pointers) makes easy.\n//\n// **Do not** directly mutate the properties of a `Node` object. See\n// [the guide](/docs/guide/#doc) for more information.\nexport class Node {\n  constructor(type, attrs, content, marks) {\n    // :: NodeType\n    // The type of node that this is.\n    this.type = type\n\n    // :: Object\n    // An object mapping attribute names to values. The kind of\n    // attributes allowed and required are\n    // [determined](#model.NodeSpec.attrs) by the node type.\n    this.attrs = attrs\n\n    // :: Fragment\n    // A container holding the node's children.\n    this.content = content || Fragment.empty\n\n    // :: [Mark]\n    // The marks (things like whether it is emphasized or part of a\n    // link) applied to this node.\n    this.marks = marks || Mark.none\n  }\n\n  // text:: ?string\n  // For text nodes, this contains the node's text content.\n\n  // :: number\n  // The size of this node, as defined by the integer-based [indexing\n  // scheme](/docs/guide/#doc.indexing). For text nodes, this is the\n  // amount of characters. For other leaf nodes, it is one. For\n  // non-leaf nodes, it is the size of the content plus two (the start\n  // and end token).\n  get nodeSize() { return this.isLeaf ? 1 : 2 + this.content.size }\n\n  // :: number\n  // The number of children that the node has.\n  get childCount() { return this.content.childCount }\n\n  // :: (number)  Node\n  // Get the child node at the given index. Raises an error when the\n  // index is out of range.\n  child(index) { return this.content.child(index) }\n\n  // :: (number)  ?Node\n  // Get the child node at the given index, if it exists.\n  maybeChild(index) { return this.content.maybeChild(index) }\n\n  // :: ((node: Node, offset: number, index: number))\n  // Call `f` for every child node, passing the node, its offset\n  // into this parent node, and its index.\n  forEach(f) { this.content.forEach(f) }\n\n  // :: (number, number, (node: Node, pos: number, parent: Node, index: number)  ?bool, ?number)\n  // Invoke a callback for all descendant nodes recursively between\n  // the given two positions that are relative to start of this node's\n  // content. The callback is invoked with the node, its\n  // parent-relative position, its parent node, and its child index.\n  // When the callback returns false for a given node, that node's\n  // children will not be recursed over. The last parameter can be\n  // used to specify a starting position to count from.\n  nodesBetween(from, to, f, startPos = 0) {\n    this.content.nodesBetween(from, to, f, startPos, this)\n  }\n\n  // :: ((node: Node, pos: number, parent: Node)  ?bool)\n  // Call the given callback for every descendant node. Doesn't\n  // descend into a node when the callback returns `false`.\n  descendants(f) {\n    this.nodesBetween(0, this.content.size, f)\n  }\n\n  // :: string\n  // Concatenates all the text nodes found in this fragment and its\n  // children.\n  get textContent() { return this.textBetween(0, this.content.size, \"\") }\n\n  // :: (number, number, ?string, ?string)  string\n  // Get all text between positions `from` and `to`. When\n  // `blockSeparator` is given, it will be inserted whenever a new\n  // block node is started. When `leafText` is given, it'll be\n  // inserted for every non-text leaf node encountered.\n  textBetween(from, to, blockSeparator, leafText) {\n    return this.content.textBetween(from, to, blockSeparator, leafText)\n  }\n\n  // :: ?Node\n  // Returns this node's first child, or `null` if there are no\n  // children.\n  get firstChild() { return this.content.firstChild }\n\n  // :: ?Node\n  // Returns this node's last child, or `null` if there are no\n  // children.\n  get lastChild() { return this.content.lastChild }\n\n  // :: (Node)  bool\n  // Test whether two nodes represent the same piece of document.\n  eq(other) {\n    return this == other || (this.sameMarkup(other) && this.content.eq(other.content))\n  }\n\n  // :: (Node)  bool\n  // Compare the markup (type, attributes, and marks) of this node to\n  // those of another. Returns `true` if both have the same markup.\n  sameMarkup(other) {\n    return this.hasMarkup(other.type, other.attrs, other.marks)\n  }\n\n  // :: (NodeType, ?Object, ?[Mark])  bool\n  // Check whether this node's markup correspond to the given type,\n  // attributes, and marks.\n  hasMarkup(type, attrs, marks) {\n    return this.type == type &&\n      compareDeep(this.attrs, attrs || type.defaultAttrs || emptyAttrs) &&\n      Mark.sameSet(this.marks, marks || Mark.none)\n  }\n\n  // :: (?Fragment)  Node\n  // Create a new node with the same markup as this node, containing\n  // the given content (or empty, if no content is given).\n  copy(content = null) {\n    if (content == this.content) return this\n    return new this.constructor(this.type, this.attrs, content, this.marks)\n  }\n\n  // :: ([Mark])  Node\n  // Create a copy of this node, with the given set of marks instead\n  // of the node's own marks.\n  mark(marks) {\n    return marks == this.marks ? this : new this.constructor(this.type, this.attrs, this.content, marks)\n  }\n\n  // :: (number, ?number)  Node\n  // Create a copy of this node with only the content between the\n  // given positions. If `to` is not given, it defaults to the end of\n  // the node.\n  cut(from, to) {\n    if (from == 0 && to == this.content.size) return this\n    return this.copy(this.content.cut(from, to))\n  }\n\n  // :: (number, ?number)  Slice\n  // Cut out the part of the document between the given positions, and\n  // return it as a `Slice` object.\n  slice(from, to = this.content.size, includeParents = false) {\n    if (from == to) return Slice.empty\n\n    let $from = this.resolve(from), $to = this.resolve(to)\n    let depth = includeParents ? 0 : $from.sharedDepth(to)\n    let start = $from.start(depth), node = $from.node(depth)\n    let content = node.content.cut($from.pos - start, $to.pos - start)\n    return new Slice(content, $from.depth - depth, $to.depth - depth)\n  }\n\n  // :: (number, number, Slice)  Node\n  // Replace the part of the document between the given positions with\n  // the given slice. The slice must 'fit', meaning its open sides\n  // must be able to connect to the surrounding content, and its\n  // content nodes must be valid children for the node they are placed\n  // into. If any of this is violated, an error of type\n  // [`ReplaceError`](#model.ReplaceError) is thrown.\n  replace(from, to, slice) {\n    return replace(this.resolve(from), this.resolve(to), slice)\n  }\n\n  // :: (number)  ?Node\n  // Find the node directly after the given position.\n  nodeAt(pos) {\n    for (let node = this;;) {\n      let {index, offset} = node.content.findIndex(pos)\n      node = node.maybeChild(index)\n      if (!node) return null\n      if (offset == pos || node.isText) return node\n      pos -= offset + 1\n    }\n  }\n\n  // :: (number)  {node: ?Node, index: number, offset: number}\n  // Find the (direct) child node after the given offset, if any,\n  // and return it along with its index and offset relative to this\n  // node.\n  childAfter(pos) {\n    let {index, offset} = this.content.findIndex(pos)\n    return {node: this.content.maybeChild(index), index, offset}\n  }\n\n  // :: (number)  {node: ?Node, index: number, offset: number}\n  // Find the (direct) child node before the given offset, if any,\n  // and return it along with its index and offset relative to this\n  // node.\n  childBefore(pos) {\n    if (pos == 0) return {node: null, index: 0, offset: 0}\n    let {index, offset} = this.content.findIndex(pos)\n    if (offset < pos) return {node: this.content.child(index), index, offset}\n    let node = this.content.child(index - 1)\n    return {node, index: index - 1, offset: offset - node.nodeSize}\n  }\n\n  // :: (number)  ResolvedPos\n  // Resolve the given position in the document, returning an\n  // [object](#model.ResolvedPos) with information about its context.\n  resolve(pos) { return ResolvedPos.resolveCached(this, pos) }\n\n  resolveNoCache(pos) { return ResolvedPos.resolve(this, pos) }\n\n  // :: (number, number, MarkType)  bool\n  // Test whether a mark of the given type occurs in this document\n  // between the two given positions.\n  rangeHasMark(from, to, type) {\n    let found = false\n    if (to > from) this.nodesBetween(from, to, node => {\n      if (type.isInSet(node.marks)) found = true\n      return !found\n    })\n    return found\n  }\n\n  // :: bool\n  // True when this is a block (non-inline node)\n  get isBlock() { return this.type.isBlock }\n\n  // :: bool\n  // True when this is a textblock node, a block node with inline\n  // content.\n  get isTextblock() { return this.type.isTextblock }\n\n  // :: bool\n  // True when this node allows inline content.\n  get inlineContent() { return this.type.inlineContent }\n\n  // :: bool\n  // True when this is an inline node (a text node or a node that can\n  // appear among text).\n  get isInline() { return this.type.isInline }\n\n  // :: bool\n  // True when this is a text node.\n  get isText() { return this.type.isText }\n\n  // :: bool\n  // True when this is a leaf node.\n  get isLeaf() { return this.type.isLeaf }\n\n  // :: bool\n  // True when this is an atom, i.e. when it does not have directly\n  // editable content. This is usually the same as `isLeaf`, but can\n  // be configured with the [`atom` property](#model.NodeSpec.atom) on\n  // a node's spec (typically used when the node is displayed as an\n  // uneditable [node view](#view.NodeView)).\n  get isAtom() { return this.type.isAtom }\n\n  // :: ()  string\n  // Return a string representation of this node for debugging\n  // purposes.\n  toString() {\n    if (this.type.spec.toDebugString) return this.type.spec.toDebugString(this)\n    let name = this.type.name\n    if (this.content.size)\n      name += \"(\" + this.content.toStringInner() + \")\"\n    return wrapMarks(this.marks, name)\n  }\n\n  // :: (number)  ContentMatch\n  // Get the content match in this node at the given index.\n  contentMatchAt(index) {\n    let match = this.type.contentMatch.matchFragment(this.content, 0, index)\n    if (!match) throw new Error(\"Called contentMatchAt on a node with invalid content\")\n    return match\n  }\n\n  // :: (number, number, ?Fragment, ?number, ?number)  bool\n  // Test whether replacing the range between `from` and `to` (by\n  // child index) with the given replacement fragment (which defaults\n  // to the empty fragment) would leave the node's content valid. You\n  // can optionally pass `start` and `end` indices into the\n  // replacement fragment.\n  canReplace(from, to, replacement = Fragment.empty, start = 0, end = replacement.childCount) {\n    let one = this.contentMatchAt(from).matchFragment(replacement, start, end)\n    let two = one && one.matchFragment(this.content, to)\n    if (!two || !two.validEnd) return false\n    for (let i = start; i < end; i++) if (!this.type.allowsMarks(replacement.child(i).marks)) return false\n    return true\n  }\n\n  // :: (number, number, NodeType, ?[Mark])  bool\n  // Test whether replacing the range `from` to `to` (by index) with a\n  // node of the given type would leave the node's content valid.\n  canReplaceWith(from, to, type, marks) {\n    if (marks && !this.type.allowsMarks(marks)) return false\n    let start = this.contentMatchAt(from).matchType(type)\n    let end = start && start.matchFragment(this.content, to)\n    return end ? end.validEnd : false\n  }\n\n  // :: (Node)  bool\n  // Test whether the given node's content could be appended to this\n  // node. If that node is empty, this will only return true if there\n  // is at least one node type that can appear in both nodes (to avoid\n  // merging completely incompatible nodes).\n  canAppend(other) {\n    if (other.content.size) return this.canReplace(this.childCount, this.childCount, other.content)\n    else return this.type.compatibleContent(other.type)\n  }\n\n  // :: ()\n  // Check whether this node and its descendants conform to the\n  // schema, and raise error when they do not.\n  check() {\n    if (!this.type.validContent(this.content))\n      throw new RangeError(`Invalid content for node ${this.type.name}: ${this.content.toString().slice(0, 50)}`)\n    this.content.forEach(node => node.check())\n  }\n\n  // :: ()  Object\n  // Return a JSON-serializeable representation of this node.\n  toJSON() {\n    let obj = {type: this.type.name}\n    for (let _ in this.attrs) {\n      obj.attrs = this.attrs\n      break\n    }\n    if (this.content.size)\n      obj.content = this.content.toJSON()\n    if (this.marks.length)\n      obj.marks = this.marks.map(n => n.toJSON())\n    return obj\n  }\n\n  // :: (Schema, Object)  Node\n  // Deserialize a node from its JSON representation.\n  static fromJSON(schema, json) {\n    if (!json) throw new RangeError(\"Invalid input for Node.fromJSON\")\n    let marks = null\n    if (json.marks) {\n      if (!Array.isArray(json.marks)) throw new RangeError(\"Invalid mark data for Node.fromJSON\")\n      marks = json.marks.map(schema.markFromJSON)\n    }\n    if (json.type == \"text\") {\n      if (typeof json.text != \"string\") throw new RangeError(\"Invalid text node in JSON\")\n      return schema.text(json.text, marks)\n    }\n    let content = Fragment.fromJSON(schema, json.content)\n    return schema.nodeType(json.type).create(json.attrs, content, marks)\n  }\n}\n\nexport class TextNode extends Node {\n  constructor(type, attrs, content, marks) {\n    super(type, attrs, null, marks)\n\n    if (!content) throw new RangeError(\"Empty text nodes are not allowed\")\n\n    this.text = content\n  }\n\n  toString() {\n    if (this.type.spec.toDebugString) return this.type.spec.toDebugString(this)\n    return wrapMarks(this.marks, JSON.stringify(this.text))\n  }\n\n  get textContent() { return this.text }\n\n  textBetween(from, to) { return this.text.slice(from, to) }\n\n  get nodeSize() { return this.text.length }\n\n  mark(marks) {\n    return marks == this.marks ? this : new TextNode(this.type, this.attrs, this.text, marks)\n  }\n\n  withText(text) {\n    if (text == this.text) return this\n    return new TextNode(this.type, this.attrs, text, this.marks)\n  }\n\n  cut(from = 0, to = this.text.length) {\n    if (from == 0 && to == this.text.length) return this\n    return this.withText(this.text.slice(from, to))\n  }\n\n  eq(other) {\n    return this.sameMarkup(other) && this.text == other.text\n  }\n\n  toJSON() {\n    let base = super.toJSON()\n    base.text = this.text\n    return base\n  }\n}\n\nfunction wrapMarks(marks, str) {\n  for (let i = marks.length - 1; i >= 0; i--)\n    str = marks[i].type.name + \"(\" + str + \")\"\n  return str\n}\n","import {Fragment} from \"./fragment\"\n\n// ::- Instances of this class represent a match state of a node\n// type's [content expression](#model.NodeSpec.content), and can be\n// used to find out whether further content matches here, and whether\n// a given position is a valid end of the node.\nexport class ContentMatch {\n  constructor(validEnd) {\n    // :: bool\n    // True when this match state represents a valid end of the node.\n    this.validEnd = validEnd\n    this.next = []\n    this.wrapCache = []\n  }\n\n  static parse(string, nodeTypes) {\n    let stream = new TokenStream(string, nodeTypes)\n    if (stream.next == null) return ContentMatch.empty\n    let expr = parseExpr(stream)\n    if (stream.next) stream.err(\"Unexpected trailing text\")\n    let match = dfa(nfa(expr))\n    checkForDeadEnds(match, stream)\n    return match\n  }\n\n  // :: (NodeType)  ?ContentMatch\n  // Match a node type, returning a match after that node if\n  // successful.\n  matchType(type) {\n    for (let i = 0; i < this.next.length; i += 2)\n      if (this.next[i] == type) return this.next[i + 1]\n    return null\n  }\n\n  // :: (Fragment, ?number, ?number)  ?ContentMatch\n  // Try to match a fragment. Returns the resulting match when\n  // successful.\n  matchFragment(frag, start = 0, end = frag.childCount) {\n    let cur = this\n    for (let i = start; cur && i < end; i++)\n      cur = cur.matchType(frag.child(i).type)\n    return cur\n  }\n\n  get inlineContent() {\n    let first = this.next[0]\n    return first ? first.isInline : false\n  }\n\n  // :: ?NodeType\n  // Get the first matching node type at this match position that can\n  // be generated.\n  get defaultType() {\n    for (let i = 0; i < this.next.length; i += 2) {\n      let type = this.next[i]\n      if (!(type.isText || type.hasRequiredAttrs())) return type\n    }\n  }\n\n  compatible(other) {\n    for (let i = 0; i < this.next.length; i += 2)\n      for (let j = 0; j < other.next.length; j += 2)\n        if (this.next[i] == other.next[j]) return true\n    return false\n  }\n\n  // :: (Fragment, bool, ?number)  ?Fragment\n  // Try to match the given fragment, and if that fails, see if it can\n  // be made to match by inserting nodes in front of it. When\n  // successful, return a fragment of inserted nodes (which may be\n  // empty if nothing had to be inserted). When `toEnd` is true, only\n  // return a fragment if the resulting match goes to the end of the\n  // content expression.\n  fillBefore(after, toEnd = false, startIndex = 0) {\n    let seen = [this]\n    function search(match, types) {\n      let finished = match.matchFragment(after, startIndex)\n      if (finished && (!toEnd || finished.validEnd))\n        return Fragment.from(types.map(tp => tp.createAndFill()))\n\n      for (let i = 0; i < match.next.length; i += 2) {\n        let type = match.next[i], next = match.next[i + 1]\n        if (!(type.isText || type.hasRequiredAttrs()) && seen.indexOf(next) == -1) {\n          seen.push(next)\n          let found = search(next, types.concat(type))\n          if (found) return found\n        }\n      }\n    }\n\n    return search(this, [])\n  }\n\n  // :: (NodeType)  ?[NodeType]\n  // Find a set of wrapping node types that would allow a node of the\n  // given type to appear at this position. The result may be empty\n  // (when it fits directly) and will be null when no such wrapping\n  // exists.\n  findWrapping(target) {\n    for (let i = 0; i < this.wrapCache.length; i += 2)\n      if (this.wrapCache[i] == target) return this.wrapCache[i + 1]\n    let computed = this.computeWrapping(target)\n    this.wrapCache.push(target, computed)\n    return computed\n  }\n\n  computeWrapping(target) {\n    let seen = Object.create(null), active = [{match: this, type: null, via: null}]\n    while (active.length) {\n      let current = active.shift(), match = current.match\n      if (match.matchType(target)) {\n        let result = []\n        for (let obj = current; obj.type; obj = obj.via)\n          result.push(obj.type)\n        return result.reverse()\n      }\n      for (let i = 0; i < match.next.length; i += 2) {\n        let type = match.next[i]\n        if (!type.isLeaf && !type.hasRequiredAttrs() && !(type.name in seen) && (!current.type || match.next[i + 1].validEnd)) {\n          active.push({match: type.contentMatch, type, via: current})\n          seen[type.name] = true\n        }\n      }\n    }\n  }\n\n  // :: number\n  // The number of outgoing edges this node has in the finite\n  // automaton that describes the content expression.\n  get edgeCount() {\n    return this.next.length >> 1\n  }\n\n  // :: (number)  {type: NodeType, next: ContentMatch}\n  // Get the _n_th outgoing edge from this node in the finite\n  // automaton that describes the content expression.\n  edge(n) {\n    let i = n << 1\n    if (i >= this.next.length) throw new RangeError(`There's no ${n}th edge in this content match`)\n    return {type: this.next[i], next: this.next[i + 1]}\n  }\n\n  toString() {\n    let seen = []\n    function scan(m) {\n      seen.push(m)\n      for (let i = 1; i < m.next.length; i += 2)\n        if (seen.indexOf(m.next[i]) == -1) scan(m.next[i])\n    }\n    scan(this)\n    return seen.map((m, i) => {\n      let out = i + (m.validEnd ? \"*\" : \" \") + \" \"\n      for (let i = 0; i < m.next.length; i += 2)\n        out += (i ? \", \" : \"\") + m.next[i].name + \"->\" + seen.indexOf(m.next[i + 1])\n      return out\n    }).join(\"\\n\")\n  }\n}\n\nContentMatch.empty = new ContentMatch(true)\n\nclass TokenStream {\n  constructor(string, nodeTypes) {\n    this.string = string\n    this.nodeTypes = nodeTypes\n    this.inline = null\n    this.pos = 0\n    this.tokens = string.split(/\\s*(?=\\b|\\W|$)/)\n    if (this.tokens[this.tokens.length - 1] == \"\") this.tokens.pop()\n    if (this.tokens[0] == \"\") this.tokens.unshift()\n  }\n\n  get next() { return this.tokens[this.pos] }\n\n  eat(tok) { return this.next == tok && (this.pos++ || true) }\n\n  err(str) { throw new SyntaxError(str + \" (in content expression '\" + this.string + \"')\") }\n}\n\nfunction parseExpr(stream) {\n  let exprs = []\n  do { exprs.push(parseExprSeq(stream)) }\n  while (stream.eat(\"|\"))\n  return exprs.length == 1 ? exprs[0] : {type: \"choice\", exprs}\n}\n\nfunction parseExprSeq(stream) {\n  let exprs = []\n  do { exprs.push(parseExprSubscript(stream)) }\n  while (stream.next && stream.next != \")\" && stream.next != \"|\")\n  return exprs.length == 1 ? exprs[0] : {type: \"seq\", exprs}\n}\n\nfunction parseExprSubscript(stream) {\n  let expr = parseExprAtom(stream)\n  for (;;) {\n    if (stream.eat(\"+\"))\n      expr = {type: \"plus\", expr}\n    else if (stream.eat(\"*\"))\n      expr = {type: \"star\", expr}\n    else if (stream.eat(\"?\"))\n      expr = {type: \"opt\", expr}\n    else if (stream.eat(\"{\"))\n      expr = parseExprRange(stream, expr)\n    else break\n  }\n  return expr\n}\n\nfunction parseNum(stream) {\n  if (/\\D/.test(stream.next)) stream.err(\"Expected number, got '\" + stream.next + \"'\")\n  let result = Number(stream.next)\n  stream.pos++\n  return result\n}\n\nfunction parseExprRange(stream, expr) {\n  let min = parseNum(stream), max = min\n  if (stream.eat(\",\")) {\n    if (stream.next != \"}\") max = parseNum(stream)\n    else max = -1\n  }\n  if (!stream.eat(\"}\")) stream.err(\"Unclosed braced range\")\n  return {type: \"range\", min, max, expr}\n}\n\nfunction resolveName(stream, name) {\n  let types = stream.nodeTypes, type = types[name]\n  if (type) return [type]\n  let result = []\n  for (let typeName in types) {\n    let type = types[typeName]\n    if (type.groups.indexOf(name) > -1) result.push(type)\n  }\n  if (result.length == 0) stream.err(\"No node type or group '\" + name + \"' found\")\n  return result\n}\n\nfunction parseExprAtom(stream) {\n  if (stream.eat(\"(\")) {\n    let expr = parseExpr(stream)\n    if (!stream.eat(\")\")) stream.err(\"Missing closing paren\")\n    return expr\n  } else if (!/\\W/.test(stream.next)) {\n    let exprs = resolveName(stream, stream.next).map(type => {\n      if (stream.inline == null) stream.inline = type.isInline\n      else if (stream.inline != type.isInline) stream.err(\"Mixing inline and block content\")\n      return {type: \"name\", value: type}\n    })\n    stream.pos++\n    return exprs.length == 1 ? exprs[0] : {type: \"choice\", exprs}\n  } else {\n    stream.err(\"Unexpected token '\" + stream.next + \"'\")\n  }\n}\n\n// The code below helps compile a regular-expression-like language\n// into a deterministic finite automaton. For a good introduction to\n// these concepts, see https://swtch.com/~rsc/regexp/regexp1.html\n\n// : (Object)  [[{term: ?any, to: number}]]\n// Construct an NFA from an expression as returned by the parser. The\n// NFA is represented as an array of states, which are themselves\n// arrays of edges, which are `{term, to}` objects. The first state is\n// the entry state and the last node is the success state.\n//\n// Note that unlike typical NFAs, the edge ordering in this one is\n// significant, in that it is used to contruct filler content when\n// necessary.\nfunction nfa(expr) {\n  let nfa = [[]]\n  connect(compile(expr, 0), node())\n  return nfa\n\n  function node() { return nfa.push([]) - 1 }\n  function edge(from, to, term) {\n    let edge = {term, to}\n    nfa[from].push(edge)\n    return edge\n  }\n  function connect(edges, to) { edges.forEach(edge => edge.to = to) }\n\n  function compile(expr, from) {\n    if (expr.type == \"choice\") {\n      return expr.exprs.reduce((out, expr) => out.concat(compile(expr, from)), [])\n    } else if (expr.type == \"seq\") {\n      for (let i = 0;; i++) {\n        let next = compile(expr.exprs[i], from)\n        if (i == expr.exprs.length - 1) return next\n        connect(next, from = node())\n      }\n    } else if (expr.type == \"star\") {\n      let loop = node()\n      edge(from, loop)\n      connect(compile(expr.expr, loop), loop)\n      return [edge(loop)]\n    } else if (expr.type == \"plus\") {\n      let loop = node()\n      connect(compile(expr.expr, from), loop)\n      connect(compile(expr.expr, loop), loop)\n      return [edge(loop)]\n    } else if (expr.type == \"opt\") {\n      return [edge(from)].concat(compile(expr.expr, from))\n    } else if (expr.type == \"range\") {\n      let cur = from\n      for (let i = 0; i < expr.min; i++) {\n        let next = node()\n        connect(compile(expr.expr, cur), next)\n        cur = next\n      }\n      if (expr.max == -1) {\n        connect(compile(expr.expr, cur), cur)\n      } else {\n        for (let i = expr.min; i < expr.max; i++) {\n          let next = node()\n          edge(cur, next)\n          connect(compile(expr.expr, cur), next)\n          cur = next\n        }\n      }\n      return [edge(cur)]\n    } else if (expr.type == \"name\") {\n      return [edge(from, null, expr.value)]\n    }\n  }\n}\n\nfunction cmp(a, b) { return b - a }\n\n// Get the set of nodes reachable by null edges from `node`. Omit\n// nodes with only a single null-out-edge, since they may lead to\n// needless duplicated nodes.\nfunction nullFrom(nfa, node) {\n  let result = []\n  scan(node)\n  return result.sort(cmp)\n\n  function scan(node) {\n    let edges = nfa[node]\n    if (edges.length == 1 && !edges[0].term) return scan(edges[0].to)\n    result.push(node)\n    for (let i = 0; i < edges.length; i++) {\n      let {term, to} = edges[i]\n      if (!term && result.indexOf(to) == -1) scan(to)\n    }\n  }\n}\n\n// : ([[{term: ?any, to: number}]])  ContentMatch\n// Compiles an NFA as produced by `nfa` into a DFA, modeled as a set\n// of state objects (`ContentMatch` instances) with transitions\n// between them.\nfunction dfa(nfa) {\n  let labeled = Object.create(null)\n  return explore(nullFrom(nfa, 0))\n\n  function explore(states) {\n    let out = []\n    states.forEach(node => {\n      nfa[node].forEach(({term, to}) => {\n        if (!term) return\n        let known = out.indexOf(term), set = known > -1 && out[known + 1]\n        nullFrom(nfa, to).forEach(node => {\n          if (!set) out.push(term, set = [])\n          if (set.indexOf(node) == -1) set.push(node)\n        })\n      })\n    })\n    let state = labeled[states.join(\",\")] = new ContentMatch(states.indexOf(nfa.length - 1) > -1)\n    for (let i = 0; i < out.length; i += 2) {\n      let states = out[i + 1].sort(cmp)\n      state.next.push(out[i], labeled[states.join(\",\")] || explore(states))\n    }\n    return state\n  }\n}\n\nfunction checkForDeadEnds(match, stream) {\n  for (let i = 0, work = [match]; i < work.length; i++) {\n    let state = work[i], dead = !state.validEnd, nodes = []\n    for (let j = 0; j < state.next.length; j += 2) {\n      let node = state.next[j], next = state.next[j + 1]\n      nodes.push(node.name)\n      if (dead && !(node.isText || node.hasRequiredAttrs())) dead = false\n      if (work.indexOf(next) == -1) work.push(next)\n    }\n    if (dead) stream.err(\"Only non-generatable nodes (\" + nodes.join(\", \") + \") in a required position\")\n  }\n}\n","import OrderedMap from \"orderedmap\"\n\nimport {Node, TextNode} from \"./node\"\nimport {Fragment} from \"./fragment\"\nimport {Mark} from \"./mark\"\nimport {ContentMatch} from \"./content\"\n\n// For node types where all attrs have a default value (or which don't\n// have any attributes), build up a single reusable default attribute\n// object, and use it for all nodes that don't specify specific\n// attributes.\nfunction defaultAttrs(attrs) {\n  let defaults = Object.create(null)\n  for (let attrName in attrs) {\n    let attr = attrs[attrName]\n    if (!attr.hasDefault) return null\n    defaults[attrName] = attr.default\n  }\n  return defaults\n}\n\nfunction computeAttrs(attrs, value) {\n  let built = Object.create(null)\n  for (let name in attrs) {\n    let given = value && value[name]\n    if (given === undefined) {\n      let attr = attrs[name]\n      if (attr.hasDefault) given = attr.default\n      else throw new RangeError(\"No value supplied for attribute \" + name)\n    }\n    built[name] = given\n  }\n  return built\n}\n\nfunction initAttrs(attrs) {\n  let result = Object.create(null)\n  if (attrs) for (let name in attrs) result[name] = new Attribute(attrs[name])\n  return result\n}\n\n// ::- Node types are objects allocated once per `Schema` and used to\n// [tag](#model.Node.type) `Node` instances. They contain information\n// about the node type, such as its name and what kind of node it\n// represents.\nexport class NodeType {\n  constructor(name, schema, spec) {\n    // :: string\n    // The name the node type has in this schema.\n    this.name = name\n\n    // :: Schema\n    // A link back to the `Schema` the node type belongs to.\n    this.schema = schema\n\n    // :: NodeSpec\n    // The spec that this type is based on\n    this.spec = spec\n\n    this.groups = spec.group ? spec.group.split(\" \") : []\n    this.attrs = initAttrs(spec.attrs)\n\n    this.defaultAttrs = defaultAttrs(this.attrs)\n\n    // :: ContentMatch\n    // The starting match of the node type's content expression.\n    this.contentMatch = null\n\n    // : ?[MarkType]\n    // The set of marks allowed in this node. `null` means all marks\n    // are allowed.\n    this.markSet = null\n\n    // :: bool\n    // True if this node type has inline content.\n    this.inlineContent = null\n\n    // :: bool\n    // True if this is a block type\n    this.isBlock = !(spec.inline || name == \"text\")\n\n    // :: bool\n    // True if this is the text node type.\n    this.isText = name == \"text\"\n  }\n\n  // :: bool\n  // True if this is an inline type.\n  get isInline() { return !this.isBlock }\n\n  // :: bool\n  // True if this is a textblock type, a block that contains inline\n  // content.\n  get isTextblock() { return this.isBlock && this.inlineContent }\n\n  // :: bool\n  // True for node types that allow no content.\n  get isLeaf() { return this.contentMatch == ContentMatch.empty }\n\n  // :: bool\n  // True when this node is an atom, i.e. when it does not have\n  // directly editable content.\n  get isAtom() { return this.isLeaf || this.spec.atom }\n\n  // :: ()  bool\n  // Tells you whether this node type has any required attributes.\n  hasRequiredAttrs() {\n    for (let n in this.attrs) if (this.attrs[n].isRequired) return true\n    return false\n  }\n\n  compatibleContent(other) {\n    return this == other || this.contentMatch.compatible(other.contentMatch)\n  }\n\n  computeAttrs(attrs) {\n    if (!attrs && this.defaultAttrs) return this.defaultAttrs\n    else return computeAttrs(this.attrs, attrs)\n  }\n\n  // :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark])  Node\n  // Create a `Node` of this type. The given attributes are\n  // checked and defaulted (you can pass `null` to use the type's\n  // defaults entirely, if no required attributes exist). `content`\n  // may be a `Fragment`, a node, an array of nodes, or\n  // `null`. Similarly `marks` may be `null` to default to the empty\n  // set of marks.\n  create(attrs, content, marks) {\n    if (this.isText) throw new Error(\"NodeType.create can't construct text nodes\")\n    return new Node(this, this.computeAttrs(attrs), Fragment.from(content), Mark.setFrom(marks))\n  }\n\n  // :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark])  Node\n  // Like [`create`](#model.NodeType.create), but check the given content\n  // against the node type's content restrictions, and throw an error\n  // if it doesn't match.\n  createChecked(attrs, content, marks) {\n    content = Fragment.from(content)\n    if (!this.validContent(content))\n      throw new RangeError(\"Invalid content for node \" + this.name)\n    return new Node(this, this.computeAttrs(attrs), content, Mark.setFrom(marks))\n  }\n\n  // :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark])  ?Node\n  // Like [`create`](#model.NodeType.create), but see if it is necessary to\n  // add nodes to the start or end of the given fragment to make it\n  // fit the node. If no fitting wrapping can be found, return null.\n  // Note that, due to the fact that required nodes can always be\n  // created, this will always succeed if you pass null or\n  // `Fragment.empty` as content.\n  createAndFill(attrs, content, marks) {\n    attrs = this.computeAttrs(attrs)\n    content = Fragment.from(content)\n    if (content.size) {\n      let before = this.contentMatch.fillBefore(content)\n      if (!before) return null\n      content = before.append(content)\n    }\n    let after = this.contentMatch.matchFragment(content).fillBefore(Fragment.empty, true)\n    if (!after) return null\n    return new Node(this, attrs, content.append(after), Mark.setFrom(marks))\n  }\n\n  // :: (Fragment)  bool\n  // Returns true if the given fragment is valid content for this node\n  // type with the given attributes.\n  validContent(content) {\n    let result = this.contentMatch.matchFragment(content)\n    if (!result || !result.validEnd) return false\n    for (let i = 0; i < content.childCount; i++)\n      if (!this.allowsMarks(content.child(i).marks)) return false\n    return true\n  }\n\n  // :: (MarkType)  bool\n  // Check whether the given mark type is allowed in this node.\n  allowsMarkType(markType) {\n    return this.markSet == null || this.markSet.indexOf(markType) > -1\n  }\n\n  // :: ([Mark])  bool\n  // Test whether the given set of marks are allowed in this node.\n  allowsMarks(marks) {\n    if (this.markSet == null) return true\n    for (let i = 0; i < marks.length; i++) if (!this.allowsMarkType(marks[i].type)) return false\n    return true\n  }\n\n  // :: ([Mark])  [Mark]\n  // Removes the marks that are not allowed in this node from the given set.\n  allowedMarks(marks) {\n    if (this.markSet == null) return marks\n    let copy\n    for (let i = 0; i < marks.length; i++) {\n      if (!this.allowsMarkType(marks[i].type)) {\n        if (!copy) copy = marks.slice(0, i)\n      } else if (copy) {\n        copy.push(marks[i])\n      }\n    }\n    return !copy ? marks : copy.length ? copy : Mark.empty\n  }\n\n  static compile(nodes, schema) {\n    let result = Object.create(null)\n    nodes.forEach((name, spec) => result[name] = new NodeType(name, schema, spec))\n\n    let topType = schema.spec.topNode || \"doc\"\n    if (!result[topType]) throw new RangeError(\"Schema is missing its top node type ('\" + topType + \"')\")\n    if (!result.text) throw new RangeError(\"Every schema needs a 'text' type\")\n    for (let _ in result.text.attrs) throw new RangeError(\"The text node type should not have attributes\")\n\n    return result\n  }\n}\n\n// Attribute descriptors\n\nclass Attribute {\n  constructor(options) {\n    this.hasDefault = Object.prototype.hasOwnProperty.call(options, \"default\")\n    this.default = options.default\n  }\n\n  get isRequired() {\n    return !this.hasDefault\n  }\n}\n\n// Marks\n\n// ::- Like nodes, marks (which are associated with nodes to signify\n// things like emphasis or being part of a link) are\n// [tagged](#model.Mark.type) with type objects, which are\n// instantiated once per `Schema`.\nexport class MarkType {\n  constructor(name, rank, schema, spec) {\n    // :: string\n    // The name of the mark type.\n    this.name = name\n\n    // :: Schema\n    // The schema that this mark type instance is part of.\n    this.schema = schema\n\n    // :: MarkSpec\n    // The spec on which the type is based.\n    this.spec = spec\n\n    this.attrs = initAttrs(spec.attrs)\n\n    this.rank = rank\n    this.excluded = null\n    let defaults = defaultAttrs(this.attrs)\n    this.instance = defaults && new Mark(this, defaults)\n  }\n\n  // :: (?Object)  Mark\n  // Create a mark of this type. `attrs` may be `null` or an object\n  // containing only some of the mark's attributes. The others, if\n  // they have defaults, will be added.\n  create(attrs) {\n    if (!attrs && this.instance) return this.instance\n    return new Mark(this, computeAttrs(this.attrs, attrs))\n  }\n\n  static compile(marks, schema) {\n    let result = Object.create(null), rank = 0\n    marks.forEach((name, spec) => result[name] = new MarkType(name, rank++, schema, spec))\n    return result\n  }\n\n  // :: ([Mark])  [Mark]\n  // When there is a mark of this type in the given set, a new set\n  // without it is returned. Otherwise, the input set is returned.\n  removeFromSet(set) {\n    for (var i = 0; i < set.length; i++)\n      if (set[i].type == this)\n        return set.slice(0, i).concat(set.slice(i + 1))\n    return set\n  }\n\n  // :: ([Mark])  ?Mark\n  // Tests whether there is a mark of this type in the given set.\n  isInSet(set) {\n    for (let i = 0; i < set.length; i++)\n      if (set[i].type == this) return set[i]\n  }\n\n  // :: (MarkType)  bool\n  // Queries whether a given mark type is\n  // [excluded](#model.MarkSpec.excludes) by this one.\n  excludes(other) {\n    return this.excluded.indexOf(other) > -1\n  }\n}\n\n// SchemaSpec:: interface\n// An object describing a schema, as passed to the [`Schema`](#model.Schema)\n// constructor.\n//\n//   nodes:: union<Object<NodeSpec>, OrderedMap<NodeSpec>>\n//   The node types in this schema. Maps names to\n//   [`NodeSpec`](#model.NodeSpec) objects that describe the node type\n//   associated with that name. Their order is significantit\n//   determines which [parse rules](#model.NodeSpec.parseDOM) take\n//   precedence by default, and which nodes come first in a given\n//   [group](#model.NodeSpec.group).\n//\n//   marks:: ?union<Object<MarkSpec>, OrderedMap<MarkSpec>>\n//   The mark types that exist in this schema. The order in which they\n//   are provided determines the order in which [mark\n//   sets](#model.Mark.addToSet) are sorted and in which [parse\n//   rules](#model.MarkSpec.parseDOM) are tried.\n//\n//   topNode:: ?string\n//   The name of the default top-level node for the schema. Defaults\n//   to `\"doc\"`.\n\n// NodeSpec:: interface\n//\n//   content:: ?string\n//   The content expression for this node, as described in the [schema\n//   guide](/docs/guide/#schema.content_expressions). When not given,\n//   the node does not allow any content.\n//\n//   marks:: ?string\n//   The marks that are allowed inside of this node. May be a\n//   space-separated string referring to mark names or groups, `\"_\"`\n//   to explicitly allow all marks, or `\"\"` to disallow marks. When\n//   not given, nodes with inline content default to allowing all\n//   marks, other nodes default to not allowing marks.\n//\n//   group:: ?string\n//   The group or space-separated groups to which this node belongs,\n//   which can be referred to in the content expressions for the\n//   schema.\n//\n//   inline:: ?bool\n//   Should be set to true for inline nodes. (Implied for text nodes.)\n//\n//   atom:: ?bool\n//   Can be set to true to indicate that, though this isn't a [leaf\n//   node](#model.NodeType.isLeaf), it doesn't have directly editable\n//   content and should be treated as a single unit in the view.\n//\n//   attrs:: ?Object<AttributeSpec>\n//   The attributes that nodes of this type get.\n//\n//   selectable:: ?bool\n//   Controls whether nodes of this type can be selected as a [node\n//   selection](#state.NodeSelection). Defaults to true for non-text\n//   nodes.\n//\n//   draggable:: ?bool\n//   Determines whether nodes of this type can be dragged without\n//   being selected. Defaults to false.\n//\n//   code:: ?bool\n//   Can be used to indicate that this node contains code, which\n//   causes some commands to behave differently.\n//\n//   defining:: ?bool\n//   Determines whether this node is considered an important parent\n//   node during replace operations (such as paste). Non-defining (the\n//   default) nodes get dropped when their entire content is replaced,\n//   whereas defining nodes persist and wrap the inserted content.\n//   Likewise, in _inserted_ content the defining parents of the\n//   content are preserved when possible. Typically,\n//   non-default-paragraph textblock types, and possibly list items,\n//   are marked as defining.\n//\n//   isolating:: ?bool\n//   When enabled (default is false), the sides of nodes of this type\n//   count as boundaries that regular editing operations, like\n//   backspacing or lifting, won't cross. An example of a node that\n//   should probably have this enabled is a table cell.\n//\n//   toDOM:: ?(node: Node)  DOMOutputSpec\n//   Defines the default way a node of this type should be serialized\n//   to DOM/HTML (as used by\n//   [`DOMSerializer.fromSchema`](#model.DOMSerializer^fromSchema)).\n//   Should return a DOM node or an [array\n//   structure](#model.DOMOutputSpec) that describes one, with an\n//   optional number zero (hole) in it to indicate where the node's\n//   content should be inserted.\n//\n//   For text nodes, the default is to create a text DOM node. Though\n//   it is possible to create a serializer where text is rendered\n//   differently, this is not supported inside the editor, so you\n//   shouldn't override that in your text node spec.\n//\n//   parseDOM:: ?[ParseRule]\n//   Associates DOM parser information with this node, which can be\n//   used by [`DOMParser.fromSchema`](#model.DOMParser^fromSchema) to\n//   automatically derive a parser. The `node` field in the rules is\n//   implied (the name of this node will be filled in automatically).\n//   If you supply your own parser, you do not need to also specify\n//   parsing rules in your schema.\n//\n//   toDebugString:: ?(node: Node) -> string\n//   Defines the default way a node of this type should be serialized\n//   to a string representation for debugging (e.g. in error messages).\n\n// MarkSpec:: interface\n//\n//   attrs:: ?Object<AttributeSpec>\n//   The attributes that marks of this type get.\n//\n//   inclusive:: ?bool\n//   Whether this mark should be active when the cursor is positioned\n//   at its end (or at its start when that is also the start of the\n//   parent node). Defaults to true.\n//\n//   excludes:: ?string\n//   Determines which other marks this mark can coexist with. Should\n//   be a space-separated strings naming other marks or groups of marks.\n//   When a mark is [added](#model.Mark.addToSet) to a set, all marks\n//   that it excludes are removed in the process. If the set contains\n//   any mark that excludes the new mark but is not, itself, excluded\n//   by the new mark, the mark can not be added an the set. You can\n//   use the value `\"_\"` to indicate that the mark excludes all\n//   marks in the schema.\n//\n//   Defaults to only being exclusive with marks of the same type. You\n//   can set it to an empty string (or any string not containing the\n//   mark's own name) to allow multiple marks of a given type to\n//   coexist (as long as they have different attributes).\n//\n//   group:: ?string\n//   The group or space-separated groups to which this mark belongs.\n//\n//   spanning:: ?bool\n//   Determines whether marks of this type can span multiple adjacent\n//   nodes when serialized to DOM/HTML. Defaults to true.\n//\n//   toDOM:: ?(mark: Mark, inline: bool)  DOMOutputSpec\n//   Defines the default way marks of this type should be serialized\n//   to DOM/HTML. When the resulting spec contains a hole, that is\n//   where the marked content is placed. Otherwise, it is appended to\n//   the top node.\n//\n//   parseDOM:: ?[ParseRule]\n//   Associates DOM parser information with this mark (see the\n//   corresponding [node spec field](#model.NodeSpec.parseDOM)). The\n//   `mark` field in the rules is implied.\n\n// AttributeSpec:: interface\n//\n// Used to [define](#model.NodeSpec.attrs) attributes on nodes or\n// marks.\n//\n//   default:: ?any\n//   The default value for this attribute, to use when no explicit\n//   value is provided. Attributes that have no default must be\n//   provided whenever a node or mark of a type that has them is\n//   created.\n\n// ::- A document schema. Holds [node](#model.NodeType) and [mark\n// type](#model.MarkType) objects for the nodes and marks that may\n// occur in conforming documents, and provides functionality for\n// creating and deserializing such documents.\nexport class Schema {\n  // :: (SchemaSpec)\n  // Construct a schema from a schema [specification](#model.SchemaSpec).\n  constructor(spec) {\n    // :: SchemaSpec\n    // The [spec](#model.SchemaSpec) on which the schema is based,\n    // with the added guarantee that its `nodes` and `marks`\n    // properties are\n    // [`OrderedMap`](https://github.com/marijnh/orderedmap) instances\n    // (not raw objects).\n    this.spec = {}\n    for (let prop in spec) this.spec[prop] = spec[prop]\n    this.spec.nodes = OrderedMap.from(spec.nodes)\n    this.spec.marks = OrderedMap.from(spec.marks)\n\n    // :: Object<NodeType>\n    // An object mapping the schema's node names to node type objects.\n    this.nodes = NodeType.compile(this.spec.nodes, this)\n\n    // :: Object<MarkType>\n    // A map from mark names to mark type objects.\n    this.marks = MarkType.compile(this.spec.marks, this)\n\n    let contentExprCache = Object.create(null)\n    for (let prop in this.nodes) {\n      if (prop in this.marks)\n        throw new RangeError(prop + \" can not be both a node and a mark\")\n      let type = this.nodes[prop], contentExpr = type.spec.content || \"\", markExpr = type.spec.marks\n      type.contentMatch = contentExprCache[contentExpr] ||\n        (contentExprCache[contentExpr] = ContentMatch.parse(contentExpr, this.nodes))\n      type.inlineContent = type.contentMatch.inlineContent\n      type.markSet = markExpr == \"_\" ? null :\n        markExpr ? gatherMarks(this, markExpr.split(\" \")) :\n        markExpr == \"\" || !type.inlineContent ? [] : null\n    }\n    for (let prop in this.marks) {\n      let type = this.marks[prop], excl = type.spec.excludes\n      type.excluded = excl == null ? [type] : excl == \"\" ? [] : gatherMarks(this, excl.split(\" \"))\n    }\n\n    this.nodeFromJSON = this.nodeFromJSON.bind(this)\n    this.markFromJSON = this.markFromJSON.bind(this)\n\n    // :: NodeType\n    // The type of the [default top node](#model.SchemaSpec.topNode)\n    // for this schema.\n    this.topNodeType = this.nodes[this.spec.topNode || \"doc\"]\n\n    // :: Object\n    // An object for storing whatever values modules may want to\n    // compute and cache per schema. (If you want to store something\n    // in it, try to use property names unlikely to clash.)\n    this.cached = Object.create(null)\n    this.cached.wrappings = Object.create(null)\n  }\n\n  // :: (union<string, NodeType>, ?Object, ?union<Fragment, Node, [Node]>, ?[Mark])  Node\n  // Create a node in this schema. The `type` may be a string or a\n  // `NodeType` instance. Attributes will be extended\n  // with defaults, `content` may be a `Fragment`,\n  // `null`, a `Node`, or an array of nodes.\n  node(type, attrs, content, marks) {\n    if (typeof type == \"string\")\n      type = this.nodeType(type)\n    else if (!(type instanceof NodeType))\n      throw new RangeError(\"Invalid node type: \" + type)\n    else if (type.schema != this)\n      throw new RangeError(\"Node type from different schema used (\" + type.name + \")\")\n\n    return type.createChecked(attrs, content, marks)\n  }\n\n  // :: (string, ?[Mark])  Node\n  // Create a text node in the schema. Empty text nodes are not\n  // allowed.\n  text(text, marks) {\n    let type = this.nodes.text\n    return new TextNode(type, type.defaultAttrs, text, Mark.setFrom(marks))\n  }\n\n  // :: (union<string, MarkType>, ?Object)  Mark\n  // Create a mark with the given type and attributes.\n  mark(type, attrs) {\n    if (typeof type == \"string\") type = this.marks[type]\n    return type.create(attrs)\n  }\n\n  // :: (Object)  Node\n  // Deserialize a node from its JSON representation. This method is\n  // bound.\n  nodeFromJSON(json) {\n    return Node.fromJSON(this, json)\n  }\n\n  // :: (Object)  Mark\n  // Deserialize a mark from its JSON representation. This method is\n  // bound.\n  markFromJSON(json) {\n    return Mark.fromJSON(this, json)\n  }\n\n  nodeType(name) {\n    let found = this.nodes[name]\n    if (!found) throw new RangeError(\"Unknown node type: \" + name)\n    return found\n  }\n}\n\nfunction gatherMarks(schema, marks) {\n  let found = []\n  for (let i = 0; i < marks.length; i++) {\n    let name = marks[i], mark = schema.marks[name], ok = mark\n    if (mark) {\n      found.push(mark)\n    } else {\n      for (let prop in schema.marks) {\n        let mark = schema.marks[prop]\n        if (name == \"_\" || (mark.spec.group && mark.spec.group.split(\" \").indexOf(name) > -1))\n          found.push(ok = mark)\n      }\n    }\n    if (!ok) throw new SyntaxError(\"Unknown mark type: '\" + marks[i] + \"'\")\n  }\n  return found\n}\n","import {Fragment} from \"./fragment\"\nimport {Slice} from \"./replace\"\nimport {Mark} from \"./mark\"\n\n// ParseOptions:: interface\n// These are the options recognized by the\n// [`parse`](#model.DOMParser.parse) and\n// [`parseSlice`](#model.DOMParser.parseSlice) methods.\n//\n//   preserveWhitespace:: ?union<bool, \"full\">\n//   By default, whitespace is collapsed as per HTML's rules. Pass\n//   `true` to preserve whitespace, but normalize newlines to\n//   spaces, and `\"full\"` to preserve whitespace entirely.\n//\n//   findPositions:: ?[{node: dom.Node, offset: number}]\n//   When given, the parser will, beside parsing the content,\n//   record the document positions of the given DOM positions. It\n//   will do so by writing to the objects, adding a `pos` property\n//   that holds the document position. DOM positions that are not\n//   in the parsed content will not be written to.\n//\n//   from:: ?number\n//   The child node index to start parsing from.\n//\n//   to:: ?number\n//   The child node index to stop parsing at.\n//\n//   topNode:: ?Node\n//   By default, the content is parsed into the schema's default\n//   [top node type](#model.Schema.topNodeType). You can pass this\n//   option to use the type and attributes from a different node\n//   as the top container.\n//\n//   topMatch:: ?ContentMatch\n//   Provide the starting content match that content parsed into the\n//   top node is matched against.\n//\n//   context:: ?ResolvedPos\n//   A set of additional nodes to count as\n//   [context](#model.ParseRule.context) when parsing, above the\n//   given [top node](#model.ParseOptions.topNode).\n\n// ParseRule:: interface\n// A value that describes how to parse a given DOM node or inline\n// style as a ProseMirror node or mark.\n//\n//   tag:: ?string\n//   A CSS selector describing the kind of DOM elements to match. A\n//   single rule should have _either_ a `tag` or a `style` property.\n//\n//   namespace:: ?string\n//   The namespace to match. This should be used with `tag`.\n//   Nodes are only matched when the namespace matches or this property\n//   is null.\n//\n//   style:: ?string\n//   A CSS property name to match. When given, this rule matches\n//   inline styles that list that property. May also have the form\n//   `\"property=value\"`, in which case the rule only matches if the\n//   propery's value exactly matches the given value. (For more\n//   complicated filters, use [`getAttrs`](#model.ParseRule.getAttrs)\n//   and return false to indicate that the match failed.)\n//\n//   priority:: ?number\n//   Can be used to change the order in which the parse rules in a\n//   schema are tried. Those with higher priority come first. Rules\n//   without a priority are counted as having priority 50. This\n//   property is only meaningful in a schemawhen directly\n//   constructing a parser, the order of the rule array is used.\n//\n//   context:: ?string\n//   When given, restricts this rule to only match when the current\n//   contextthe parent nodes into which the content is being\n//   parsedmatches this expression. Should contain one or more node\n//   names or node group names followed by single or double slashes.\n//   For example `\"paragraph/\"` means the rule only matches when the\n//   parent node is a paragraph, `\"blockquote/paragraph/\"` restricts\n//   it to be in a paragraph that is inside a blockquote, and\n//   `\"section//\"` matches any position inside a sectiona double\n//   slash matches any sequence of ancestor nodes. To allow multiple\n//   different contexts, they can be separated by a pipe (`|`)\n//   character, as in `\"blockquote/|list_item/\"`.\n//\n//   node:: ?string\n//   The name of the node type to create when this rule matches. Only\n//   valid for rules with a `tag` property, not for style rules. Each\n//   rule should have one of a `node`, `mark`, or `ignore` property\n//   (except when it appears in a [node](#model.NodeSpec.parseDOM) or\n//   [mark spec](#model.MarkSpec.parseDOM), in which case the `node`\n//   or `mark` property will be derived from its position).\n//\n//   mark:: ?string\n//   The name of the mark type to wrap the matched content in.\n//\n//   ignore:: ?bool\n//   When true, ignore content that matches this rule.\n//\n//   skip:: ?bool\n//   When true, ignore the node that matches this rule, but do parse\n//   its content.\n//\n//   attrs:: ?Object\n//   Attributes for the node or mark created by this rule. When\n//   `getAttrs` is provided, it takes precedence.\n//\n//   getAttrs:: ?(union<dom.Node, string>)  ?union<Object, false>\n//   A function used to compute the attributes for the node or mark\n//   created by this rule. Can also be used to describe further\n//   conditions the DOM element or style must match. When it returns\n//   `false`, the rule won't match. When it returns null or undefined,\n//   that is interpreted as an empty/default set of attributes.\n//\n//   Called with a DOM Element for `tag` rules, and with a string (the\n//   style's value) for `style` rules.\n//\n//   contentElement:: ?union<string, (dom.Node)  dom.Node>\n//   For `tag` rules that produce non-leaf nodes or marks, by default\n//   the content of the DOM element is parsed as content of the mark\n//   or node. If the child nodes are in a descendent node, this may be\n//   a CSS selector string that the parser must use to find the actual\n//   content element, or a function that returns the actual content\n//   element to the parser.\n//\n//   getContent:: ?(dom.Node, schema: Schema)  Fragment\n//   Can be used to override the content of a matched node. When\n//   present, instead of parsing the node's child nodes, the result of\n//   this function is used.\n//\n//   preserveWhitespace:: ?union<bool, \"full\">\n//   Controls whether whitespace should be preserved when parsing the\n//   content inside the matched element. `false` means whitespace may\n//   be collapsed, `true` means that whitespace should be preserved\n//   but newlines normalized to spaces, and `\"full\"` means that\n//   newlines should also be preserved.\n\n// ::- A DOM parser represents a strategy for parsing DOM content into\n// a ProseMirror document conforming to a given schema. Its behavior\n// is defined by an array of [rules](#model.ParseRule).\nexport class DOMParser {\n  // :: (Schema, [ParseRule])\n  // Create a parser that targets the given schema, using the given\n  // parsing rules.\n  constructor(schema, rules) {\n    // :: Schema\n    // The schema into which the parser parses.\n    this.schema = schema\n    // :: [ParseRule]\n    // The set of [parse rules](#model.ParseRule) that the parser\n    // uses, in order of precedence.\n    this.rules = rules\n    this.tags = []\n    this.styles = []\n\n    rules.forEach(rule => {\n      if (rule.tag) this.tags.push(rule)\n      else if (rule.style) this.styles.push(rule)\n    })\n  }\n\n  // :: (dom.Node, ?ParseOptions)  Node\n  // Parse a document from the content of a DOM node.\n  parse(dom, options = {}) {\n    let context = new ParseContext(this, options, false)\n    context.addAll(dom, null, options.from, options.to)\n    return context.finish()\n  }\n\n  // :: (dom.Node, ?ParseOptions)  Slice\n  // Parses the content of the given DOM node, like\n  // [`parse`](#model.DOMParser.parse), and takes the same set of\n  // options. But unlike that method, which produces a whole node,\n  // this one returns a slice that is open at the sides, meaning that\n  // the schema constraints aren't applied to the start of nodes to\n  // the left of the input and the end of nodes at the end.\n  parseSlice(dom, options = {}) {\n    let context = new ParseContext(this, options, true)\n    context.addAll(dom, null, options.from, options.to)\n    return Slice.maxOpen(context.finish())\n  }\n\n  matchTag(dom, context) {\n    for (let i = 0; i < this.tags.length; i++) {\n      let rule = this.tags[i]\n      if (matches(dom, rule.tag) &&\n          (rule.namespace === undefined || dom.namespaceURI == rule.namespace) &&\n          (!rule.context || context.matchesContext(rule.context))) {\n        if (rule.getAttrs) {\n          let result = rule.getAttrs(dom)\n          if (result === false) continue\n          rule.attrs = result\n        }\n        return rule\n      }\n    }\n  }\n\n  matchStyle(prop, value, context) {\n    for (let i = 0; i < this.styles.length; i++) {\n      let rule = this.styles[i]\n      if (rule.style.indexOf(prop) != 0 ||\n          rule.context && !context.matchesContext(rule.context) ||\n          // Test that the style string either precisely matches the prop,\n          // or has an '=' sign after the prop, followed by the given\n          // value.\n          rule.style.length > prop.length &&\n          (rule.style.charCodeAt(prop.length) != 61 || rule.style.slice(prop.length + 1) != value))\n        continue\n      if (rule.getAttrs) {\n        let result = rule.getAttrs(value)\n        if (result === false) continue\n        rule.attrs = result\n      }\n      return rule\n    }\n  }\n\n  // : (Schema)  [ParseRule]\n  static schemaRules(schema) {\n    let result = []\n    function insert(rule) {\n      let priority = rule.priority == null ? 50 : rule.priority, i = 0\n      for (; i < result.length; i++) {\n        let next = result[i], nextPriority = next.priority == null ? 50 : next.priority\n        if (nextPriority < priority) break\n      }\n      result.splice(i, 0, rule)\n    }\n\n    for (let name in schema.marks) {\n      let rules = schema.marks[name].spec.parseDOM\n      if (rules) rules.forEach(rule => {\n        insert(rule = copy(rule))\n        rule.mark = name\n      })\n    }\n    for (let name in schema.nodes) {\n      let rules = schema.nodes[name].spec.parseDOM\n      if (rules) rules.forEach(rule => {\n        insert(rule = copy(rule))\n        rule.node = name\n      })\n    }\n    return result\n  }\n\n  // :: (Schema)  DOMParser\n  // Construct a DOM parser using the parsing rules listed in a\n  // schema's [node specs](#model.NodeSpec.parseDOM), reordered by\n  // [priority](#model.ParseRule.priority).\n  static fromSchema(schema) {\n    return schema.cached.domParser ||\n      (schema.cached.domParser = new DOMParser(schema, DOMParser.schemaRules(schema)))\n  }\n}\n\n// : Object<bool> The block-level tags in HTML5\nconst blockTags = {\n  address: true, article: true, aside: true, blockquote: true, canvas: true,\n  dd: true, div: true, dl: true, fieldset: true, figcaption: true, figure: true,\n  footer: true, form: true, h1: true, h2: true, h3: true, h4: true, h5: true,\n  h6: true, header: true, hgroup: true, hr: true, li: true, noscript: true, ol: true,\n  output: true, p: true, pre: true, section: true, table: true, tfoot: true, ul: true\n}\n\n// : Object<bool> The tags that we normally ignore.\nconst ignoreTags = {\n  head: true, noscript: true, object: true, script: true, style: true, title: true\n}\n\n// : Object<bool> List tags.\nconst listTags = {ol: true, ul: true}\n\n// Using a bitfield for node context options\nconst OPT_PRESERVE_WS = 1, OPT_PRESERVE_WS_FULL = 2, OPT_OPEN_LEFT = 4\n\nfunction wsOptionsFor(preserveWhitespace) {\n  return (preserveWhitespace ? OPT_PRESERVE_WS : 0) | (preserveWhitespace === \"full\" ? OPT_PRESERVE_WS_FULL : 0)\n}\n\nclass NodeContext {\n  constructor(type, attrs, marks, pendingMarks, solid, match, options) {\n    this.type = type\n    this.attrs = attrs\n    this.solid = solid\n    this.match = match || (options & OPT_OPEN_LEFT ? null : type.contentMatch)\n    this.options = options\n    this.content = []\n    // Marks applied to this node itself\n    this.marks = marks\n    // Marks applied to its children\n    this.activeMarks = Mark.none\n    // Marks that can't apply here, but will be used in children if possible\n    this.pendingMarks = pendingMarks\n  }\n\n  findWrapping(node) {\n    if (!this.match) {\n      if (!this.type) return []\n      let fill = this.type.contentMatch.fillBefore(Fragment.from(node))\n      if (fill) {\n        this.match = this.type.contentMatch.matchFragment(fill)\n      } else {\n        let start = this.type.contentMatch, wrap\n        if (wrap = start.findWrapping(node.type)) {\n          this.match = start\n          return wrap\n        } else {\n          return null\n        }\n      }\n    }\n    return this.match.findWrapping(node.type)\n  }\n\n  finish(openEnd) {\n    if (!(this.options & OPT_PRESERVE_WS)) { // Strip trailing whitespace\n      let last = this.content[this.content.length - 1], m\n      if (last && last.isText && (m = /[ \\t\\r\\n\\u000c]+$/.exec(last.text))) {\n        if (last.text.length == m[0].length) this.content.pop()\n        else this.content[this.content.length - 1] = last.withText(last.text.slice(0, last.text.length - m[0].length))\n      }\n    }\n    let content = Fragment.from(this.content)\n    if (!openEnd && this.match)\n      content = content.append(this.match.fillBefore(Fragment.empty, true))\n    return this.type ? this.type.create(this.attrs, content, this.marks) : content\n  }\n\n  applyPending(nextType) {\n    for (let i = 0, pending = this.pendingMarks; i < pending.length; i++) {\n      let mark = pending[i]\n      if ((this.type ? this.type.allowsMarkType(mark.type) : markMayApply(mark.type, nextType)) &&\n          !mark.isInSet(this.activeMarks)) {\n        this.activeMarks = mark.addToSet(this.activeMarks)\n        this.pendingMarks = mark.removeFromSet(this.pendingMarks)\n      }\n    }\n  }\n}\n\nclass ParseContext {\n  // : (DOMParser, Object)\n  constructor(parser, options, open) {\n    // : DOMParser The parser we are using.\n    this.parser = parser\n    // : Object The options passed to this parse.\n    this.options = options\n    this.isOpen = open\n    let topNode = options.topNode, topContext\n    let topOptions = wsOptionsFor(options.preserveWhitespace) | (open ? OPT_OPEN_LEFT : 0)\n    if (topNode)\n      topContext = new NodeContext(topNode.type, topNode.attrs, Mark.none, Mark.none, true,\n                                   options.topMatch || topNode.type.contentMatch, topOptions)\n    else if (open)\n      topContext = new NodeContext(null, null, Mark.none, Mark.none, true, null, topOptions)\n    else\n      topContext = new NodeContext(parser.schema.topNodeType, null, Mark.none, Mark.none, true, null, topOptions)\n    this.nodes = [topContext]\n    // : [Mark] The current set of marks\n    this.open = 0\n    this.find = options.findPositions\n    this.needsBlock = false\n  }\n\n  get top() {\n    return this.nodes[this.open]\n  }\n\n  // : (dom.Node)\n  // Add a DOM node to the content. Text is inserted as text node,\n  // otherwise, the node is passed to `addElement` or, if it has a\n  // `style` attribute, `addElementWithStyles`.\n  addDOM(dom) {\n    if (dom.nodeType == 3) {\n      this.addTextNode(dom)\n    } else if (dom.nodeType == 1) {\n      let style = dom.getAttribute(\"style\")\n      let marks = style ? this.readStyles(parseStyles(style)) : null, top = this.top\n      if (marks != null) for (let i = 0; i < marks.length; i++) this.addPendingMark(marks[i])\n      this.addElement(dom)\n      if (marks != null) for (let i = 0; i < marks.length; i++) this.removePendingMark(marks[i], top)\n    }\n  }\n\n  addTextNode(dom) {\n    let value = dom.nodeValue\n    let top = this.top\n    if ((top.type ? top.type.inlineContent : top.content.length && top.content[0].isInline) || /[^ \\t\\r\\n\\u000c]/.test(value)) {\n      if (!(top.options & OPT_PRESERVE_WS)) {\n        value = value.replace(/[ \\t\\r\\n\\u000c]+/g, \" \")\n        // If this starts with whitespace, and there is no node before it, or\n        // a hard break, or a text node that ends with whitespace, strip the\n        // leading space.\n        if (/^[ \\t\\r\\n\\u000c]/.test(value) && this.open == this.nodes.length - 1) {\n          let nodeBefore = top.content[top.content.length - 1]\n          let domNodeBefore = dom.previousSibling\n          if (!nodeBefore ||\n              (domNodeBefore && domNodeBefore.nodeName == 'BR') ||\n              (nodeBefore.isText && /[ \\t\\r\\n\\u000c]$/.test(nodeBefore.text)))\n            value = value.slice(1)\n        }\n      } else if (!(top.options & OPT_PRESERVE_WS_FULL)) {\n        value = value.replace(/\\r?\\n|\\r/g, \" \")\n      }\n      if (value) this.insertNode(this.parser.schema.text(value))\n      this.findInText(dom)\n    } else {\n      this.findInside(dom)\n    }\n  }\n\n  // : (dom.Element)\n  // Try to find a handler for the given tag and use that to parse. If\n  // none is found, the element's content nodes are added directly.\n  addElement(dom) {\n    let name = dom.nodeName.toLowerCase()\n    if (listTags.hasOwnProperty(name)) normalizeList(dom)\n    let rule = (this.options.ruleFromNode && this.options.ruleFromNode(dom)) || this.parser.matchTag(dom, this)\n    if (rule ? rule.ignore : ignoreTags.hasOwnProperty(name)) {\n      this.findInside(dom)\n    } else if (!rule || rule.skip) {\n      if (rule && rule.skip.nodeType) dom = rule.skip\n      let sync, top = this.top, oldNeedsBlock = this.needsBlock\n      if (blockTags.hasOwnProperty(name)) {\n        sync = true\n        if (!top.type) this.needsBlock = true\n      } else if (!dom.firstChild) {\n        this.leafFallback(dom)\n        return\n      }\n      this.addAll(dom)\n      if (sync) this.sync(top)\n      this.needsBlock = oldNeedsBlock\n    } else {\n      this.addElementByRule(dom, rule)\n    }\n  }\n\n  // Called for leaf DOM nodes that would otherwise be ignored\n  leafFallback(dom) {\n    if (dom.nodeName == \"BR\" && this.top.type && this.top.type.inlineContent)\n      this.addTextNode(dom.ownerDocument.createTextNode(\"\\n\"))\n  }\n\n  // Run any style parser associated with the node's styles. Either\n  // return an array of marks, or null to indicate some of the styles\n  // had a rule with `ignore` set.\n  readStyles(styles) {\n    let marks = Mark.none\n    for (let i = 0; i < styles.length; i += 2) {\n      let rule = this.parser.matchStyle(styles[i], styles[i + 1], this)\n      if (!rule) continue\n      if (rule.ignore) return null\n      marks = this.parser.schema.marks[rule.mark].create(rule.attrs).addToSet(marks)\n    }\n    return marks\n  }\n\n  // : (dom.Element, ParseRule)  bool\n  // Look up a handler for the given node. If none are found, return\n  // false. Otherwise, apply it, use its return value to drive the way\n  // the node's content is wrapped, and return true.\n  addElementByRule(dom, rule) {\n    let sync, nodeType, markType, mark\n    if (rule.node) {\n      nodeType = this.parser.schema.nodes[rule.node]\n      if (!nodeType.isLeaf) {\n        sync = this.enter(nodeType, rule.attrs, rule.preserveWhitespace)\n      } else if (!this.insertNode(nodeType.create(rule.attrs))) {\n        this.leafFallback(dom)\n      }\n    } else {\n      markType = this.parser.schema.marks[rule.mark]\n      mark = markType.create(rule.attrs)\n      this.addPendingMark(mark)\n    }\n    let startIn = this.top\n\n    if (nodeType && nodeType.isLeaf) {\n      this.findInside(dom)\n    } else if (rule.getContent) {\n      this.findInside(dom)\n      rule.getContent(dom, this.parser.schema).forEach(node => this.insertNode(node))\n    } else {\n      let contentDOM = rule.contentElement\n      if (typeof contentDOM == \"string\") contentDOM = dom.querySelector(contentDOM)\n      else if (typeof contentDOM == \"function\") contentDOM = contentDOM(dom)\n      if (!contentDOM) contentDOM = dom\n      this.findAround(dom, contentDOM, true)\n      this.addAll(contentDOM, sync)\n    }\n    if (sync) { this.sync(startIn); this.open-- }\n    if (mark) this.removePendingMark(mark, startIn)\n  }\n\n  // : (dom.Node, ?NodeBuilder, ?number, ?number)\n  // Add all child nodes between `startIndex` and `endIndex` (or the\n  // whole node, if not given). If `sync` is passed, use it to\n  // synchronize after every block element.\n  addAll(parent, sync, startIndex, endIndex) {\n    let index = startIndex || 0\n    for (let dom = startIndex ? parent.childNodes[startIndex] : parent.firstChild,\n             end = endIndex == null ? null : parent.childNodes[endIndex];\n         dom != end; dom = dom.nextSibling, ++index) {\n      this.findAtPoint(parent, index)\n      this.addDOM(dom)\n      if (sync && blockTags.hasOwnProperty(dom.nodeName.toLowerCase()))\n        this.sync(sync)\n    }\n    this.findAtPoint(parent, index)\n  }\n\n  // Try to find a way to fit the given node type into the current\n  // context. May add intermediate wrappers and/or leave non-solid\n  // nodes that we're in.\n  findPlace(node) {\n    let route, sync\n    for (let depth = this.open; depth >= 0; depth--) {\n      let cx = this.nodes[depth]\n      let found = cx.findWrapping(node)\n      if (found && (!route || route.length > found.length)) {\n        route = found\n        sync = cx\n        if (!found.length) break\n      }\n      if (cx.solid) break\n    }\n    if (!route) return false\n    this.sync(sync)\n    for (let i = 0; i < route.length; i++)\n      this.enterInner(route[i], null, false)\n    return true\n  }\n\n  // : (Node)  ?Node\n  // Try to insert the given node, adjusting the context when needed.\n  insertNode(node) {\n    if (node.isInline && this.needsBlock && !this.top.type) {\n      let block = this.textblockFromContext()\n      if (block) this.enterInner(block)\n    }\n    if (this.findPlace(node)) {\n      this.closeExtra()\n      let top = this.top\n      top.applyPending(node.type)\n      if (top.match) top.match = top.match.matchType(node.type)\n      let marks = top.activeMarks\n      for (let i = 0; i < node.marks.length; i++)\n        if (!top.type || top.type.allowsMarkType(node.marks[i].type))\n          marks = node.marks[i].addToSet(marks)\n      top.content.push(node.mark(marks))\n      return true\n    }\n    return false\n  }\n\n  // : (NodeType, ?Object)  bool\n  // Try to start a node of the given type, adjusting the context when\n  // necessary.\n  enter(type, attrs, preserveWS) {\n    let ok = this.findPlace(type.create(attrs))\n    if (ok) this.enterInner(type, attrs, true, preserveWS)\n    return ok\n  }\n\n  // Open a node of the given type\n  enterInner(type, attrs, solid, preserveWS) {\n    this.closeExtra()\n    let top = this.top\n    top.applyPending(type)\n    top.match = top.match && top.match.matchType(type, attrs)\n    let options = preserveWS == null ? top.options & ~OPT_OPEN_LEFT : wsOptionsFor(preserveWS)\n    if ((top.options & OPT_OPEN_LEFT) && top.content.length == 0) options |= OPT_OPEN_LEFT\n    this.nodes.push(new NodeContext(type, attrs, top.activeMarks, top.pendingMarks, solid, null, options))\n    this.open++\n  }\n\n  // Make sure all nodes above this.open are finished and added to\n  // their parents\n  closeExtra(openEnd) {\n    let i = this.nodes.length - 1\n    if (i > this.open) {\n      for (; i > this.open; i--) this.nodes[i - 1].content.push(this.nodes[i].finish(openEnd))\n      this.nodes.length = this.open + 1\n    }\n  }\n\n  finish() {\n    this.open = 0\n    this.closeExtra(this.isOpen)\n    return this.nodes[0].finish(this.isOpen || this.options.topOpen)\n  }\n\n  sync(to) {\n    for (let i = this.open; i >= 0; i--) if (this.nodes[i] == to) {\n      this.open = i\n      return\n    }\n  }\n\n  get currentPos() {\n    this.closeExtra()\n    let pos = 0\n    for (let i = this.open; i >= 0; i--) {\n      let content = this.nodes[i].content\n      for (let j = content.length - 1; j >= 0; j--)\n        pos += content[j].nodeSize\n      if (i) pos++\n    }\n    return pos\n  }\n\n  findAtPoint(parent, offset) {\n    if (this.find) for (let i = 0; i < this.find.length; i++) {\n      if (this.find[i].node == parent && this.find[i].offset == offset)\n        this.find[i].pos = this.currentPos\n    }\n  }\n\n  findInside(parent) {\n    if (this.find) for (let i = 0; i < this.find.length; i++) {\n      if (this.find[i].pos == null && parent.nodeType == 1 && parent.contains(this.find[i].node))\n        this.find[i].pos = this.currentPos\n    }\n  }\n\n  findAround(parent, content, before) {\n    if (parent != content && this.find) for (let i = 0; i < this.find.length; i++) {\n      if (this.find[i].pos == null && parent.nodeType == 1 && parent.contains(this.find[i].node)) {\n        let pos = content.compareDocumentPosition(this.find[i].node)\n        if (pos & (before ? 2 : 4))\n          this.find[i].pos = this.currentPos\n      }\n    }\n  }\n\n  findInText(textNode) {\n    if (this.find) for (let i = 0; i < this.find.length; i++) {\n      if (this.find[i].node == textNode)\n        this.find[i].pos = this.currentPos - (textNode.nodeValue.length - this.find[i].offset)\n    }\n  }\n\n  // : (string)  bool\n  // Determines whether the given [context\n  // string](#ParseRule.context) matches this context.\n  matchesContext(context) {\n    if (context.indexOf(\"|\") > -1)\n      return context.split(/\\s*\\|\\s*/).some(this.matchesContext, this)\n\n    let parts = context.split(\"/\")\n    let option = this.options.context\n    let useRoot = !this.isOpen && (!option || option.parent.type == this.nodes[0].type)\n    let minDepth = -(option ? option.depth + 1 : 0) + (useRoot ? 0 : 1)\n    let match = (i, depth) => {\n      for (; i >= 0; i--) {\n        let part = parts[i]\n        if (part == \"\") {\n          if (i == parts.length - 1 || i == 0) continue\n          for (; depth >= minDepth; depth--)\n            if (match(i - 1, depth)) return true\n          return false\n        } else {\n          let next = depth > 0 || (depth == 0 && useRoot) ? this.nodes[depth].type\n              : option && depth >= minDepth ? option.node(depth - minDepth).type\n              : null\n          if (!next || (next.name != part && next.groups.indexOf(part) == -1))\n            return false\n          depth--\n        }\n      }\n      return true\n    }\n    return match(parts.length - 1, this.open)\n  }\n\n  textblockFromContext() {\n    let $context = this.options.context\n    if ($context) for (let d = $context.depth; d >= 0; d--) {\n      let deflt = $context.node(d).contentMatchAt($context.indexAfter(d)).defaultType\n      if (deflt && deflt.isTextblock && deflt.defaultAttrs) return deflt\n    }\n    for (let name in this.parser.schema.nodes) {\n      let type = this.parser.schema.nodes[name]\n      if (type.isTextblock && type.defaultAttrs) return type\n    }\n  }\n\n  addPendingMark(mark) {\n    this.top.pendingMarks = mark.addToSet(this.top.pendingMarks)\n  }\n\n  removePendingMark(mark, upto) {\n    for (let depth = this.open; depth >= 0; depth--) {\n      let level = this.nodes[depth]\n      let found = level.pendingMarks.lastIndexOf(mark)\n      if (found > -1) level.pendingMarks = mark.removeFromSet(level.pendingMarks)\n      else level.activeMarks = mark.removeFromSet(level.activeMarks)\n      if (level == upto) break\n    }\n  }\n}\n\n// Kludge to work around directly nested list nodes produced by some\n// tools and allowed by browsers to mean that the nested list is\n// actually part of the list item above it.\nfunction normalizeList(dom) {\n  for (let child = dom.firstChild, prevItem = null; child; child = child.nextSibling) {\n    let name = child.nodeType == 1 ? child.nodeName.toLowerCase() : null\n    if (name && listTags.hasOwnProperty(name) && prevItem) {\n      prevItem.appendChild(child)\n      child = prevItem\n    } else if (name == \"li\") {\n      prevItem = child\n    } else if (name) {\n      prevItem = null\n    }\n  }\n}\n\n// Apply a CSS selector.\nfunction matches(dom, selector) {\n  return (dom.matches || dom.msMatchesSelector || dom.webkitMatchesSelector || dom.mozMatchesSelector).call(dom, selector)\n}\n\n// : (string)  [string]\n// Tokenize a style attribute into property/value pairs.\nfunction parseStyles(style) {\n  let re = /\\s*([\\w-]+)\\s*:\\s*([^;]+)/g, m, result = []\n  while (m = re.exec(style)) result.push(m[1], m[2].trim())\n  return result\n}\n\nfunction copy(obj) {\n  let copy = {}\n  for (let prop in obj) copy[prop] = obj[prop]\n  return copy\n}\n\n// Used when finding a mark at the top level of a fragment parse.\n// Checks whether it would be reasonable to apply a given mark type to\n// a given node, by looking at the way the mark occurs in the schema.\nfunction markMayApply(markType, nodeType) {\n  let nodes = nodeType.schema.nodes\n  for (let name in nodes) {\n    let parent = nodes[name]\n    if (!parent.allowsMarkType(markType)) continue\n    let seen = [], scan = match => {\n      seen.push(match)\n      for (let i = 0; i < match.edgeCount; i++) {\n        let {type, next} = match.edge(i)\n        if (type == nodeType) return true\n        if (seen.indexOf(next) < 0 && scan(next)) return true\n      }\n    }\n    if (scan(parent.contentMatch)) return true\n  }\n}\n","// DOMOutputSpec:: interface\n// A description of a DOM structure. Can be either a string, which is\n// interpreted as a text node, a DOM node, which is interpreted as\n// itself, or an array.\n//\n// An array describes a DOM element. The first value in the array\n// should be a stringthe name of the DOM element, optionally prefixed\n// by a namespace URL and a space. If the second element is plain\n// object, it is interpreted as a set of attributes for the element.\n// Any elements after that (including the 2nd if it's not an attribute\n// object) are interpreted as children of the DOM elements, and must\n// either be valid `DOMOutputSpec` values, or the number zero.\n//\n// The number zero (pronounced hole) is used to indicate the place\n// where a node's child nodes should be inserted. If it occurs in an\n// output spec, it should be the only child element in its parent\n// node.\n\n// ::- A DOM serializer knows how to convert ProseMirror nodes and\n// marks of various types to DOM nodes.\nexport class DOMSerializer {\n  // :: (Object<(node: Node)  DOMOutputSpec>, Object<?(mark: Mark, inline: bool)  DOMOutputSpec>)\n  // Create a serializer. `nodes` should map node names to functions\n  // that take a node and return a description of the corresponding\n  // DOM. `marks` does the same for mark names, but also gets an\n  // argument that tells it whether the mark's content is block or\n  // inline content (for typical use, it'll always be inline). A mark\n  // serializer may be `null` to indicate that marks of that type\n  // should not be serialized.\n  constructor(nodes, marks) {\n    // :: Object<(node: Node)  DOMOutputSpec>\n    // The node serialization functions.\n    this.nodes = nodes || {}\n    // :: Object<?(mark: Mark, inline: bool)  DOMOutputSpec>\n    // The mark serialization functions.\n    this.marks = marks || {}\n  }\n\n  // :: (Fragment, ?Object)  dom.DocumentFragment\n  // Serialize the content of this fragment to a DOM fragment. When\n  // not in the browser, the `document` option, containing a DOM\n  // document, should be passed so that the serializer can create\n  // nodes.\n  serializeFragment(fragment, options = {}, target) {\n    if (!target) target = doc(options).createDocumentFragment()\n\n    let top = target, active = null\n    fragment.forEach(node => {\n      if (active || node.marks.length) {\n        if (!active) active = []\n        let keep = 0, rendered = 0\n        while (keep < active.length && rendered < node.marks.length) {\n          let next = node.marks[rendered]\n          if (!this.marks[next.type.name]) { rendered++; continue }\n          if (!next.eq(active[keep]) || next.type.spec.spanning === false) break\n          keep += 2; rendered++\n        }\n        while (keep < active.length) {\n          top = active.pop()\n          active.pop()\n        }\n        while (rendered < node.marks.length) {\n          let add = node.marks[rendered++]\n          let markDOM = this.serializeMark(add, node.isInline, options)\n          if (markDOM) {\n            active.push(add, top)\n            top.appendChild(markDOM.dom)\n            top = markDOM.contentDOM || markDOM.dom\n          }\n        }\n      }\n      top.appendChild(this.serializeNode(node, options))\n    })\n\n    return target\n  }\n\n  // :: (Node, ?Object)  dom.Node\n  // Serialize this node to a DOM node. This can be useful when you\n  // need to serialize a part of a document, as opposed to the whole\n  // document. To serialize a whole document, use\n  // [`serializeFragment`](#model.DOMSerializer.serializeFragment) on\n  // its [content](#model.Node.content).\n  serializeNode(node, options = {}) {\n    let {dom, contentDOM} =\n        DOMSerializer.renderSpec(doc(options), this.nodes[node.type.name](node))\n    if (contentDOM) {\n      if (node.isLeaf)\n        throw new RangeError(\"Content hole not allowed in a leaf node spec\")\n      if (options.onContent)\n        options.onContent(node, contentDOM, options)\n      else\n        this.serializeFragment(node.content, options, contentDOM)\n    }\n    return dom\n  }\n\n  serializeNodeAndMarks(node, options = {}) {\n    let dom = this.serializeNode(node, options)\n    for (let i = node.marks.length - 1; i >= 0; i--) {\n      let wrap = this.serializeMark(node.marks[i], node.isInline, options)\n      if (wrap) {\n        ;(wrap.contentDOM || wrap.dom).appendChild(dom)\n        dom = wrap.dom\n      }\n    }\n    return dom\n  }\n\n  serializeMark(mark, inline, options = {}) {\n    let toDOM = this.marks[mark.type.name]\n    return toDOM && DOMSerializer.renderSpec(doc(options), toDOM(mark, inline))\n  }\n\n  // :: (dom.Document, DOMOutputSpec)  {dom: dom.Node, contentDOM: ?dom.Node}\n  // Render an [output spec](#model.DOMOutputSpec) to a DOM node. If\n  // the spec has a hole (zero) in it, `contentDOM` will point at the\n  // node with the hole.\n  static renderSpec(doc, structure, xmlNS = null) {\n    if (typeof structure == \"string\")\n      return {dom: doc.createTextNode(structure)}\n    if (structure.nodeType != null)\n      return {dom: structure}\n    let tagName = structure[0], space = tagName.indexOf(\" \")\n    if (space > 0) {\n      xmlNS = tagName.slice(0, space)\n      tagName = tagName.slice(space + 1)\n    }\n    let contentDOM = null, dom = xmlNS ? doc.createElementNS(xmlNS, tagName) : doc.createElement(tagName)\n    let attrs = structure[1], start = 1\n    if (attrs && typeof attrs == \"object\" && attrs.nodeType == null && !Array.isArray(attrs)) {\n      start = 2\n      for (let name in attrs) if (attrs[name] != null) {\n        let space = name.indexOf(\" \")\n        if (space > 0) dom.setAttributeNS(name.slice(0, space), name.slice(space + 1), attrs[name])\n        else dom.setAttribute(name, attrs[name])\n      }\n    }\n    for (let i = start; i < structure.length; i++) {\n      let child = structure[i]\n      if (child === 0) {\n        if (i < structure.length - 1 || i > start)\n          throw new RangeError(\"Content hole must be the only child of its parent node\")\n        return {dom, contentDOM: dom}\n      } else {\n        let {dom: inner, contentDOM: innerContent} = DOMSerializer.renderSpec(doc, child, xmlNS)\n        dom.appendChild(inner)\n        if (innerContent) {\n          if (contentDOM) throw new RangeError(\"Multiple content holes\")\n          contentDOM = innerContent\n        }\n      }\n    }\n    return {dom, contentDOM}\n  }\n\n  // :: (Schema)  DOMSerializer\n  // Build a serializer using the [`toDOM`](#model.NodeSpec.toDOM)\n  // properties in a schema's node and mark specs.\n  static fromSchema(schema) {\n    return schema.cached.domSerializer ||\n      (schema.cached.domSerializer = new DOMSerializer(this.nodesFromSchema(schema), this.marksFromSchema(schema)))\n  }\n\n  // : (Schema)  Object<(node: Node)  DOMOutputSpec>\n  // Gather the serializers in a schema's node specs into an object.\n  // This can be useful as a base to build a custom serializer from.\n  static nodesFromSchema(schema) {\n    let result = gatherToDOM(schema.nodes)\n    if (!result.text) result.text = node => node.text\n    return result\n  }\n\n  // : (Schema)  Object<(mark: Mark)  DOMOutputSpec>\n  // Gather the serializers in a schema's mark specs into an object.\n  static marksFromSchema(schema) {\n    return gatherToDOM(schema.marks)\n  }\n}\n\nfunction gatherToDOM(obj) {\n  let result = {}\n  for (let name in obj) {\n    let toDOM = obj[name].spec.toDOM\n    if (toDOM) result[name] = toDOM\n  }\n  return result\n}\n\nfunction doc(options) {\n  // declare global: window\n  return options.document || window.document\n}\n","// Mappable:: interface\n// There are several things that positions can be mapped through.\n// Such objects conform to this interface.\n//\n//   map:: (pos: number, assoc: ?number)  number\n//   Map a position through this object. When given, `assoc` (should\n//   be -1 or 1, defaults to 1) determines with which side the\n//   position is associated, which determines in which direction to\n//   move when a chunk of content is inserted at the mapped position.\n//\n//   mapResult:: (pos: number, assoc: ?number)  MapResult\n//   Map a position, and return an object containing additional\n//   information about the mapping. The result's `deleted` field tells\n//   you whether the position was deleted (completely enclosed in a\n//   replaced range) during the mapping. When content on only one side\n//   is deleted, the position itself is only considered deleted when\n//   `assoc` points in the direction of the deleted content.\n\n// Recovery values encode a range index and an offset. They are\n// represented as numbers, because tons of them will be created when\n// mapping, for example, a large number of decorations. The number's\n// lower 16 bits provide the index, the remaining bits the offset.\n//\n// Note: We intentionally don't use bit shift operators to en- and\n// decode these, since those clip to 32 bits, which we might in rare\n// cases want to overflow. A 64-bit float can represent 48-bit\n// integers precisely.\n\nconst lower16 = 0xffff\nconst factor16 = Math.pow(2, 16)\n\nfunction makeRecover(index, offset) { return index + offset * factor16 }\nfunction recoverIndex(value) { return value & lower16 }\nfunction recoverOffset(value) { return (value - (value & lower16)) / factor16 }\n\n// ::- An object representing a mapped position with extra\n// information.\nexport class MapResult {\n  constructor(pos, deleted = false, recover = null) {\n    // :: number The mapped version of the position.\n    this.pos = pos\n    // :: bool Tells you whether the position was deleted, that is,\n    // whether the step removed its surroundings from the document.\n    this.deleted = deleted\n    this.recover = recover\n  }\n}\n\n// :: class extends Mappable\n// A map describing the deletions and insertions made by a step, which\n// can be used to find the correspondence between positions in the\n// pre-step version of a document and the same position in the\n// post-step version.\nexport class StepMap {\n  // :: ([number])\n  // Create a position map. The modifications to the document are\n  // represented as an array of numbers, in which each group of three\n  // represents a modified chunk as `[start, oldSize, newSize]`.\n  constructor(ranges, inverted = false) {\n    this.ranges = ranges\n    this.inverted = inverted\n  }\n\n  recover(value) {\n    let diff = 0, index = recoverIndex(value)\n    if (!this.inverted) for (let i = 0; i < index; i++)\n      diff += this.ranges[i * 3 + 2] - this.ranges[i * 3 + 1]\n    return this.ranges[index * 3] + diff + recoverOffset(value)\n  }\n\n  // : (number, ?number)  MapResult\n  mapResult(pos, assoc = 1) { return this._map(pos, assoc, false) }\n\n  // : (number, ?number)  number\n  map(pos, assoc = 1) { return this._map(pos, assoc, true) }\n\n  _map(pos, assoc, simple) {\n    let diff = 0, oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2\n    for (let i = 0; i < this.ranges.length; i += 3) {\n      let start = this.ranges[i] - (this.inverted ? diff : 0)\n      if (start > pos) break\n      let oldSize = this.ranges[i + oldIndex], newSize = this.ranges[i + newIndex], end = start + oldSize\n      if (pos <= end) {\n        let side = !oldSize ? assoc : pos == start ? -1 : pos == end ? 1 : assoc\n        let result = start + diff + (side < 0 ? 0 : newSize)\n        if (simple) return result\n        let recover = makeRecover(i / 3, pos - start)\n        return new MapResult(result, assoc < 0 ? pos != start : pos != end, recover)\n      }\n      diff += newSize - oldSize\n    }\n    return simple ? pos + diff : new MapResult(pos + diff)\n  }\n\n  touches(pos, recover) {\n    let diff = 0, index = recoverIndex(recover)\n    let oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2\n    for (let i = 0; i < this.ranges.length; i += 3) {\n      let start = this.ranges[i] - (this.inverted ? diff : 0)\n      if (start > pos) break\n      let oldSize = this.ranges[i + oldIndex], end = start + oldSize\n      if (pos <= end && i == index * 3) return true\n      diff += this.ranges[i + newIndex] - oldSize\n    }\n    return false\n  }\n\n  // :: ((oldStart: number, oldEnd: number, newStart: number, newEnd: number))\n  // Calls the given function on each of the changed ranges included in\n  // this map.\n  forEach(f) {\n    let oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2\n    for (let i = 0, diff = 0; i < this.ranges.length; i += 3) {\n      let start = this.ranges[i], oldStart = start - (this.inverted ? diff : 0), newStart = start + (this.inverted ? 0 : diff)\n      let oldSize = this.ranges[i + oldIndex], newSize = this.ranges[i + newIndex]\n      f(oldStart, oldStart + oldSize, newStart, newStart + newSize)\n      diff += newSize - oldSize\n    }\n  }\n\n  // :: ()  StepMap\n  // Create an inverted version of this map. The result can be used to\n  // map positions in the post-step document to the pre-step document.\n  invert() {\n    return new StepMap(this.ranges, !this.inverted)\n  }\n\n  toString() {\n    return (this.inverted ? \"-\" : \"\") + JSON.stringify(this.ranges)\n  }\n\n  // :: (n: number)  StepMap\n  // Create a map that moves all positions by offset `n` (which may be\n  // negative). This can be useful when applying steps meant for a\n  // sub-document to a larger document, or vice-versa.\n  static offset(n) {\n    return n == 0 ? StepMap.empty : new StepMap(n < 0 ? [0, -n, 0] : [0, 0, n])\n  }\n}\n\nStepMap.empty = new StepMap([])\n\n// :: class extends Mappable\n// A mapping represents a pipeline of zero or more [step\n// maps](#transform.StepMap). It has special provisions for losslessly\n// handling mapping positions through a series of steps in which some\n// steps are inverted versions of earlier steps. (This comes up when\n// [rebasing](/docs/guide/#transform.rebasing) steps for\n// collaboration or history management.)\nexport class Mapping {\n  // :: (?[StepMap])\n  // Create a new mapping with the given position maps.\n  constructor(maps, mirror, from, to) {\n    // :: [StepMap]\n    // The step maps in this mapping.\n    this.maps = maps || []\n    // :: number\n    // The starting position in the `maps` array, used when `map` or\n    // `mapResult` is called.\n    this.from = from || 0\n    // :: number\n    // The end position in the `maps` array.\n    this.to = to == null ? this.maps.length : to\n    this.mirror = mirror\n  }\n\n  // :: (?number, ?number)  Mapping\n  // Create a mapping that maps only through a part of this one.\n  slice(from = 0, to = this.maps.length) {\n    return new Mapping(this.maps, this.mirror, from, to)\n  }\n\n  copy() {\n    return new Mapping(this.maps.slice(), this.mirror && this.mirror.slice(), this.from, this.to)\n  }\n\n  // :: (StepMap, ?number)\n  // Add a step map to the end of this mapping. If `mirrors` is\n  // given, it should be the index of the step map that is the mirror\n  // image of this one.\n  appendMap(map, mirrors) {\n    this.to = this.maps.push(map)\n    if (mirrors != null) this.setMirror(this.maps.length - 1, mirrors)\n  }\n\n  // :: (Mapping)\n  // Add all the step maps in a given mapping to this one (preserving\n  // mirroring information).\n  appendMapping(mapping) {\n    for (let i = 0, startSize = this.maps.length; i < mapping.maps.length; i++) {\n      let mirr = mapping.getMirror(i)\n      this.appendMap(mapping.maps[i], mirr != null && mirr < i ? startSize + mirr : null)\n    }\n  }\n\n  // :: (number)  ?number\n  // Finds the offset of the step map that mirrors the map at the\n  // given offset, in this mapping (as per the second argument to\n  // `appendMap`).\n  getMirror(n) {\n    if (this.mirror) for (let i = 0; i < this.mirror.length; i++)\n      if (this.mirror[i] == n) return this.mirror[i + (i % 2 ? -1 : 1)]\n  }\n\n  setMirror(n, m) {\n    if (!this.mirror) this.mirror = []\n    this.mirror.push(n, m)\n  }\n\n  // :: (Mapping)\n  // Append the inverse of the given mapping to this one.\n  appendMappingInverted(mapping) {\n    for (let i = mapping.maps.length - 1, totalSize = this.maps.length + mapping.maps.length; i >= 0; i--) {\n      let mirr = mapping.getMirror(i)\n      this.appendMap(mapping.maps[i].invert(), mirr != null && mirr > i ? totalSize - mirr - 1 : null)\n    }\n  }\n\n  // :: ()  Mapping\n  // Create an inverted version of this mapping.\n  invert() {\n    let inverse = new Mapping\n    inverse.appendMappingInverted(this)\n    return inverse\n  }\n\n  // : (number, ?number)  number\n  // Map a position through this mapping.\n  map(pos, assoc = 1) {\n    if (this.mirror) return this._map(pos, assoc, true)\n    for (let i = this.from; i < this.to; i++)\n      pos = this.maps[i].map(pos, assoc)\n    return pos\n  }\n\n  // : (number, ?number)  MapResult\n  // Map a position through this mapping, returning a mapping\n  // result.\n  mapResult(pos, assoc = 1) { return this._map(pos, assoc, false) }\n\n  _map(pos, assoc, simple) {\n    let deleted = false, recoverables = null\n\n    for (let i = this.from; i < this.to; i++) {\n      let map = this.maps[i], rec = recoverables && recoverables[i]\n      if (rec != null && map.touches(pos, rec)) {\n        pos = map.recover(rec)\n        continue\n      }\n\n      let result = map.mapResult(pos, assoc)\n      if (result.recover != null) {\n        let corr = this.getMirror(i)\n        if (corr != null && corr > i && corr < this.to) {\n          if (result.deleted) {\n            i = corr\n            pos = this.maps[corr].recover(result.recover)\n            continue\n          } else {\n            ;(recoverables || (recoverables = Object.create(null)))[corr] = result.recover\n          }\n        }\n      }\n\n      if (result.deleted) deleted = true\n      pos = result.pos\n    }\n\n    return simple ? pos : new MapResult(pos, deleted)\n  }\n}\n","import {Mapping} from \"./map\"\n\nexport function TransformError(message) {\n  let err = Error.call(this, message)\n  err.__proto__ = TransformError.prototype\n  return err\n}\n\nTransformError.prototype = Object.create(Error.prototype)\nTransformError.prototype.constructor = TransformError\nTransformError.prototype.name = \"TransformError\"\n\n// ::- Abstraction to build up and track an array of\n// [steps](#transform.Step) representing a document transformation.\n//\n// Most transforming methods return the `Transform` object itself, so\n// that they can be chained.\nexport class Transform {\n  // :: (Node)\n  // Create a transform that starts with the given document.\n  constructor(doc) {\n    // :: Node\n    // The current document (the result of applying the steps in the\n    // transform).\n    this.doc = doc\n    // :: [Step]\n    // The steps in this transform.\n    this.steps = []\n    // :: [Node]\n    // The documents before each of the steps.\n    this.docs = []\n    // :: Mapping\n    // A mapping with the maps for each of the steps in this transform.\n    this.mapping = new Mapping\n  }\n\n  // :: Node The starting document.\n  get before() { return this.docs.length ? this.docs[0] : this.doc }\n\n  // :: (step: Step)  this\n  // Apply a new step in this transform, saving the result. Throws an\n  // error when the step fails.\n  step(object) {\n    let result = this.maybeStep(object)\n    if (result.failed) throw new TransformError(result.failed)\n    return this\n  }\n\n  // :: (Step)  StepResult\n  // Try to apply a step in this transformation, ignoring it if it\n  // fails. Returns the step result.\n  maybeStep(step) {\n    let result = step.apply(this.doc)\n    if (!result.failed) this.addStep(step, result.doc)\n    return result\n  }\n\n  // :: bool\n  // True when the document has been changed (when there are any\n  // steps).\n  get docChanged() {\n    return this.steps.length > 0\n  }\n\n  addStep(step, doc) {\n    this.docs.push(this.doc)\n    this.steps.push(step)\n    this.mapping.appendMap(step.getMap())\n    this.doc = doc\n  }\n}\n","import {ReplaceError} from \"prosemirror-model\"\n\nimport {StepMap} from \"./map\"\n\nfunction mustOverride() { throw new Error(\"Override me\") }\n\nconst stepsByID = Object.create(null)\n\n// ::- A step object represents an atomic change. It generally applies\n// only to the document it was created for, since the positions\n// stored in it will only make sense for that document.\n//\n// New steps are defined by creating classes that extend `Step`,\n// overriding the `apply`, `invert`, `map`, `getMap` and `fromJSON`\n// methods, and registering your class with a unique\n// JSON-serialization identifier using\n// [`Step.jsonID`](#transform.Step^jsonID).\nexport class Step {\n  // :: (doc: Node)  StepResult\n  // Applies this step to the given document, returning a result\n  // object that either indicates failure, if the step can not be\n  // applied to this document, or indicates success by containing a\n  // transformed document.\n  apply(_doc) { return mustOverride() }\n\n  // :: ()  StepMap\n  // Get the step map that represents the changes made by this step,\n  // and which can be used to transform between positions in the old\n  // and the new document.\n  getMap() { return StepMap.empty }\n\n  // :: (doc: Node)  Step\n  // Create an inverted version of this step. Needs the document as it\n  // was before the step as argument.\n  invert(_doc) { return mustOverride() }\n\n  // :: (mapping: Mappable)  ?Step\n  // Map this step through a mappable thing, returning either a\n  // version of that step with its positions adjusted, or `null` if\n  // the step was entirely deleted by the mapping.\n  map(_mapping) { return mustOverride() }\n\n  // :: (other: Step)  ?Step\n  // Try to merge this step with another one, to be applied directly\n  // after it. Returns the merged step when possible, null if the\n  // steps can't be merged.\n  merge(_other) { return null }\n\n  // :: ()  Object\n  // Create a JSON-serializeable representation of this step. When\n  // defining this for a custom subclass, make sure the result object\n  // includes the step type's [JSON id](#transform.Step^jsonID) under\n  // the `stepType` property.\n  toJSON() { return mustOverride() }\n\n  // :: (Schema, Object)  Step\n  // Deserialize a step from its JSON representation. Will call\n  // through to the step class' own implementation of this method.\n  static fromJSON(schema, json) {\n    if (!json || !json.stepType) throw new RangeError(\"Invalid input for Step.fromJSON\")\n    let type = stepsByID[json.stepType]\n    if (!type) throw new RangeError(`No step type ${json.stepType} defined`)\n    return type.fromJSON(schema, json)\n  }\n\n  // :: (string, constructor<Step>)\n  // To be able to serialize steps to JSON, each step needs a string\n  // ID to attach to its JSON representation. Use this method to\n  // register an ID for your step classes. Try to pick something\n  // that's unlikely to clash with steps from other modules.\n  static jsonID(id, stepClass) {\n    if (id in stepsByID) throw new RangeError(\"Duplicate use of step JSON ID \" + id)\n    stepsByID[id] = stepClass\n    stepClass.prototype.jsonID = id\n    return stepClass\n  }\n}\n\n// ::- The result of [applying](#transform.Step.apply) a step. Contains either a\n// new document or a failure value.\nexport class StepResult {\n  // : (?Node, ?string)\n  constructor(doc, failed) {\n    // :: ?Node The transformed document.\n    this.doc = doc\n    // :: ?string Text providing information about a failed step.\n    this.failed = failed\n  }\n\n  // :: (Node)  StepResult\n  // Create a successful step result.\n  static ok(doc) { return new StepResult(doc, null) }\n\n  // :: (string)  StepResult\n  // Create a failed step result.\n  static fail(message) { return new StepResult(null, message) }\n\n  // :: (Node, number, number, Slice)  StepResult\n  // Call [`Node.replace`](#model.Node.replace) with the given\n  // arguments. Create a successful result if it succeeds, and a\n  // failed one if it throws a `ReplaceError`.\n  static fromReplace(doc, from, to, slice) {\n    try {\n      return StepResult.ok(doc.replace(from, to, slice))\n    } catch (e) {\n      if (e instanceof ReplaceError) return StepResult.fail(e.message)\n      throw e\n    }\n  }\n}\n","import {Slice} from \"prosemirror-model\"\n\nimport {Step, StepResult} from \"./step\"\nimport {StepMap} from \"./map\"\n\n// ::- Replace a part of the document with a slice of new content.\nexport class ReplaceStep extends Step {\n  // :: (number, number, Slice, ?bool)\n  // The given `slice` should fit the 'gap' between `from` and\n  // `to`the depths must line up, and the surrounding nodes must be\n  // able to be joined with the open sides of the slice. When\n  // `structure` is true, the step will fail if the content between\n  // from and to is not just a sequence of closing and then opening\n  // tokens (this is to guard against rebased replace steps\n  // overwriting something they weren't supposed to).\n  constructor(from, to, slice, structure) {\n    super()\n    this.from = from\n    this.to = to\n    this.slice = slice\n    this.structure = !!structure\n  }\n\n  apply(doc) {\n    if (this.structure && contentBetween(doc, this.from, this.to))\n      return StepResult.fail(\"Structure replace would overwrite content\")\n    return StepResult.fromReplace(doc, this.from, this.to, this.slice)\n  }\n\n  getMap() {\n    return new StepMap([this.from, this.to - this.from, this.slice.size])\n  }\n\n  invert(doc) {\n    return new ReplaceStep(this.from, this.from + this.slice.size, doc.slice(this.from, this.to))\n  }\n\n  map(mapping) {\n    let from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1)\n    if (from.deleted && to.deleted) return null\n    return new ReplaceStep(from.pos, Math.max(from.pos, to.pos), this.slice)\n  }\n\n  merge(other) {\n    if (!(other instanceof ReplaceStep) || other.structure != this.structure) return null\n\n    if (this.from + this.slice.size == other.from && !this.slice.openEnd && !other.slice.openStart) {\n      let slice = this.slice.size + other.slice.size == 0 ? Slice.empty\n          : new Slice(this.slice.content.append(other.slice.content), this.slice.openStart, other.slice.openEnd)\n      return new ReplaceStep(this.from, this.to + (other.to - other.from), slice, this.structure)\n    } else if (other.to == this.from && !this.slice.openStart && !other.slice.openEnd) {\n      let slice = this.slice.size + other.slice.size == 0 ? Slice.empty\n          : new Slice(other.slice.content.append(this.slice.content), other.slice.openStart, this.slice.openEnd)\n      return new ReplaceStep(other.from, this.to, slice, this.structure)\n    } else {\n      return null\n    }\n  }\n\n  toJSON() {\n    let json = {stepType: \"replace\", from: this.from, to: this.to}\n    if (this.slice.size) json.slice = this.slice.toJSON()\n    if (this.structure) json.structure = true\n    return json\n  }\n\n  static fromJSON(schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      throw new RangeError(\"Invalid input for ReplaceStep.fromJSON\")\n    return new ReplaceStep(json.from, json.to, Slice.fromJSON(schema, json.slice), !!json.structure)\n  }\n}\n\nStep.jsonID(\"replace\", ReplaceStep)\n\n// ::- Replace a part of the document with a slice of content, but\n// preserve a range of the replaced content by moving it into the\n// slice.\nexport class ReplaceAroundStep extends Step {\n  // :: (number, number, number, number, Slice, number, ?bool)\n  // Create a replace-around step with the given range and gap.\n  // `insert` should be the point in the slice into which the content\n  // of the gap should be moved. `structure` has the same meaning as\n  // it has in the [`ReplaceStep`](#transform.ReplaceStep) class.\n  constructor(from, to, gapFrom, gapTo, slice, insert, structure) {\n    super()\n    this.from = from\n    this.to = to\n    this.gapFrom = gapFrom\n    this.gapTo = gapTo\n    this.slice = slice\n    this.insert = insert\n    this.structure = !!structure\n  }\n\n  apply(doc) {\n    if (this.structure && (contentBetween(doc, this.from, this.gapFrom) ||\n                           contentBetween(doc, this.gapTo, this.to)))\n      return StepResult.fail(\"Structure gap-replace would overwrite content\")\n\n    let gap = doc.slice(this.gapFrom, this.gapTo)\n    if (gap.openStart || gap.openEnd)\n      return StepResult.fail(\"Gap is not a flat range\")\n    let inserted = this.slice.insertAt(this.insert, gap.content)\n    if (!inserted) return StepResult.fail(\"Content does not fit in gap\")\n    return StepResult.fromReplace(doc, this.from, this.to, inserted)\n  }\n\n  getMap() {\n    return new StepMap([this.from, this.gapFrom - this.from, this.insert,\n                        this.gapTo, this.to - this.gapTo, this.slice.size - this.insert])\n  }\n\n  invert(doc) {\n    let gap = this.gapTo - this.gapFrom\n    return new ReplaceAroundStep(this.from, this.from + this.slice.size + gap,\n                                 this.from + this.insert, this.from + this.insert + gap,\n                                 doc.slice(this.from, this.to).removeBetween(this.gapFrom - this.from, this.gapTo - this.from),\n                                 this.gapFrom - this.from, this.structure)\n  }\n\n  map(mapping) {\n    let from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1)\n    let gapFrom = mapping.map(this.gapFrom, -1), gapTo = mapping.map(this.gapTo, 1)\n    if ((from.deleted && to.deleted) || gapFrom < from.pos || gapTo > to.pos) return null\n    return new ReplaceAroundStep(from.pos, to.pos, gapFrom, gapTo, this.slice, this.insert, this.structure)\n  }\n\n  toJSON() {\n    let json = {stepType: \"replaceAround\", from: this.from, to: this.to,\n                gapFrom: this.gapFrom, gapTo: this.gapTo, insert: this.insert}\n    if (this.slice.size) json.slice = this.slice.toJSON()\n    if (this.structure) json.structure = true\n    return json\n  }\n\n  static fromJSON(schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\" ||\n        typeof json.gapFrom != \"number\" || typeof json.gapTo != \"number\" || typeof json.insert != \"number\")\n      throw new RangeError(\"Invalid input for ReplaceAroundStep.fromJSON\")\n    return new ReplaceAroundStep(json.from, json.to, json.gapFrom, json.gapTo,\n                                 Slice.fromJSON(schema, json.slice), json.insert, !!json.structure)\n  }\n}\n\nStep.jsonID(\"replaceAround\", ReplaceAroundStep)\n\nfunction contentBetween(doc, from, to) {\n  let $from = doc.resolve(from), dist = to - from, depth = $from.depth\n  while (dist > 0 && depth > 0 && $from.indexAfter(depth) == $from.node(depth).childCount) {\n    depth--\n    dist--\n  }\n  if (dist > 0) {\n    let next = $from.node(depth).maybeChild($from.indexAfter(depth))\n    while (dist > 0) {\n      if (!next || next.isLeaf) return true\n      next = next.firstChild\n      dist--\n    }\n  }\n  return false\n}\n","import {Slice, Fragment} from \"prosemirror-model\"\n\nimport {Transform} from \"./transform\"\nimport {ReplaceStep, ReplaceAroundStep} from \"./replace_step\"\n\nfunction canCut(node, start, end) {\n  return (start == 0 || node.canReplace(start, node.childCount)) &&\n    (end == node.childCount || node.canReplace(0, end))\n}\n\n// :: (NodeRange)  ?number\n// Try to find a target depth to which the content in the given range\n// can be lifted. Will not go across\n// [isolating](#model.NodeSpec.isolating) parent nodes.\nexport function liftTarget(range) {\n  let parent = range.parent\n  let content = parent.content.cutByIndex(range.startIndex, range.endIndex)\n  for (let depth = range.depth;; --depth) {\n    let node = range.$from.node(depth)\n    let index = range.$from.index(depth), endIndex = range.$to.indexAfter(depth)\n    if (depth < range.depth && node.canReplace(index, endIndex, content))\n      return depth\n    if (depth == 0 || node.type.spec.isolating || !canCut(node, index, endIndex)) break\n  }\n}\n\n// :: (NodeRange, number)  this\n// Split the content in the given range off from its parent, if there\n// is sibling content before or after it, and move it up the tree to\n// the depth specified by `target`. You'll probably want to use\n// [`liftTarget`](#transform.liftTarget) to compute `target`, to make\n// sure the lift is valid.\nTransform.prototype.lift = function(range, target) {\n  let {$from, $to, depth} = range\n\n  let gapStart = $from.before(depth + 1), gapEnd = $to.after(depth + 1)\n  let start = gapStart, end = gapEnd\n\n  let before = Fragment.empty, openStart = 0\n  for (let d = depth, splitting = false; d > target; d--)\n    if (splitting || $from.index(d) > 0) {\n      splitting = true\n      before = Fragment.from($from.node(d).copy(before))\n      openStart++\n    } else {\n      start--\n    }\n  let after = Fragment.empty, openEnd = 0\n  for (let d = depth, splitting = false; d > target; d--)\n    if (splitting || $to.after(d + 1) < $to.end(d)) {\n      splitting = true\n      after = Fragment.from($to.node(d).copy(after))\n      openEnd++\n    } else {\n      end++\n    }\n\n  return this.step(new ReplaceAroundStep(start, end, gapStart, gapEnd,\n                                         new Slice(before.append(after), openStart, openEnd),\n                                         before.size - openStart, true))\n}\n\n// :: (NodeRange, NodeType, ?Object, ?NodeRange)  ?[{type: NodeType, attrs: ?Object}]\n// Try to find a valid way to wrap the content in the given range in a\n// node of the given type. May introduce extra nodes around and inside\n// the wrapper node, if necessary. Returns null if no valid wrapping\n// could be found. When `innerRange` is given, that range's content is\n// used as the content to fit into the wrapping, instead of the\n// content of `range`.\nexport function findWrapping(range, nodeType, attrs, innerRange = range) {\n  let around = findWrappingOutside(range, nodeType)\n  let inner = around && findWrappingInside(innerRange, nodeType)\n  if (!inner) return null\n  return around.map(withAttrs).concat({type: nodeType, attrs}).concat(inner.map(withAttrs))\n}\n\nfunction withAttrs(type) { return {type, attrs: null} }\n\nfunction findWrappingOutside(range, type) {\n  let {parent, startIndex, endIndex} = range\n  let around = parent.contentMatchAt(startIndex).findWrapping(type)\n  if (!around) return null\n  let outer = around.length ? around[0] : type\n  return parent.canReplaceWith(startIndex, endIndex, outer) ? around : null\n}\n\nfunction findWrappingInside(range, type) {\n  let {parent, startIndex, endIndex} = range\n  let inner = parent.child(startIndex)\n  let inside = type.contentMatch.findWrapping(inner.type)\n  if (!inside) return null\n  let lastType = inside.length ? inside[inside.length - 1] : type\n  let innerMatch = lastType.contentMatch\n  for (let i = startIndex; innerMatch && i < endIndex; i++)\n    innerMatch = innerMatch.matchType(parent.child(i).type)\n  if (!innerMatch || !innerMatch.validEnd) return null\n  return inside\n}\n\n// :: (NodeRange, [{type: NodeType, attrs: ?Object}])  this\n// Wrap the given [range](#model.NodeRange) in the given set of wrappers.\n// The wrappers are assumed to be valid in this position, and should\n// probably be computed with [`findWrapping`](#transform.findWrapping).\nTransform.prototype.wrap = function(range, wrappers) {\n  let content = Fragment.empty\n  for (let i = wrappers.length - 1; i >= 0; i--)\n    content = Fragment.from(wrappers[i].type.create(wrappers[i].attrs, content))\n\n  let start = range.start, end = range.end\n  return this.step(new ReplaceAroundStep(start, end, start, end, new Slice(content, 0, 0), wrappers.length, true))\n}\n\n// :: (number, ?number, NodeType, ?Object)  this\n// Set the type of all textblocks (partly) between `from` and `to` to\n// the given node type with the given attributes.\nTransform.prototype.setBlockType = function(from, to = from, type, attrs) {\n  if (!type.isTextblock) throw new RangeError(\"Type given to setBlockType should be a textblock\")\n  let mapFrom = this.steps.length\n  this.doc.nodesBetween(from, to, (node, pos) => {\n    if (node.isTextblock && !node.hasMarkup(type, attrs) && canChangeType(this.doc, this.mapping.slice(mapFrom).map(pos), type)) {\n      // Ensure all markup that isn't allowed in the new node type is cleared\n      this.clearIncompatible(this.mapping.slice(mapFrom).map(pos, 1), type)\n      let mapping = this.mapping.slice(mapFrom)\n      let startM = mapping.map(pos, 1), endM = mapping.map(pos + node.nodeSize, 1)\n      this.step(new ReplaceAroundStep(startM, endM, startM + 1, endM - 1,\n                                      new Slice(Fragment.from(type.create(attrs, null, node.marks)), 0, 0), 1, true))\n      return false\n    }\n  })\n  return this\n}\n\nfunction canChangeType(doc, pos, type) {\n  let $pos = doc.resolve(pos), index = $pos.index()\n  return $pos.parent.canReplaceWith(index, index + 1, type)\n}\n\n// :: (number, ?NodeType, ?Object, ?[Mark])  this\n// Change the type, attributes, and/or marks of the node at `pos`.\n// When `type` isn't given, the existing node type is preserved,\nTransform.prototype.setNodeMarkup = function(pos, type, attrs, marks) {\n  let node = this.doc.nodeAt(pos)\n  if (!node) throw new RangeError(\"No node at given position\")\n  if (!type) type = node.type\n  let newNode = type.create(attrs, null, marks || node.marks)\n  if (node.isLeaf)\n    return this.replaceWith(pos, pos + node.nodeSize, newNode)\n\n  if (!type.validContent(node.content))\n    throw new RangeError(\"Invalid content for node type \" + type.name)\n\n  return this.step(new ReplaceAroundStep(pos, pos + node.nodeSize, pos + 1, pos + node.nodeSize - 1,\n                                         new Slice(Fragment.from(newNode), 0, 0), 1, true))\n}\n\n// :: (Node, number, number, ?[?{type: NodeType, attrs: ?Object}])  bool\n// Check whether splitting at the given position is allowed.\nexport function canSplit(doc, pos, depth = 1, typesAfter) {\n  let $pos = doc.resolve(pos), base = $pos.depth - depth\n  let innerType = (typesAfter && typesAfter[typesAfter.length - 1]) || $pos.parent\n  if (base < 0 || $pos.parent.type.spec.isolating ||\n      !$pos.parent.canReplace($pos.index(), $pos.parent.childCount) ||\n      !innerType.type.validContent($pos.parent.content.cutByIndex($pos.index(), $pos.parent.childCount)))\n    return false\n  for (let d = $pos.depth - 1, i = depth - 2; d > base; d--, i--) {\n    let node = $pos.node(d), index = $pos.index(d)\n    if (node.type.spec.isolating) return false\n    let rest = node.content.cutByIndex(index, node.childCount)\n    let after = (typesAfter && typesAfter[i]) || node\n    if (after != node) rest = rest.replaceChild(0, after.type.create(after.attrs))\n    if (!node.canReplace(index + 1, node.childCount) || !after.type.validContent(rest))\n      return false\n  }\n  let index = $pos.indexAfter(base)\n  let baseType = typesAfter && typesAfter[0]\n  return $pos.node(base).canReplaceWith(index, index, baseType ? baseType.type : $pos.node(base + 1).type)\n}\n\n// :: (number, ?number, ?[?{type: NodeType, attrs: ?Object}])  this\n// Split the node at the given position, and optionally, if `depth` is\n// greater than one, any number of nodes above that. By default, the\n// parts split off will inherit the node type of the original node.\n// This can be changed by passing an array of types and attributes to\n// use after the split.\nTransform.prototype.split = function(pos, depth = 1, typesAfter) {\n  let $pos = this.doc.resolve(pos), before = Fragment.empty, after = Fragment.empty\n  for (let d = $pos.depth, e = $pos.depth - depth, i = depth - 1; d > e; d--, i--) {\n    before = Fragment.from($pos.node(d).copy(before))\n    let typeAfter = typesAfter && typesAfter[i]\n    after = Fragment.from(typeAfter ? typeAfter.type.create(typeAfter.attrs, after) : $pos.node(d).copy(after))\n  }\n  return this.step(new ReplaceStep(pos, pos, new Slice(before.append(after), depth, depth), true))\n}\n\n// :: (Node, number)  bool\n// Test whether the blocks before and after a given position can be\n// joined.\nexport function canJoin(doc, pos) {\n  let $pos = doc.resolve(pos), index = $pos.index()\n  return joinable($pos.nodeBefore, $pos.nodeAfter) &&\n    $pos.parent.canReplace(index, index + 1)\n}\n\nfunction joinable(a, b) {\n  return a && b && !a.isLeaf && a.canAppend(b)\n}\n\n// :: (Node, number, ?number)  ?number\n// Find an ancestor of the given position that can be joined to the\n// block before (or after if `dir` is positive). Returns the joinable\n// point, if any.\nexport function joinPoint(doc, pos, dir = -1) {\n  let $pos = doc.resolve(pos)\n  for (let d = $pos.depth;; d--) {\n    let before, after, index = $pos.index(d)\n    if (d == $pos.depth) {\n      before = $pos.nodeBefore\n      after = $pos.nodeAfter\n    } else if (dir > 0) {\n      before = $pos.node(d + 1)\n      index++\n      after = $pos.node(d).maybeChild(index)\n    } else {\n      before = $pos.node(d).maybeChild(index - 1)\n      after = $pos.node(d + 1)\n    }\n    if (before && !before.isTextblock && joinable(before, after) &&\n        $pos.node(d).canReplace(index, index + 1)) return pos\n    if (d == 0) break\n    pos = dir < 0 ? $pos.before(d) : $pos.after(d)\n  }\n}\n\n// :: (number, ?number)  this\n// Join the blocks around the given position. If depth is 2, their\n// last and first siblings are also joined, and so on.\nTransform.prototype.join = function(pos, depth = 1) {\n  let step = new ReplaceStep(pos - depth, pos + depth, Slice.empty, true)\n  return this.step(step)\n}\n\n// :: (Node, number, NodeType)  ?number\n// Try to find a point where a node of the given type can be inserted\n// near `pos`, by searching up the node hierarchy when `pos` itself\n// isn't a valid place but is at the start or end of a node. Return\n// null if no position was found.\nexport function insertPoint(doc, pos, nodeType) {\n  let $pos = doc.resolve(pos)\n  if ($pos.parent.canReplaceWith($pos.index(), $pos.index(), nodeType)) return pos\n\n  if ($pos.parentOffset == 0)\n    for (let d = $pos.depth - 1; d >= 0; d--) {\n      let index = $pos.index(d)\n      if ($pos.node(d).canReplaceWith(index, index, nodeType)) return $pos.before(d + 1)\n      if (index > 0) return null\n    }\n  if ($pos.parentOffset == $pos.parent.content.size)\n    for (let d = $pos.depth - 1; d >= 0; d--) {\n      let index = $pos.indexAfter(d)\n      if ($pos.node(d).canReplaceWith(index, index, nodeType)) return $pos.after(d + 1)\n      if (index < $pos.node(d).childCount) return null\n    }\n}\n\n// :: (Node, number, Slice)  ?number\n// Finds a position at or around the given position where the given\n// slice can be inserted. Will look at parent nodes' nearest boundary\n// and try there, even if the original position wasn't directly at the\n// start or end of that node. Returns null when no position was found.\nexport function dropPoint(doc, pos, slice) {\n  let $pos = doc.resolve(pos)\n  if (!slice.content.size) return pos\n  let content = slice.content\n  for (let i = 0; i < slice.openStart; i++) content = content.firstChild.content\n  for (let pass = 1; pass <= (slice.openStart == 0 && slice.size ? 2 : 1); pass++) {\n    for (let d = $pos.depth; d >= 0; d--) {\n      let bias = d == $pos.depth ? 0 : $pos.pos <= ($pos.start(d + 1) + $pos.end(d + 1)) / 2 ? -1 : 1\n      let insertPos = $pos.index(d) + (bias > 0 ? 1 : 0)\n      if (pass == 1\n          ? $pos.node(d).canReplace(insertPos, insertPos, content)\n          : $pos.node(d).contentMatchAt(insertPos).findWrapping(content.firstChild.type))\n        return bias == 0 ? $pos.pos : bias < 0 ? $pos.before(d + 1) : $pos.after(d + 1)\n    }\n  }\n  return null\n}\n","import {Fragment, Slice} from \"prosemirror-model\"\nimport {Step, StepResult} from \"./step\"\n\nfunction mapFragment(fragment, f, parent) {\n  let mapped = []\n  for (let i = 0; i < fragment.childCount; i++) {\n    let child = fragment.child(i)\n    if (child.content.size) child = child.copy(mapFragment(child.content, f, child))\n    if (child.isInline) child = f(child, parent, i)\n    mapped.push(child)\n  }\n  return Fragment.fromArray(mapped)\n}\n\n// ::- Add a mark to all inline content between two positions.\nexport class AddMarkStep extends Step {\n  // :: (number, number, Mark)\n  constructor(from, to, mark) {\n    super()\n    this.from = from\n    this.to = to\n    this.mark = mark\n  }\n\n  apply(doc) {\n    let oldSlice = doc.slice(this.from, this.to), $from = doc.resolve(this.from)\n    let parent = $from.node($from.sharedDepth(this.to))\n    let slice = new Slice(mapFragment(oldSlice.content, (node, parent) => {\n      if (!parent.type.allowsMarkType(this.mark.type)) return node\n      return node.mark(this.mark.addToSet(node.marks))\n    }, parent), oldSlice.openStart, oldSlice.openEnd)\n    return StepResult.fromReplace(doc, this.from, this.to, slice)\n  }\n\n  invert() {\n    return new RemoveMarkStep(this.from, this.to, this.mark)\n  }\n\n  map(mapping) {\n    let from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1)\n    if (from.deleted && to.deleted || from.pos >= to.pos) return null\n    return new AddMarkStep(from.pos, to.pos, this.mark)\n  }\n\n  merge(other) {\n    if (other instanceof AddMarkStep &&\n        other.mark.eq(this.mark) &&\n        this.from <= other.to && this.to >= other.from)\n      return new AddMarkStep(Math.min(this.from, other.from),\n                             Math.max(this.to, other.to), this.mark)\n  }\n\n  toJSON() {\n    return {stepType: \"addMark\", mark: this.mark.toJSON(),\n            from: this.from, to: this.to}\n  }\n\n  static fromJSON(schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      throw new RangeError(\"Invalid input for AddMarkStep.fromJSON\")\n    return new AddMarkStep(json.from, json.to, schema.markFromJSON(json.mark))\n  }\n}\n\nStep.jsonID(\"addMark\", AddMarkStep)\n\n// ::- Remove a mark from all inline content between two positions.\nexport class RemoveMarkStep extends Step {\n  // :: (number, number, Mark)\n  constructor(from, to, mark) {\n    super()\n    this.from = from\n    this.to = to\n    this.mark = mark\n  }\n\n  apply(doc) {\n    let oldSlice = doc.slice(this.from, this.to)\n    let slice = new Slice(mapFragment(oldSlice.content, node => {\n      return node.mark(this.mark.removeFromSet(node.marks))\n    }), oldSlice.openStart, oldSlice.openEnd)\n    return StepResult.fromReplace(doc, this.from, this.to, slice)\n  }\n\n  invert() {\n    return new AddMarkStep(this.from, this.to, this.mark)\n  }\n\n  map(mapping) {\n    let from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1)\n    if (from.deleted && to.deleted || from.pos >= to.pos) return null\n    return new RemoveMarkStep(from.pos, to.pos, this.mark)\n  }\n\n  merge(other) {\n    if (other instanceof RemoveMarkStep &&\n        other.mark.eq(this.mark) &&\n        this.from <= other.to && this.to >= other.from)\n      return new RemoveMarkStep(Math.min(this.from, other.from),\n                                Math.max(this.to, other.to), this.mark)\n  }\n\n  toJSON() {\n    return {stepType: \"removeMark\", mark: this.mark.toJSON(),\n            from: this.from, to: this.to}\n  }\n\n  static fromJSON(schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      throw new RangeError(\"Invalid input for RemoveMarkStep.fromJSON\")\n    return new RemoveMarkStep(json.from, json.to, schema.markFromJSON(json.mark))\n  }\n}\n\nStep.jsonID(\"removeMark\", RemoveMarkStep)\n","import {Slice, Fragment} from \"prosemirror-model\"\nimport {ReplaceStep, ReplaceAroundStep} from \"prosemirror-transform\"\n\nconst classesById = Object.create(null)\n\n// ::- Superclass for editor selections. Every selection type should\n// extend this. Should not be instantiated directly.\nexport class Selection {\n  // :: (ResolvedPos, ResolvedPos, ?[SelectionRange])\n  // Initialize a selection with the head and anchor and ranges. If no\n  // ranges are given, constructs a single range across `$anchor` and\n  // `$head`.\n  constructor($anchor, $head, ranges) {\n    // :: [SelectionRange]\n    // The ranges covered by the selection.\n    this.ranges = ranges || [new SelectionRange($anchor.min($head), $anchor.max($head))]\n    // :: ResolvedPos\n    // The resolved anchor of the selection (the side that stays in\n    // place when the selection is modified).\n    this.$anchor = $anchor\n    // :: ResolvedPos\n    // The resolved head of the selection (the side that moves when\n    // the selection is modified).\n    this.$head = $head\n  }\n\n  // :: number\n  // The selection's anchor, as an unresolved position.\n  get anchor() { return this.$anchor.pos }\n\n  // :: number\n  // The selection's head.\n  get head() { return this.$head.pos }\n\n  // :: number\n  // The lower bound of the selection's main range.\n  get from() { return this.$from.pos }\n\n  // :: number\n  // The upper bound of the selection's main range.\n  get to() { return this.$to.pos }\n\n  // :: ResolvedPos\n  // The resolved lower  bound of the selection's main range.\n  get $from() {\n    return this.ranges[0].$from\n  }\n\n  // :: ResolvedPos\n  // The resolved upper bound of the selection's main range.\n  get $to() {\n    return this.ranges[0].$to\n  }\n\n  // :: bool\n  // Indicates whether the selection contains any content.\n  get empty() {\n    let ranges = this.ranges\n    for (let i = 0; i < ranges.length; i++)\n      if (ranges[i].$from.pos != ranges[i].$to.pos) return false\n    return true\n  }\n\n  // eq:: (Selection)  bool\n  // Test whether the selection is the same as another selection.\n\n  // map:: (doc: Node, mapping: Mappable)  Selection\n  // Map this selection through a [mappable](#transform.Mappable) thing. `doc`\n  // should be the new document to which we are mapping.\n\n  // :: ()  Slice\n  // Get the content of this selection as a slice.\n  content() {\n    return this.$from.node(0).slice(this.from, this.to, true)\n  }\n\n  // :: (Transaction, ?Slice)\n  // Replace the selection with a slice or, if no slice is given,\n  // delete the selection. Will append to the given transaction.\n  replace(tr, content = Slice.empty) {\n    // Put the new selection at the position after the inserted\n    // content. When that ended in an inline node, search backwards,\n    // to get the position after that node. If not, search forward.\n    let lastNode = content.content.lastChild, lastParent = null\n    for (let i = 0; i < content.openEnd; i++) {\n      lastParent = lastNode\n      lastNode = lastNode.lastChild\n    }\n\n    let mapFrom = tr.steps.length, ranges = this.ranges\n    for (let i = 0; i < ranges.length; i++) {\n      let {$from, $to} = ranges[i], mapping = tr.mapping.slice(mapFrom)\n      tr.replaceRange(mapping.map($from.pos), mapping.map($to.pos), i ? Slice.empty : content)\n      if (i == 0)\n        selectionToInsertionEnd(tr, mapFrom, (lastNode ? lastNode.isInline : lastParent && lastParent.isTextblock) ? -1 : 1)\n    }\n  }\n\n  // :: (Transaction, Node)\n  // Replace the selection with the given node, appending the changes\n  // to the given transaction.\n  replaceWith(tr, node) {\n    let mapFrom = tr.steps.length, ranges = this.ranges\n    for (let i = 0; i < ranges.length; i++) {\n      let {$from, $to} = ranges[i], mapping = tr.mapping.slice(mapFrom)\n      let from = mapping.map($from.pos), to = mapping.map($to.pos)\n      if (i) {\n        tr.deleteRange(from, to)\n      } else {\n        tr.replaceRangeWith(from, to, node)\n        selectionToInsertionEnd(tr, mapFrom, node.isInline ? -1 : 1)\n      }\n    }\n  }\n\n  // toJSON:: ()  Object\n  // Convert the selection to a JSON representation. When implementing\n  // this for a custom selection class, make sure to give the object a\n  // `type` property whose value matches the ID under which you\n  // [registered](#state.Selection^jsonID) your class.\n\n  // :: (ResolvedPos, number, ?bool)  ?Selection\n  // Find a valid cursor or leaf node selection starting at the given\n  // position and searching back if `dir` is negative, and forward if\n  // positive. When `textOnly` is true, only consider cursor\n  // selections. Will return null when no valid selection position is\n  // found.\n  static findFrom($pos, dir, textOnly) {\n    let inner = $pos.parent.inlineContent ? new TextSelection($pos)\n        : findSelectionIn($pos.node(0), $pos.parent, $pos.pos, $pos.index(), dir, textOnly)\n    if (inner) return inner\n\n    for (let depth = $pos.depth - 1; depth >= 0; depth--) {\n      let found = dir < 0\n          ? findSelectionIn($pos.node(0), $pos.node(depth), $pos.before(depth + 1), $pos.index(depth), dir, textOnly)\n          : findSelectionIn($pos.node(0), $pos.node(depth), $pos.after(depth + 1), $pos.index(depth) + 1, dir, textOnly)\n      if (found) return found\n    }\n  }\n\n  // :: (ResolvedPos, ?number)  Selection\n  // Find a valid cursor or leaf node selection near the given\n  // position. Searches forward first by default, but if `bias` is\n  // negative, it will search backwards first.\n  static near($pos, bias = 1) {\n    return this.findFrom($pos, bias) || this.findFrom($pos, -bias) || new AllSelection($pos.node(0))\n  }\n\n  // :: (Node)  Selection\n  // Find the cursor or leaf node selection closest to the start of\n  // the given document. Will return an\n  // [`AllSelection`](#state.AllSelection) if no valid position\n  // exists.\n  static atStart(doc) {\n    return findSelectionIn(doc, doc, 0, 0, 1) || new AllSelection(doc)\n  }\n\n  // :: (Node)  Selection\n  // Find the cursor or leaf node selection closest to the end of the\n  // given document.\n  static atEnd(doc) {\n    return findSelectionIn(doc, doc, doc.content.size, doc.childCount, -1) || new AllSelection(doc)\n  }\n\n  // :: (Node, Object)  Selection\n  // Deserialize the JSON representation of a selection. Must be\n  // implemented for custom classes (as a static class method).\n  static fromJSON(doc, json) {\n    if (!json || !json.type) throw new RangeError(\"Invalid input for Selection.fromJSON\")\n    let cls = classesById[json.type]\n    if (!cls) throw new RangeError(`No selection type ${json.type} defined`)\n    return cls.fromJSON(doc, json)\n  }\n\n  // :: (string, constructor<Selection>)\n  // To be able to deserialize selections from JSON, custom selection\n  // classes must register themselves with an ID string, so that they\n  // can be disambiguated. Try to pick something that's unlikely to\n  // clash with classes from other modules.\n  static jsonID(id, selectionClass) {\n    if (id in classesById) throw new RangeError(\"Duplicate use of selection JSON ID \" + id)\n    classesById[id] = selectionClass\n    selectionClass.prototype.jsonID = id\n    return selectionClass\n  }\n\n  // :: ()  SelectionBookmark\n  // Get a [bookmark](#state.SelectionBookmark) for this selection,\n  // which is a value that can be mapped without having access to a\n  // current document, and later resolved to a real selection for a\n  // given document again. (This is used mostly by the history to\n  // track and restore old selections.) The default implementation of\n  // this method just converts the selection to a text selection and\n  // returns the bookmark for that.\n  getBookmark() {\n    return TextSelection.between(this.$anchor, this.$head).getBookmark()\n  }\n}\n\n// :: bool\n// Controls whether, when a selection of this type is active in the\n// browser, the selected range should be visible to the user. Defaults\n// to `true`.\nSelection.prototype.visible = true\n\n// SelectionBookmark:: interface\n// A lightweight, document-independent representation of a selection.\n// You can define a custom bookmark type for a custom selection class\n// to make the history handle it well.\n//\n//   map:: (mapping: Mapping)  SelectionBookmark\n//   Map the bookmark through a set of changes.\n//\n//   resolve:: (doc: Node)  Selection\n//   Resolve the bookmark to a real selection again. This may need to\n//   do some error checking and may fall back to a default (usually\n//   [`TextSelection.between`](#state.TextSelection^between)) if\n//   mapping made the bookmark invalid.\n\n// ::- Represents a selected range in a document.\nexport class SelectionRange {\n  // :: (ResolvedPos, ResolvedPos)\n  constructor($from, $to) {\n    // :: ResolvedPos\n    // The lower bound of the range.\n    this.$from = $from\n    // :: ResolvedPos\n    // The upper bound of the range.\n    this.$to = $to\n  }\n}\n\n// ::- A text selection represents a classical editor selection, with\n// a head (the moving side) and anchor (immobile side), both of which\n// point into textblock nodes. It can be empty (a regular cursor\n// position).\nexport class TextSelection extends Selection {\n  // :: (ResolvedPos, ?ResolvedPos)\n  // Construct a text selection between the given points.\n  constructor($anchor, $head = $anchor) {\n    super($anchor, $head)\n  }\n\n  // :: ?ResolvedPos\n  // Returns a resolved position if this is a cursor selection (an\n  // empty text selection), and null otherwise.\n  get $cursor() { return this.$anchor.pos == this.$head.pos ? this.$head : null }\n\n  map(doc, mapping) {\n    let $head = doc.resolve(mapping.map(this.head))\n    if (!$head.parent.inlineContent) return Selection.near($head)\n    let $anchor = doc.resolve(mapping.map(this.anchor))\n    return new TextSelection($anchor.parent.inlineContent ? $anchor : $head, $head)\n  }\n\n  replace(tr, content = Slice.empty) {\n    super.replace(tr, content)\n    if (content == Slice.empty) {\n      let marks = this.$from.marksAcross(this.$to)\n      if (marks) tr.ensureMarks(marks)\n    }\n  }\n\n  eq(other) {\n    return other instanceof TextSelection && other.anchor == this.anchor && other.head == this.head\n  }\n\n  getBookmark() {\n    return new TextBookmark(this.anchor, this.head)\n  }\n\n  toJSON() {\n    return {type: \"text\", anchor: this.anchor, head: this.head}\n  }\n\n  static fromJSON(doc, json) {\n    if (typeof json.anchor != \"number\" || typeof json.head != \"number\")\n      throw new RangeError(\"Invalid input for TextSelection.fromJSON\")\n    return new TextSelection(doc.resolve(json.anchor), doc.resolve(json.head))\n  }\n\n  // :: (Node, number, ?number)  TextSelection\n  // Create a text selection from non-resolved positions.\n  static create(doc, anchor, head = anchor) {\n    let $anchor = doc.resolve(anchor)\n    return new this($anchor, head == anchor ? $anchor : doc.resolve(head))\n  }\n\n  // :: (ResolvedPos, ResolvedPos, ?number)  Selection\n  // Return a text selection that spans the given positions or, if\n  // they aren't text positions, find a text selection near them.\n  // `bias` determines whether the method searches forward (default)\n  // or backwards (negative number) first. Will fall back to calling\n  // [`Selection.near`](#state.Selection^near) when the document\n  // doesn't contain a valid text position.\n  static between($anchor, $head, bias) {\n    let dPos = $anchor.pos - $head.pos\n    if (!bias || dPos) bias = dPos >= 0 ? 1 : -1\n    if (!$head.parent.inlineContent) {\n      let found = Selection.findFrom($head, bias, true) || Selection.findFrom($head, -bias, true)\n      if (found) $head = found.$head\n      else return Selection.near($head, bias)\n    }\n    if (!$anchor.parent.inlineContent) {\n      if (dPos == 0) {\n        $anchor = $head\n      } else {\n        $anchor = (Selection.findFrom($anchor, -bias, true) || Selection.findFrom($anchor, bias, true)).$anchor\n        if (($anchor.pos < $head.pos) != (dPos < 0)) $anchor = $head\n      }\n    }\n    return new TextSelection($anchor, $head)\n  }\n}\n\nSelection.jsonID(\"text\", TextSelection)\n\nclass TextBookmark {\n  constructor(anchor, head) {\n    this.anchor = anchor\n    this.head = head\n  }\n  map(mapping) {\n    return new TextBookmark(mapping.map(this.anchor), mapping.map(this.head))\n  }\n  resolve(doc) {\n    return TextSelection.between(doc.resolve(this.anchor), doc.resolve(this.head))\n  }\n}\n\n// ::- A node selection is a selection that points at a single node.\n// All nodes marked [selectable](#model.NodeSpec.selectable) can be\n// the target of a node selection. In such a selection, `from` and\n// `to` point directly before and after the selected node, `anchor`\n// equals `from`, and `head` equals `to`..\nexport class NodeSelection extends Selection {\n  // :: (ResolvedPos)\n  // Create a node selection. Does not verify the validity of its\n  // argument.\n  constructor($pos) {\n    let node = $pos.nodeAfter\n    let $end = $pos.node(0).resolve($pos.pos + node.nodeSize)\n    super($pos, $end)\n    // :: Node The selected node.\n    this.node = node\n  }\n\n  map(doc, mapping) {\n    let {deleted, pos} = mapping.mapResult(this.anchor)\n    let $pos = doc.resolve(pos)\n    if (deleted) return Selection.near($pos)\n    return new NodeSelection($pos)\n  }\n\n  content() {\n    return new Slice(Fragment.from(this.node), 0, 0)\n  }\n\n  eq(other) {\n    return other instanceof NodeSelection && other.anchor == this.anchor\n  }\n\n  toJSON() {\n    return {type: \"node\", anchor: this.anchor}\n  }\n\n  getBookmark() { return new NodeBookmark(this.anchor) }\n\n  static fromJSON(doc, json) {\n    if (typeof json.anchor != \"number\")\n      throw new RangeError(\"Invalid input for NodeSelection.fromJSON\")\n    return new NodeSelection(doc.resolve(json.anchor))\n  }\n\n  // :: (Node, number)  NodeSelection\n  // Create a node selection from non-resolved positions.\n  static create(doc, from) {\n    return new this(doc.resolve(from))\n  }\n\n  // :: (Node)  bool\n  // Determines whether the given node may be selected as a node\n  // selection.\n  static isSelectable(node) {\n    return !node.isText && node.type.spec.selectable !== false\n  }\n}\n\nNodeSelection.prototype.visible = false\n\nSelection.jsonID(\"node\", NodeSelection)\n\nclass NodeBookmark {\n  constructor(anchor) {\n    this.anchor = anchor\n  }\n  map(mapping) {\n    let {deleted, pos} = mapping.mapResult(this.anchor)\n    return deleted ? new TextBookmark(pos, pos) : new NodeBookmark(pos)\n  }\n  resolve(doc) {\n    let $pos = doc.resolve(this.anchor), node = $pos.nodeAfter\n    if (node && NodeSelection.isSelectable(node)) return new NodeSelection($pos)\n    return Selection.near($pos)\n  }\n}\n\n// ::- A selection type that represents selecting the whole document\n// (which can not necessarily be expressed with a text selection, when\n// there are for example leaf block nodes at the start or end of the\n// document).\nexport class AllSelection extends Selection {\n  // :: (Node)\n  // Create an all-selection over the given document.\n  constructor(doc) {\n    super(doc.resolve(0), doc.resolve(doc.content.size))\n  }\n\n  replace(tr, content = Slice.empty) {\n    if (content == Slice.empty) {\n      tr.delete(0, tr.doc.content.size)\n      let sel = Selection.atStart(tr.doc)\n      if (!sel.eq(tr.selection)) tr.setSelection(sel)\n    } else {\n      super.replace(tr, content)\n    }\n  }\n\n  toJSON() { return {type: \"all\"} }\n\n  static fromJSON(doc) { return new AllSelection(doc) }\n\n  map(doc) { return new AllSelection(doc) }\n\n  eq(other) { return other instanceof AllSelection }\n\n  getBookmark() { return AllBookmark }\n}\n\nSelection.jsonID(\"all\", AllSelection)\n\nconst AllBookmark = {\n  map() { return this },\n  resolve(doc) { return new AllSelection(doc) }\n}\n\n// FIXME we'll need some awareness of text direction when scanning for selections\n\n// Try to find a selection inside the given node. `pos` points at the\n// position where the search starts. When `text` is true, only return\n// text selections.\nfunction findSelectionIn(doc, node, pos, index, dir, text) {\n  if (node.inlineContent) return TextSelection.create(doc, pos)\n  for (let i = index - (dir > 0 ? 0 : 1); dir > 0 ? i < node.childCount : i >= 0; i += dir) {\n    let child = node.child(i)\n    if (!child.isAtom) {\n      let inner = findSelectionIn(doc, child, pos + dir, dir < 0 ? child.childCount : 0, dir, text)\n      if (inner) return inner\n    } else if (!text && NodeSelection.isSelectable(child)) {\n      return NodeSelection.create(doc, pos - (dir < 0 ? child.nodeSize : 0))\n    }\n    pos += child.nodeSize * dir\n  }\n}\n\nfunction selectionToInsertionEnd(tr, startLen, bias) {\n  let last = tr.steps.length - 1\n  if (last < startLen) return\n  let step = tr.steps[last]\n  if (!(step instanceof ReplaceStep || step instanceof ReplaceAroundStep)) return\n  let map = tr.mapping.maps[last], end\n  map.forEach((_from, _to, _newFrom, newTo) => { if (end == null) end = newTo })\n  tr.setSelection(Selection.near(tr.doc.resolve(end), bias))\n}\n","import {Transform} from \"prosemirror-transform\"\nimport {Mark} from \"prosemirror-model\"\nimport {Selection} from \"./selection\"\n\nconst UPDATED_SEL = 1, UPDATED_MARKS = 2, UPDATED_SCROLL = 4\n\n// ::- An editor state transaction, which can be applied to a state to\n// create an updated state. Use\n// [`EditorState.tr`](#state.EditorState.tr) to create an instance.\n//\n// Transactions track changes to the document (they are a subclass of\n// [`Transform`](#transform.Transform)), but also other state changes,\n// like selection updates and adjustments of the set of [stored\n// marks](#state.EditorState.storedMarks). In addition, you can store\n// metadata properties in a transaction, which are extra pieces of\n// information that client code or plugins can use to describe what a\n// transacion represents, so that they can update their [own\n// state](#state.StateField) accordingly.\n//\n// The [editor view](#view.EditorView) uses a few metadata properties:\n// it will attach a property `\"pointer\"` with the value `true` to\n// selection transactions directly caused by mouse or touch input, and\n// a `\"uiEvent\"` property of that may be `\"paste\"`, `\"cut\"`, or `\"drop\"`.\nexport class Transaction extends Transform {\n  constructor(state) {\n    super(state.doc)\n    // :: number\n    // The timestamp associated with this transaction, in the same\n    // format as `Date.now()`.\n    this.time = Date.now()\n    this.curSelection = state.selection\n    // The step count for which the current selection is valid.\n    this.curSelectionFor = 0\n    // :: ?[Mark]\n    // The stored marks set by this transaction, if any.\n    this.storedMarks = state.storedMarks\n    // Bitfield to track which aspects of the state were updated by\n    // this transaction.\n    this.updated = 0\n    // Object used to store metadata properties for the transaction.\n    this.meta = Object.create(null)\n  }\n\n  // :: Selection\n  // The transaction's current selection. This defaults to the editor\n  // selection [mapped](#state.Selection.map) through the steps in the\n  // transaction, but can be overwritten with\n  // [`setSelection`](#state.Transaction.setSelection).\n  get selection() {\n    if (this.curSelectionFor < this.steps.length) {\n      this.curSelection = this.curSelection.map(this.doc, this.mapping.slice(this.curSelectionFor))\n      this.curSelectionFor = this.steps.length\n    }\n    return this.curSelection\n  }\n\n  // :: (Selection)  Transaction\n  // Update the transaction's current selection. Will determine the\n  // selection that the editor gets when the transaction is applied.\n  setSelection(selection) {\n    if (selection.$from.doc != this.doc)\n      throw new RangeError(\"Selection passed to setSelection must point at the current document\")\n    this.curSelection = selection\n    this.curSelectionFor = this.steps.length\n    this.updated = (this.updated | UPDATED_SEL) & ~UPDATED_MARKS\n    this.storedMarks = null\n    return this\n  }\n\n  // :: bool\n  // Whether the selection was explicitly updated by this transaction.\n  get selectionSet() {\n    return (this.updated & UPDATED_SEL) > 0\n  }\n\n  // :: (?[Mark])  Transaction\n  // Set the current stored marks.\n  setStoredMarks(marks) {\n    this.storedMarks = marks\n    this.updated |= UPDATED_MARKS\n    return this\n  }\n\n  // :: ([Mark])  Transaction\n  // Make sure the current stored marks or, if that is null, the marks\n  // at the selection, match the given set of marks. Does nothing if\n  // this is already the case.\n  ensureMarks(marks) {\n    if (!Mark.sameSet(this.storedMarks || this.selection.$from.marks(), marks))\n      this.setStoredMarks(marks)\n    return this\n  }\n\n  // :: (Mark)  Transaction\n  // Add a mark to the set of stored marks.\n  addStoredMark(mark) {\n    return this.ensureMarks(mark.addToSet(this.storedMarks || this.selection.$head.marks()))\n  }\n\n  // :: (union<Mark, MarkType>)  Transaction\n  // Remove a mark or mark type from the set of stored marks.\n  removeStoredMark(mark) {\n    return this.ensureMarks(mark.removeFromSet(this.storedMarks || this.selection.$head.marks()))\n  }\n\n  // :: bool\n  // Whether the stored marks were explicitly set for this transaction.\n  get storedMarksSet() {\n    return (this.updated & UPDATED_MARKS) > 0\n  }\n\n  addStep(step, doc) {\n    super.addStep(step, doc)\n    this.updated = this.updated & ~UPDATED_MARKS\n    this.storedMarks = null\n  }\n\n  // :: (number)  Transaction\n  // Update the timestamp for the transaction.\n  setTime(time) {\n    this.time = time\n    return this\n  }\n\n  // :: (Slice)  Transaction\n  // Replace the current selection with the given slice.\n  replaceSelection(slice) {\n    this.selection.replace(this, slice)\n    return this\n  }\n\n  // :: (Node, ?bool)  Transaction\n  // Replace the selection with the given node. When `inheritMarks` is\n  // true and the content is inline, it inherits the marks from the\n  // place where it is inserted.\n  replaceSelectionWith(node, inheritMarks) {\n    let selection = this.selection\n    if (inheritMarks !== false)\n      node = node.mark(this.storedMarks || (selection.empty ? selection.$from.marks() : (selection.$from.marksAcross(selection.$to) || Mark.none)))\n    selection.replaceWith(this, node)\n    return this\n  }\n\n  // :: ()  Transaction\n  // Delete the selection.\n  deleteSelection() {\n    this.selection.replace(this)\n    return this\n  }\n\n  // :: (string, from: ?number, to: ?number)  Transaction\n  // Replace the given range, or the selection if no range is given,\n  // with a text node containing the given string.\n  insertText(text, from, to = from) {\n    let schema = this.doc.type.schema\n    if (from == null) {\n      if (!text) return this.deleteSelection()\n      return this.replaceSelectionWith(schema.text(text), true)\n    } else {\n      if (!text) return this.deleteRange(from, to)\n      let marks = this.storedMarks\n      if (!marks) {\n        let $from = this.doc.resolve(from)\n        marks = to == from ? $from.marks() : $from.marksAcross(this.doc.resolve(to))\n      }\n      this.replaceRangeWith(from, to, schema.text(text, marks))\n      if (!this.selection.empty) this.setSelection(Selection.near(this.selection.$to))\n      return this\n    }\n  }\n\n  // :: (union<string, Plugin, PluginKey>, any)  Transaction\n  // Store a metadata property in this transaction, keyed either by\n  // name or by plugin.\n  setMeta(key, value) {\n    this.meta[typeof key == \"string\" ? key : key.key] = value\n    return this\n  }\n\n  // :: (union<string, Plugin, PluginKey>)  any\n  // Retrieve a metadata property for a given name or plugin.\n  getMeta(key) {\n    return this.meta[typeof key == \"string\" ? key : key.key]\n  }\n\n  // :: bool\n  // Returns true if this transaction doesn't contain any metadata,\n  // and can thus safely be extended.\n  get isGeneric() {\n    for (let _ in this.meta) return false\n    return true\n  }\n\n  // :: ()  Transaction\n  // Indicate that the editor should scroll the selection into view\n  // when updated to the state produced by this transaction.\n  scrollIntoView() {\n    this.updated |= UPDATED_SCROLL\n    return this\n  }\n\n  get scrolledIntoView() {\n    return (this.updated & UPDATED_SCROLL) > 0\n  }\n}\n","import {Node} from \"prosemirror-model\"\n\nimport {Selection} from \"./selection\"\nimport {Transaction} from \"./transaction\"\n\nfunction bind(f, self) {\n  return !self || !f ? f : f.bind(self)\n}\n\nclass FieldDesc {\n  constructor(name, desc, self) {\n    this.name = name\n    this.init = bind(desc.init, self)\n    this.apply = bind(desc.apply, self)\n  }\n}\n\nconst baseFields = [\n  new FieldDesc(\"doc\", {\n    init(config) { return config.doc || config.schema.topNodeType.createAndFill() },\n    apply(tr) { return tr.doc }\n  }),\n\n  new FieldDesc(\"selection\", {\n    init(config, instance) { return config.selection || Selection.atStart(instance.doc) },\n    apply(tr) { return tr.selection }\n  }),\n\n  new FieldDesc(\"storedMarks\", {\n    init(config) { return config.storedMarks || null },\n    apply(tr, _marks, _old, state) { return state.selection.$cursor ? tr.storedMarks : null }\n  }),\n\n  new FieldDesc(\"scrollToSelection\", {\n    init() { return 0 },\n    apply(tr, prev) { return tr.scrolledIntoView ? prev + 1 : prev }\n  })\n]\n\n// Object wrapping the part of a state object that stays the same\n// across transactions. Stored in the state's `config` property.\nclass Configuration {\n  constructor(schema, plugins) {\n    this.schema = schema\n    this.fields = baseFields.concat()\n    this.plugins = []\n    this.pluginsByKey = Object.create(null)\n    if (plugins) plugins.forEach(plugin => {\n      if (this.pluginsByKey[plugin.key])\n        throw new RangeError(\"Adding different instances of a keyed plugin (\" + plugin.key + \")\")\n      this.plugins.push(plugin)\n      this.pluginsByKey[plugin.key] = plugin\n      if (plugin.spec.state)\n        this.fields.push(new FieldDesc(plugin.key, plugin.spec.state, plugin))\n    })\n  }\n}\n\n// ::- The state of a ProseMirror editor is represented by an object\n// of this type. A state is a persistent data structureit isn't\n// updated, but rather a new state value is computed from an old one\n// using the [`apply`](#state.EditorState.apply) method.\n//\n// A state holds a number of built-in fields, and plugins can\n// [define](#state.PluginSpec.state) additional fields.\nexport class EditorState {\n  constructor(config) {\n    this.config = config\n  }\n\n  // doc:: Node\n  // The current document.\n\n  // selection:: Selection\n  // The selection.\n\n  // storedMarks:: ?[Mark]\n  // A set of marks to apply to the next input. Will be null when\n  // no explicit marks have been set.\n\n  // :: Schema\n  // The schema of the state's document.\n  get schema() {\n    return this.config.schema\n  }\n\n  // :: [Plugin]\n  // The plugins that are active in this state.\n  get plugins() {\n    return this.config.plugins\n  }\n\n  // :: (Transaction)  EditorState\n  // Apply the given transaction to produce a new state.\n  apply(tr) {\n    return this.applyTransaction(tr).state\n  }\n\n  // : (Transaction)  bool\n  filterTransaction(tr, ignore = -1) {\n    for (let i = 0; i < this.config.plugins.length; i++) if (i != ignore) {\n      let plugin = this.config.plugins[i]\n      if (plugin.spec.filterTransaction && !plugin.spec.filterTransaction.call(plugin, tr, this))\n        return false\n    }\n    return true\n  }\n\n  // :: (Transaction)  {state: EditorState, transactions: [Transaction]}\n  // Verbose variant of [`apply`](#state.EditorState.apply) that\n  // returns the precise transactions that were applied (which might\n  // be influenced by the [transaction\n  // hooks](#state.PluginSpec.filterTransaction) of\n  // plugins) along with the new state.\n  applyTransaction(rootTr) {\n    if (!this.filterTransaction(rootTr)) return {state: this, transactions: []}\n\n    let trs = [rootTr], newState = this.applyInner(rootTr), seen = null\n    // This loop repeatedly gives plugins a chance to respond to\n    // transactions as new transactions are added, making sure to only\n    // pass the transactions the plugin did not see before.\n    outer: for (;;) {\n      let haveNew = false\n      for (let i = 0; i < this.config.plugins.length; i++) {\n        let plugin = this.config.plugins[i]\n        if (plugin.spec.appendTransaction) {\n          let n = seen ? seen[i].n : 0, oldState = seen ? seen[i].state : this\n          let tr = n < trs.length &&\n              plugin.spec.appendTransaction.call(plugin, n ? trs.slice(n) : trs, oldState, newState)\n          if (tr && newState.filterTransaction(tr, i)) {\n            tr.setMeta(\"appendedTransaction\", rootTr)\n            if (!seen) {\n              seen = []\n              for (let j = 0; j < this.config.plugins.length; j++)\n                seen.push(j < i ? {state: newState, n: trs.length} : {state: this, n: 0})\n            }\n            trs.push(tr)\n            newState = newState.applyInner(tr)\n            haveNew = true\n          }\n          if (seen) seen[i] = {state: newState, n: trs.length}\n        }\n      }\n      if (!haveNew) return {state: newState, transactions: trs}\n    }\n  }\n\n  // : (Transaction)  EditorState\n  applyInner(tr) {\n    if (!tr.before.eq(this.doc)) throw new RangeError(\"Applying a mismatched transaction\")\n    let newInstance = new EditorState(this.config), fields = this.config.fields\n    for (let i = 0; i < fields.length; i++) {\n      let field = fields[i]\n      newInstance[field.name] = field.apply(tr, this[field.name], this, newInstance)\n    }\n    for (let i = 0; i < applyListeners.length; i++) applyListeners[i](this, tr, newInstance)\n    return newInstance\n  }\n\n  // :: Transaction\n  // Start a [transaction](#state.Transaction) from this state.\n  get tr() { return new Transaction(this) }\n\n  // :: (Object)  EditorState\n  // Create a new state.\n  //\n  //   config::- Configuration options. Must contain `schema` or `doc` (or both).\n  //\n  //      schema:: ?Schema\n  //      The schema to use.\n  //\n  //      doc:: ?Node\n  //      The starting document.\n  //\n  //      selection:: ?Selection\n  //      A valid selection in the document.\n  //\n  //      storedMarks:: ?[Mark]\n  //      The initial set of [stored marks](#state.EditorState.storedMarks).\n  //\n  //      plugins:: ?[Plugin]\n  //      The plugins that should be active in this state.\n  static create(config) {\n    let $config = new Configuration(config.schema || config.doc.type.schema, config.plugins)\n    let instance = new EditorState($config)\n    for (let i = 0; i < $config.fields.length; i++)\n      instance[$config.fields[i].name] = $config.fields[i].init(config, instance)\n    return instance\n  }\n\n  // :: (Object)  EditorState\n  // Create a new state based on this one, but with an adjusted set of\n  // active plugins. State fields that exist in both sets of plugins\n  // are kept unchanged. Those that no longer exist are dropped, and\n  // those that are new are initialized using their\n  // [`init`](#state.StateField.init) method, passing in the new\n  // configuration object..\n  //\n  //   config::- configuration options\n  //\n  //     schema:: ?Schema\n  //     New schema to use.\n  //\n  //     plugins:: ?[Plugin]\n  //     New set of active plugins.\n  reconfigure(config) {\n    let $config = new Configuration(config.schema || this.schema, config.plugins)\n    let fields = $config.fields, instance = new EditorState($config)\n    for (let i = 0; i < fields.length; i++) {\n      let name = fields[i].name\n      instance[name] = this.hasOwnProperty(name) ? this[name] : fields[i].init(config, instance)\n    }\n    return instance\n  }\n\n  // :: (?union<Object<Plugin>, string, number>)  Object\n  // Serialize this state to JSON. If you want to serialize the state\n  // of plugins, pass an object mapping property names to use in the\n  // resulting JSON object to plugin objects. The argument may also be\n  // a string or number, in which case it is ignored, to support the\n  // way `JSON.stringify` calls `toString` methods.\n  toJSON(pluginFields) {\n    let result = {doc: this.doc.toJSON(), selection: this.selection.toJSON()}\n    if (this.storedMarks) result.storedMarks = this.storedMarks.map(m => m.toJSON())\n    if (pluginFields && typeof pluginFields == 'object') for (let prop in pluginFields) {\n      if (prop == \"doc\" || prop == \"selection\")\n        throw new RangeError(\"The JSON fields `doc` and `selection` are reserved\")\n      let plugin = pluginFields[prop], state = plugin.spec.state\n      if (state && state.toJSON) result[prop] = state.toJSON.call(plugin, this[plugin.key])\n    }\n    return result\n  }\n\n  // :: (Object, Object, ?Object<Plugin>)  EditorState\n  // Deserialize a JSON representation of a state. `config` should\n  // have at least a `schema` field, and should contain array of\n  // plugins to initialize the state with. `pluginFields` can be used\n  // to deserialize the state of plugins, by associating plugin\n  // instances with the property names they use in the JSON object.\n  //\n  //   config::- configuration options\n  //\n  //     schema:: Schema\n  //     The schema to use.\n  //\n  //     plugins:: ?[Plugin]\n  //     The set of active plugins.\n  static fromJSON(config, json, pluginFields) {\n    if (!json) throw new RangeError(\"Invalid input for EditorState.fromJSON\")\n    if (!config.schema) throw new RangeError(\"Required config field 'schema' missing\")\n    let $config = new Configuration(config.schema, config.plugins)\n    let instance = new EditorState($config)\n    $config.fields.forEach(field => {\n      if (field.name == \"doc\") {\n        instance.doc = Node.fromJSON(config.schema, json.doc)\n      } else if (field.name == \"selection\") {\n        instance.selection = Selection.fromJSON(instance.doc, json.selection)\n      } else if (field.name == \"storedMarks\") {\n        if (json.storedMarks) instance.storedMarks = json.storedMarks.map(config.schema.markFromJSON)\n      } else {\n        if (pluginFields) for (let prop in pluginFields) {\n          let plugin = pluginFields[prop], state = plugin.spec.state\n          if (plugin.key == field.name && state && state.fromJSON &&\n              Object.prototype.hasOwnProperty.call(json, prop)) {\n            // This field belongs to a plugin mapped to a JSON field, read it from there.\n            instance[field.name] = state.fromJSON.call(plugin, config, json[prop], instance)\n            return\n          }\n        }\n        instance[field.name] = field.init(config, instance)\n      }\n    })\n    return instance\n  }\n\n  // Kludge to allow the view to track mappings between different\n  // instances of a state.\n  //\n  // FIXME this is no longer needed as of prosemirror-view 1.9.0,\n  // though due to backwards-compat we should probably keep it around\n  // for a while (if only as a no-op)\n  static addApplyListener(f) {\n    applyListeners.push(f)\n  }\n  static removeApplyListener(f) {\n    let found = applyListeners.indexOf(f)\n    if (found > -1) applyListeners.splice(found, 1)\n  }\n}\n\nconst applyListeners = []\n","// PluginSpec:: interface\n//\n// This is the type passed to the [`Plugin`](#state.Plugin)\n// constructor. It provides a definition for a plugin.\n//\n//   props:: ?EditorProps\n//   The [view props](#view.EditorProps) added by this plugin. Props\n//   that are functions will be bound to have the plugin instance as\n//   their `this` binding.\n//\n//   state:: ?StateField<any>\n//   Allows a plugin to define a [state field](#state.StateField), an\n//   extra slot in the state object in which it can keep its own data.\n//\n//   key:: ?PluginKey\n//   Can be used to make this a keyed plugin. You can have only one\n//   plugin with a given key in a given state, but it is possible to\n//   access the plugin's configuration and state through the key,\n//   without having access to the plugin instance object.\n//\n//   view:: ?(EditorView)  Object\n//   When the plugin needs to interact with the editor view, or\n//   set something up in the DOM, use this field. The function\n//   will be called when the plugin's state is associated with an\n//   editor view.\n//\n//     return::-\n//     Should return an object with the following optional\n//     properties:\n//\n//       update:: ?(view: EditorView, prevState: EditorState)\n//       Called whenever the view's state is updated.\n//\n//       destroy:: ?()\n//       Called when the view is destroyed or receives a state\n//       with different plugins.\n//\n//   filterTransaction:: ?(Transaction, EditorState)  bool\n//   When present, this will be called before a transaction is\n//   applied by the state, allowing the plugin to cancel it (by\n//   returning false).\n//\n//   appendTransaction:: ?(transactions: [Transaction], oldState: EditorState, newState: EditorState)  ?Transaction\n//   Allows the plugin to append another transaction to be applied\n//   after the given array of transactions. When another plugin\n//   appends a transaction after this was called, it is called again\n//   with the new state and new transactionsbut only the new\n//   transactions, i.e. it won't be passed transactions that it\n//   already saw.\n\nfunction bindProps(obj, self, target) {\n  for (let prop in obj) {\n    let val = obj[prop]\n    if (val instanceof Function) val = val.bind(self)\n    else if (prop == \"handleDOMEvents\") val = bindProps(val, self, {})\n    target[prop] = val\n  }\n  return target\n}\n\n// ::- Plugins bundle functionality that can be added to an editor.\n// They are part of the [editor state](#state.EditorState) and\n// may influence that state and the view that contains it.\nexport class Plugin {\n  // :: (PluginSpec)\n  // Create a plugin.\n  constructor(spec) {\n    // :: EditorProps\n    // The [props](#view.EditorProps) exported by this plugin.\n    this.props = {}\n    if (spec.props) bindProps(spec.props, this, this.props)\n    // :: Object\n    // The plugin's [spec object](#state.PluginSpec).\n    this.spec = spec\n    this.key = spec.key ? spec.key.key : createKey(\"plugin\")\n  }\n\n  // :: (EditorState)  any\n  // Extract the plugin's state field from an editor state.\n  getState(state) { return state[this.key] }\n}\n\n// StateField:: interface<T>\n// A plugin spec may provide a state field (under its\n// [`state`](#state.PluginSpec.state) property) of this type, which\n// describes the state it wants to keep. Functions provided here are\n// always called with the plugin instance as their `this` binding.\n//\n//   init:: (config: Object, instance: EditorState)  T\n//   Initialize the value of the field. `config` will be the object\n//   passed to [`EditorState.create`](#state.EditorState^create). Note\n//   that `instance` is a half-initialized state instance, and will\n//   not have values for plugin fields initialized after this one.\n//\n//   apply:: (tr: Transaction, value: T, oldState: EditorState, newState: EditorState)  T\n//   Apply the given transaction to this state field, producing a new\n//   field value. Note that the `newState` argument is again a partially\n//   constructed state does not yet contain the state from plugins\n//   coming after this one.\n//\n//   toJSON:: ?(value: T)  *\n//   Convert this field to JSON. Optional, can be left off to disable\n//   JSON serialization for the field.\n//\n//   fromJSON:: ?(config: Object, value: *, state: EditorState)  T\n//   Deserialize the JSON representation of this field. Note that the\n//   `state` argument is again a half-initialized state.\n\nconst keys = Object.create(null)\n\nfunction createKey(name) {\n  if (name in keys) return name + \"$\" + ++keys[name]\n  keys[name] = 0\n  return name + \"$\"\n}\n\n// ::- A key is used to [tag](#state.PluginSpec.key)\n// plugins in a way that makes it possible to find them, given an\n// editor state. Assigning a key does mean only one plugin of that\n// type can be active in a state.\nexport class PluginKey {\n  // :: (?string)\n  // Create a plugin key.\n  constructor(name = \"key\") { this.key = createKey(name) }\n\n  // :: (EditorState)  ?Plugin\n  // Get the active plugin with this key, if any, from an editor\n  // state.\n  get(state) { return state.config.pluginsByKey[this.key] }\n\n  // :: (EditorState)  ?any\n  // Get the plugin's state from an editor state.\n  getState(state) { return state[this.key] }\n}\n","const result = {}\nexport default result\n\nif (typeof navigator != \"undefined\" && typeof document != \"undefined\") {\n  const ie_edge = /Edge\\/(\\d+)/.exec(navigator.userAgent)\n  const ie_upto10 = /MSIE \\d/.test(navigator.userAgent)\n  const ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent)\n\n  result.mac = /Mac/.test(navigator.platform)\n  let ie = result.ie = !!(ie_upto10 || ie_11up || ie_edge)\n  result.ie_version = ie_upto10 ? document.documentMode || 6 : ie_11up ? +ie_11up[1] : ie_edge ? +ie_edge[1] : null\n  result.gecko = !ie && /gecko\\/(\\d+)/i.test(navigator.userAgent)\n  result.gecko_version = result.gecko && +(/Firefox\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1]\n  let chrome = !ie && /Chrome\\/(\\d+)/.exec(navigator.userAgent)\n  result.chrome = !!chrome\n  result.chrome_version = chrome && +chrome[1]\n  result.ios = !ie && /AppleWebKit/.test(navigator.userAgent) && /Mobile\\/\\w+/.test(navigator.userAgent)\n  result.android = /Android \\d/.test(navigator.userAgent)\n  result.webkit = \"webkitFontSmoothing\" in document.documentElement.style\n  result.safari = /Apple Computer/.test(navigator.vendor)\n  result.webkit_version = result.webkit && +(/\\bAppleWebKit\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1]\n}\n","import browser from \"./browser\"\n\nexport const domIndex = function(node) {\n  for (var index = 0;; index++) {\n    node = node.previousSibling\n    if (!node) return index\n  }\n}\n\nexport const parentNode = function(node) {\n  let parent = node.parentNode\n  return parent && parent.nodeType == 11 ? parent.host : parent\n}\n\nexport const textRange = function(node, from, to) {\n  let range = document.createRange()\n  range.setEnd(node, to == null ? node.nodeValue.length : to)\n  range.setStart(node, from || 0)\n  return range\n}\n\n// Scans forward and backward through DOM positions equivalent to the\n// given one to see if the two are in the same place (i.e. after a\n// text node vs at the end of that text node)\nexport const isEquivalentPosition = function(node, off, targetNode, targetOff) {\n  return targetNode && (scanFor(node, off, targetNode, targetOff, -1) ||\n                        scanFor(node, off, targetNode, targetOff, 1))\n}\n\nconst atomElements = /^(img|br|input|textarea|hr)$/i\n\nfunction scanFor(node, off, targetNode, targetOff, dir) {\n  for (;;) {\n    if (node == targetNode && off == targetOff) return true\n    if (off == (dir < 0 ? 0 : nodeSize(node))) {\n      let parent = node.parentNode\n      if (parent.nodeType != 1 || hasBlockDesc(node) || atomElements.test(node.nodeName) || node.contentEditable == \"false\")\n        return false\n      off = domIndex(node) + (dir < 0 ? 0 : 1)\n      node = parent\n    } else if (node.nodeType == 1) {\n      node = node.childNodes[off + (dir < 0 ? -1 : 0)]\n      if (node.contentEditable == \"false\") return false\n      off = dir < 0 ? nodeSize(node) : 0\n    } else {\n      return false\n    }\n  }\n}\n\nexport function nodeSize(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nexport function isOnEdge(node, offset, parent) {\n  for (let atStart = offset == 0, atEnd = offset == nodeSize(node); atStart || atEnd;) {\n    if (node == parent) return true\n    let index = domIndex(node)\n    node = node.parentNode\n    if (!node) return false\n    atStart = atStart && index == 0\n    atEnd = atEnd && index == nodeSize(node)\n  }\n}\n\nfunction hasBlockDesc(dom) {\n  let desc\n  for (let cur = dom; cur; cur = cur.parentNode) if (desc = cur.pmViewDesc) break\n  return desc && desc.node && desc.node.isBlock && (desc.dom == dom || desc.contentDOM == dom)\n}\n\n// Work around Chrome issue https://bugs.chromium.org/p/chromium/issues/detail?id=447523\n// (isCollapsed inappropriately returns true in shadow dom)\nexport const selectionCollapsed = function(domSel) {\n  let collapsed = domSel.isCollapsed\n  if (collapsed && browser.chrome && domSel.rangeCount && !domSel.getRangeAt(0).collapsed)\n    collapsed = false\n  return collapsed\n}\n\nexport function keyEvent(keyCode, key) {\n  let event = document.createEvent(\"Event\")\n  event.initEvent(\"keydown\", true, true)\n  event.keyCode = keyCode\n  event.key = event.code = key\n  return event\n}\n","import {nodeSize, textRange, parentNode} from \"./dom\"\nimport browser from \"./browser\"\n\nfunction windowRect(doc) {\n  return {left: 0, right: doc.documentElement.clientWidth,\n          top: 0, bottom: doc.documentElement.clientHeight}\n}\n\nfunction getSide(value, side) {\n  return typeof value == \"number\" ? value : value[side]\n}\n\nfunction clientRect(node) {\n  let rect = node.getBoundingClientRect()\n  // Make sure scrollbar width isn't included in the rectangle\n  return {left: rect.left, right: rect.left + node.clientWidth,\n          top: rect.top, bottom: rect.top + node.clientHeight}\n}\n\nexport function scrollRectIntoView(view, rect, startDOM) {\n  let scrollThreshold = view.someProp(\"scrollThreshold\") || 0, scrollMargin = view.someProp(\"scrollMargin\") || 5\n  let doc = view.dom.ownerDocument\n  for (let parent = startDOM || view.dom;; parent = parentNode(parent)) {\n    if (!parent) break\n    if (parent.nodeType != 1) continue\n    let atTop = parent == doc.body || parent.nodeType != 1\n    let bounding = atTop ? windowRect(doc) : clientRect(parent)\n    let moveX = 0, moveY = 0\n    if (rect.top < bounding.top + getSide(scrollThreshold, \"top\"))\n      moveY = -(bounding.top - rect.top + getSide(scrollMargin, \"top\"))\n    else if (rect.bottom > bounding.bottom - getSide(scrollThreshold, \"bottom\"))\n      moveY = rect.bottom - bounding.bottom + getSide(scrollMargin, \"bottom\")\n    if (rect.left < bounding.left + getSide(scrollThreshold, \"left\"))\n      moveX = -(bounding.left - rect.left + getSide(scrollMargin, \"left\"))\n    else if (rect.right > bounding.right - getSide(scrollThreshold, \"right\"))\n      moveX = rect.right - bounding.right + getSide(scrollMargin, \"right\")\n    if (moveX || moveY) {\n      if (atTop) {\n        doc.defaultView.scrollBy(moveX, moveY)\n      } else {\n        let startX = parent.scrollLeft, startY = parent.scrollTop\n        if (moveY) parent.scrollTop += moveY\n        if (moveX) parent.scrollLeft += moveX\n        let dX = parent.scrollLeft - startX, dY = parent.scrollTop - startY\n        rect = {left: rect.left - dX, top: rect.top - dY, right: rect.right - dX, bottom: rect.bottom - dY}\n      }\n    }\n    if (atTop) break\n  }\n}\n\n// Store the scroll position of the editor's parent nodes, along with\n// the top position of an element near the top of the editor, which\n// will be used to make sure the visible viewport remains stable even\n// when the size of the content above changes.\nexport function storeScrollPos(view) {\n  let rect = view.dom.getBoundingClientRect(), startY = Math.max(0, rect.top)\n  let refDOM, refTop\n  for (let x = (rect.left + rect.right) / 2, y = startY + 1;\n       y < Math.min(innerHeight, rect.bottom); y += 5) {\n    let dom = view.root.elementFromPoint(x, y)\n    if (dom == view.dom || !view.dom.contains(dom)) continue\n    let localRect = dom.getBoundingClientRect()\n    if (localRect.top >= startY - 20) {\n      refDOM = dom\n      refTop = localRect.top\n      break\n    }\n  }\n  return {refDOM, refTop, stack: scrollStack(view.dom)}\n}\n\nfunction scrollStack(dom) {\n  let stack = [], doc = dom.ownerDocument\n  for (; dom; dom = parentNode(dom)) {\n    stack.push({dom, top: dom.scrollTop, left: dom.scrollLeft})\n    if (dom == doc) break\n  }\n  return stack\n}\n\n// Reset the scroll position of the editor's parent nodes to that what\n// it was before, when storeScrollPos was called.\nexport function resetScrollPos({refDOM, refTop, stack}) {\n  let newRefTop = refDOM ? refDOM.getBoundingClientRect().top : 0\n  restoreScrollStack(stack, newRefTop == 0 ? 0 : newRefTop - refTop)\n}\n\nfunction restoreScrollStack(stack, dTop) {\n  for (let i = 0; i < stack.length; i++) {\n    let {dom, top, left} = stack[i]\n    if (dom.scrollTop != top + dTop) dom.scrollTop = top + dTop\n    if (dom.scrollLeft != left) dom.scrollLeft = left\n  }\n}\n\nlet preventScrollSupported = null\n// Feature-detects support for .focus({preventScroll: true}), and uses\n// a fallback kludge when not supported.\nexport function focusPreventScroll(dom) {\n  if (dom.setActive) return dom.setActive() // in IE\n  if (preventScrollSupported) return dom.focus(preventScrollSupported)\n\n  let stored = scrollStack(dom)\n  dom.focus(preventScrollSupported == null ? {\n    get preventScroll() {\n      preventScrollSupported = {preventScroll: true}\n      return true\n    }\n  } : undefined)\n  if (!preventScrollSupported) {\n    preventScrollSupported = false\n    restoreScrollStack(stored, 0)\n  }\n}\n\nfunction findOffsetInNode(node, coords) {\n  let closest, dxClosest = 2e8, coordsClosest, offset = 0\n  let rowBot = coords.top, rowTop = coords.top\n  for (let child = node.firstChild, childIndex = 0; child; child = child.nextSibling, childIndex++) {\n    let rects\n    if (child.nodeType == 1) rects = child.getClientRects()\n    else if (child.nodeType == 3) rects = textRange(child).getClientRects()\n    else continue\n\n    for (let i = 0; i < rects.length; i++) {\n      let rect = rects[i]\n      if (rect.top <= rowBot && rect.bottom >= rowTop) {\n        rowBot = Math.max(rect.bottom, rowBot)\n        rowTop = Math.min(rect.top, rowTop)\n        let dx = rect.left > coords.left ? rect.left - coords.left\n            : rect.right < coords.left ? coords.left - rect.right : 0\n        if (dx < dxClosest) {\n          closest = child\n          dxClosest = dx\n          coordsClosest = dx && closest.nodeType == 3 ? {left: rect.right < coords.left ? rect.right : rect.left, top: coords.top} : coords\n          if (child.nodeType == 1 && dx)\n            offset = childIndex + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0)\n          continue\n        }\n      }\n      if (!closest && (coords.left >= rect.right && coords.top >= rect.top ||\n                       coords.left >= rect.left && coords.top >= rect.bottom))\n        offset = childIndex + 1\n    }\n  }\n  if (closest && closest.nodeType == 3) return findOffsetInText(closest, coordsClosest)\n  if (!closest || (dxClosest && closest.nodeType == 1)) return {node, offset}\n  return findOffsetInNode(closest, coordsClosest)\n}\n\nfunction findOffsetInText(node, coords) {\n  let len = node.nodeValue.length\n  let range = document.createRange()\n  for (let i = 0; i < len; i++) {\n    range.setEnd(node, i + 1)\n    range.setStart(node, i)\n    let rect = singleRect(range, 1)\n    if (rect.top == rect.bottom) continue\n    if (inRect(coords, rect))\n      return {node, offset: i + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0)}\n  }\n  return {node, offset: 0}\n}\n\nfunction inRect(coords, rect) {\n  return coords.left >= rect.left - 1 && coords.left <= rect.right + 1&&\n    coords.top >= rect.top - 1 && coords.top <= rect.bottom + 1\n}\n\nfunction targetKludge(dom, coords) {\n  let parent = dom.parentNode\n  if (parent && /^li$/i.test(parent.nodeName) && coords.left < dom.getBoundingClientRect().left)\n    return parent\n  return dom\n}\n\nfunction posFromElement(view, elt, coords) {\n  let {node, offset} = findOffsetInNode(elt, coords), bias = -1\n  if (node.nodeType == 1 && !node.firstChild) {\n    let rect = node.getBoundingClientRect()\n    bias = rect.left != rect.right && coords.left > (rect.left + rect.right) / 2 ? 1 : -1\n  }\n  return view.docView.posFromDOM(node, offset, bias)\n}\n\nfunction posFromCaret(view, node, offset, coords) {\n  // Browser (in caretPosition/RangeFromPoint) will agressively\n  // normalize towards nearby inline nodes. Since we are interested in\n  // positions between block nodes too, we first walk up the hierarchy\n  // of nodes to see if there are block nodes that the coordinates\n  // fall outside of. If so, we take the position before/after that\n  // block. If not, we call `posFromDOM` on the raw node/offset.\n  let outside = -1\n  for (let cur = node;;) {\n    if (cur == view.dom) break\n    let desc = view.docView.nearestDesc(cur, true)\n    if (!desc) return null\n    if (desc.node.isBlock && desc.parent) {\n      let rect = desc.dom.getBoundingClientRect()\n      if (rect.left > coords.left || rect.top > coords.top) outside = desc.posBefore\n      else if (rect.right < coords.left || rect.bottom < coords.top) outside = desc.posAfter\n      else break\n    }\n    cur = desc.dom.parentNode\n  }\n  return outside > -1 ? outside : view.docView.posFromDOM(node, offset)\n}\n\nfunction elementFromPoint(element, coords, box) {\n  let len = element.childNodes.length\n  if (len && box.top < box.bottom) {\n    for (let startI = Math.max(0, Math.min(len - 1, Math.floor(len * (coords.top - box.top) / (box.bottom - box.top)) - 2)), i = startI;;) {\n      let child = element.childNodes[i]\n      if (child.nodeType == 1) {\n        let rects = child.getClientRects()\n        for (let j = 0; j < rects.length; j++) {\n          let rect = rects[j]\n          if (inRect(coords, rect)) return elementFromPoint(child, coords, rect)\n        }\n      }\n      if ((i = (i + 1) % len) == startI) break\n    }\n  }\n  return element\n}\n\n// Given an x,y position on the editor, get the position in the document.\nexport function posAtCoords(view, coords) {\n  let root = view.root, node, offset\n  if (root.caretPositionFromPoint) {\n    try { // Firefox throws for this call in hard-to-predict circumstances (#994)\n      let pos = root.caretPositionFromPoint(coords.left, coords.top)\n      if (pos) ({offsetNode: node, offset} = pos)\n    } catch (_) {}\n  }\n  if (!node && root.caretRangeFromPoint) {\n    let range = root.caretRangeFromPoint(coords.left, coords.top)\n    if (range) ({startContainer: node, startOffset: offset} = range)\n  }\n\n  let elt = root.elementFromPoint(coords.left, coords.top + 1), pos\n  // Safari's caretRangeFromPoint returns nonsense when on a draggable element\n  if (browser.safari && elt.draggable) node = offset = null\n  if (!elt || !view.dom.contains(elt.nodeType != 1 ? elt.parentNode : elt)) {\n    let box = view.dom.getBoundingClientRect()\n    if (!inRect(coords, box)) return null\n    elt = elementFromPoint(view.dom, coords, box)\n    if (!elt) return null\n  }\n  elt = targetKludge(elt, coords)\n  if (node) {\n    if (browser.gecko && node.nodeType == 1) {\n      // Firefox will sometimes return offsets into <input> nodes, which\n      // have no actual children, from caretPositionFromPoint (#953)\n      offset = Math.min(offset, node.childNodes.length)\n      // It'll also move the returned position before image nodes,\n      // even if those are behind it.\n      if (offset < node.childNodes.length) {\n        let next = node.childNodes[offset], box\n        if (next.nodeName == \"IMG\" && (box = next.getBoundingClientRect()).right <= coords.left &&\n            box.bottom > coords.top)\n          offset++\n      }\n    }\n    // Suspiciously specific kludge to work around caret*FromPoint\n    // never returning a position at the end of the document\n    if (node == view.dom && offset == node.childNodes.length - 1 && node.lastChild.nodeType == 1 &&\n        coords.top > node.lastChild.getBoundingClientRect().bottom)\n      pos = view.state.doc.content.size\n    // Ignore positions directly after a BR, since caret*FromPoint\n    // 'round up' positions that would be more accurately placed\n    // before the BR node.\n    else if (offset == 0 || node.nodeType != 1 || node.childNodes[offset - 1].nodeName != \"BR\")\n      pos = posFromCaret(view, node, offset, coords)\n  }\n  if (pos == null) pos = posFromElement(view, elt, coords)\n\n  let desc = view.docView.nearestDesc(elt, true)\n  return {pos, inside: desc ? desc.posAtStart - desc.border : -1}\n}\n\nfunction singleRect(object, bias) {\n  let rects = object.getClientRects()\n  return !rects.length ? object.getBoundingClientRect() : rects[bias < 0 ? 0 : rects.length - 1]\n}\n\n// : (EditorView, number)  {left: number, top: number, right: number, bottom: number}\n// Given a position in the document model, get a bounding box of the\n// character at that position, relative to the window.\nexport function coordsAtPos(view, pos) {\n  let {node, offset} = view.docView.domFromPos(pos)\n\n  // These browsers support querying empty text ranges\n  if (node.nodeType == 3 && (browser.webkit || browser.gecko)) {\n    let rect = singleRect(textRange(node, offset, offset), 0)\n    // Firefox returns bad results (the position before the space)\n    // when querying a position directly after line-broken\n    // whitespace. Detect this situation and and kludge around it\n    if (browser.gecko && offset && /\\s/.test(node.nodeValue[offset - 1]) && offset < node.nodeValue.length) {\n      let rectBefore = singleRect(textRange(node, offset - 1, offset - 1), -1)\n      if (rectBefore.top == rect.top) {\n        let rectAfter = singleRect(textRange(node, offset, offset + 1), -1)\n        if (rectAfter.top != rect.top)\n          return flattenV(rectAfter, rectAfter.left < rectBefore.left)\n      }\n    }\n    return rect\n  }\n\n  if (node.nodeType == 1 && !view.state.doc.resolve(pos).parent.inlineContent) {\n    // Return a horizontal line in block context\n    let top = true, rect\n    if (offset < node.childNodes.length) {\n      let after = node.childNodes[offset]\n      if (after.nodeType == 1) rect = after.getBoundingClientRect()\n    }\n    if (!rect && offset) {\n      let before = node.childNodes[offset - 1]\n      if (before.nodeType == 1) { rect = before.getBoundingClientRect(); top = false }\n    }\n    return flattenH(rect || node.getBoundingClientRect(), top)\n  }\n\n  // Not Firefox/Chrome, or not in a text node, so we have to use\n  // actual element/character rectangles to get a solution (this part\n  // is not very bidi-safe)\n  //\n  // Try the left side first, fall back to the right one if that\n  // doesn't work.\n  for (let dir = -1; dir < 2; dir += 2) {\n    if (dir < 0 && offset) {\n      let prev, target = node.nodeType == 3 ? textRange(node, offset - 1, offset)\n          : (prev = node.childNodes[offset - 1]).nodeType == 3 ? textRange(prev)\n          : prev.nodeType == 1 && prev.nodeName != \"BR\" ? prev : null // BR nodes tend to only return the rectangle before them\n      if (target) {\n        let rect = singleRect(target, 1)\n        if (rect.top < rect.bottom) return flattenV(rect, false)\n      }\n    } else if (dir > 0 && offset < nodeSize(node)) {\n      let next, target = node.nodeType == 3 ? textRange(node, offset, offset + 1)\n          : (next = node.childNodes[offset]).nodeType == 3 ? textRange(next)\n          : next.nodeType == 1 ? next : null\n      if (target) {\n        let rect = singleRect(target, -1)\n        if (rect.top < rect.bottom) return flattenV(rect, true)\n      }\n    }\n  }\n  // All else failed, just try to get a rectangle for the target node\n  return flattenV(singleRect(node.nodeType == 3 ? textRange(node) : node, 0), false)\n}\n\nfunction flattenV(rect, left) {\n  if (rect.width == 0) return rect\n  let x = left ? rect.left : rect.right\n  return {top: rect.top, bottom: rect.bottom, left: x, right: x}\n}\n\nfunction flattenH(rect, top) {\n  if (rect.height == 0) return rect\n  let y = top ? rect.top : rect.bottom\n  return {top: y, bottom: y, left: rect.left, right: rect.right}\n}\n\nfunction withFlushedState(view, state, f) {\n  let viewState = view.state, active = view.root.activeElement\n  if (viewState != state) view.updateState(state)\n  if (active != view.dom) view.focus()\n  try {\n    return f()\n  } finally {\n    if (viewState != state) view.updateState(viewState)\n    if (active != view.dom && active) active.focus()\n  }\n}\n\n// : (EditorView, number, number)\n// Whether vertical position motion in a given direction\n// from a position would leave a text block.\nfunction endOfTextblockVertical(view, state, dir) {\n  let sel = state.selection\n  let $pos = dir == \"up\" ? sel.$anchor.min(sel.$head) : sel.$anchor.max(sel.$head)\n  return withFlushedState(view, state, () => {\n    let {node: dom} = view.docView.domFromPos($pos.pos)\n    for (;;) {\n      let nearest = view.docView.nearestDesc(dom, true)\n      if (!nearest) break\n      if (nearest.node.isBlock) { dom = nearest.dom; break }\n      dom = nearest.dom.parentNode\n    }\n    let coords = coordsAtPos(view, $pos.pos)\n    for (let child = dom.firstChild; child; child = child.nextSibling) {\n      let boxes\n      if (child.nodeType == 1) boxes = child.getClientRects()\n      else if (child.nodeType == 3) boxes = textRange(child, 0, child.nodeValue.length).getClientRects()\n      else continue\n      for (let i = 0; i < boxes.length; i++) {\n        let box = boxes[i]\n        if (box.bottom > box.top && (dir == \"up\" ? box.bottom < coords.top + 1 : box.top > coords.bottom - 1))\n          return false\n      }\n    }\n    return true\n  })\n}\n\nconst maybeRTL = /[\\u0590-\\u08ac]/\n\nfunction endOfTextblockHorizontal(view, state, dir) {\n  let {$head} = state.selection\n  if (!$head.parent.isTextblock) return false\n  let offset = $head.parentOffset, atStart = !offset, atEnd = offset == $head.parent.content.size\n  let sel = getSelection()\n  // If the textblock is all LTR, or the browser doesn't support\n  // Selection.modify (Edge), fall back to a primitive approach\n  if (!maybeRTL.test($head.parent.textContent) || !sel.modify)\n    return dir == \"left\" || dir == \"backward\" ? atStart : atEnd\n\n  return withFlushedState(view, state, () => {\n    // This is a huge hack, but appears to be the best we can\n    // currently do: use `Selection.modify` to move the selection by\n    // one character, and see if that moves the cursor out of the\n    // textblock (or doesn't move it at all, when at the start/end of\n    // the document).\n    let oldRange = sel.getRangeAt(0), oldNode = sel.focusNode, oldOff = sel.focusOffset\n    let oldBidiLevel = sel.caretBidiLevel // Only for Firefox\n    sel.modify(\"move\", dir, \"character\")\n    let parentDOM = $head.depth ? view.docView.domAfterPos($head.before()) : view.dom\n    let result = !parentDOM.contains(sel.focusNode.nodeType == 1 ? sel.focusNode : sel.focusNode.parentNode) ||\n        (oldNode == sel.focusNode && oldOff == sel.focusOffset)\n    // Restore the previous selection\n    sel.removeAllRanges()\n    sel.addRange(oldRange)\n    if (oldBidiLevel != null) sel.caretBidiLevel = oldBidiLevel\n    return result\n  })\n}\n\nlet cachedState = null, cachedDir = null, cachedResult = false\nexport function endOfTextblock(view, state, dir) {\n  if (cachedState == state && cachedDir == dir) return cachedResult\n  cachedState = state; cachedDir = dir\n  return cachedResult = dir == \"up\" || dir == \"down\"\n    ? endOfTextblockVertical(view, state, dir)\n    : endOfTextblockHorizontal(view, state, dir)\n}\n","import {DOMSerializer, Fragment, Mark} from \"prosemirror-model\"\nimport {TextSelection} from \"prosemirror-state\"\n\nimport {domIndex, isEquivalentPosition, nodeSize} from \"./dom\"\nimport browser from \"./browser\"\n\n// NodeView:: interface\n//\n// By default, document nodes are rendered using the result of the\n// [`toDOM`](#model.NodeSpec.toDOM) method of their spec, and managed\n// entirely by the editor. For some use cases, such as embedded\n// node-specific editing interfaces, you want more control over\n// the behavior of a node's in-editor representation, and need to\n// [define](#view.EditorProps.nodeViews) a custom node view.\n//\n// Mark views only support `dom` and `contentDOM`, and don't support\n// any of the node view methods.\n//\n// Objects returned as node views must conform to this interface.\n//\n//   dom:: ?dom.Node\n//   The outer DOM node that represents the document node. When not\n//   given, the default strategy is used to create a DOM node.\n//\n//   contentDOM:: ?dom.Node\n//   The DOM node that should hold the node's content. Only meaningful\n//   if the node view also defines a `dom` property and if its node\n//   type is not a leaf node type. When this is present, ProseMirror\n//   will take care of rendering the node's children into it. When it\n//   is not present, the node view itself is responsible for rendering\n//   (or deciding not to render) its child nodes.\n//\n//   update:: ?(node: Node, decorations: [Decoration])  bool\n//   When given, this will be called when the view is updating itself.\n//   It will be given a node (possibly of a different type), and an\n//   array of active decorations (which are automatically drawn, and\n//   the node view may ignore if it isn't interested in them), and\n//   should return true if it was able to update to that node, and\n//   false otherwise. If the node view has a `contentDOM` property (or\n//   no `dom` property), updating its child nodes will be handled by\n//   ProseMirror.\n//\n//   selectNode:: ?()\n//   Can be used to override the way the node's selected status (as a\n//   node selection) is displayed.\n//\n//   deselectNode:: ?()\n//   When defining a `selectNode` method, you should also provide a\n//   `deselectNode` method to remove the effect again.\n//\n//   setSelection:: ?(anchor: number, head: number, root: dom.Document)\n//   This will be called to handle setting the selection inside the\n//   node. The `anchor` and `head` positions are relative to the start\n//   of the node. By default, a DOM selection will be created between\n//   the DOM positions corresponding to those positions, but if you\n//   override it you can do something else.\n//\n//   stopEvent:: ?(event: dom.Event)  bool\n//   Can be used to prevent the editor view from trying to handle some\n//   or all DOM events that bubble up from the node view. Events for\n//   which this returns true are not handled by the editor.\n//\n//   ignoreMutation:: ?(dom.MutationRecord)  bool\n//   Called when a DOM\n//   [mutation](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver)\n//   or a selection change happens within the view. When the change is\n//   a selection change, the record will have a `type` property of\n//   `\"selection\"` (which doesn't occur for native mutation records).\n//   Return false if the editor should re-read the selection or\n//   re-parse the range around the mutation, true if it can safely be\n//   ignored.\n//\n//   destroy:: ?()\n//   Called when the node view is removed from the editor or the whole\n//   editor is destroyed.\n\n// View descriptions are data structures that describe the DOM that is\n// used to represent the editor's content. They are used for:\n//\n// - Incremental redrawing when the document changes\n//\n// - Figuring out what part of the document a given DOM position\n//   corresponds to\n//\n// - Wiring in custom implementations of the editing interface for a\n//   given node\n//\n// They form a doubly-linked mutable tree, starting at `view.docView`.\n\nconst NOT_DIRTY = 0, CHILD_DIRTY = 1, CONTENT_DIRTY = 2, NODE_DIRTY = 3\n\n// Superclass for the various kinds of descriptions. Defines their\n// basic structure and shared methods.\nclass ViewDesc {\n  // : (?ViewDesc, [ViewDesc], dom.Node, ?dom.Node)\n  constructor(parent, children, dom, contentDOM) {\n    this.parent = parent\n    this.children = children\n    this.dom = dom\n    // An expando property on the DOM node provides a link back to its\n    // description.\n    dom.pmViewDesc = this\n    // This is the node that holds the child views. It may be null for\n    // descs that don't have children.\n    this.contentDOM = contentDOM\n    this.dirty = NOT_DIRTY\n  }\n\n  // Used to check whether a given description corresponds to a\n  // widget/mark/node.\n  matchesWidget() { return false }\n  matchesMark() { return false }\n  matchesNode() { return false }\n  matchesHack() { return false }\n\n  get beforePosition() { return false }\n\n  // : ()  ?ParseRule\n  // When parsing in-editor content (in domchange.js), we allow\n  // descriptions to determine the parse rules that should be used to\n  // parse them.\n  parseRule() { return null }\n\n  // : (dom.Event)  bool\n  // Used by the editor's event handler to ignore events that come\n  // from certain descs.\n  stopEvent() { return false }\n\n  // The size of the content represented by this desc.\n  get size() {\n    let size = 0\n    for (let i = 0; i < this.children.length; i++) size += this.children[i].size\n    return size\n  }\n\n  // For block nodes, this represents the space taken up by their\n  // start/end tokens.\n  get border() { return 0 }\n\n  destroy() {\n    this.parent = null\n    if (this.dom.pmViewDesc == this) this.dom.pmViewDesc = null\n    for (let i = 0; i < this.children.length; i++)\n      this.children[i].destroy()\n  }\n\n  posBeforeChild(child) {\n    for (let i = 0, pos = this.posAtStart; i < this.children.length; i++) {\n      let cur = this.children[i]\n      if (cur == child) return pos\n      pos += cur.size\n    }\n  }\n\n  get posBefore() {\n    return this.parent.posBeforeChild(this)\n  }\n\n  get posAtStart() {\n    return this.parent ? this.parent.posBeforeChild(this) + this.border : 0\n  }\n\n  get posAfter() {\n    return this.posBefore + this.size\n  }\n\n  get posAtEnd() {\n    return this.posAtStart + this.size - 2 * this.border\n  }\n\n  // : (dom.Node, number, ?number)  number\n  localPosFromDOM(dom, offset, bias) {\n    // If the DOM position is in the content, use the child desc after\n    // it to figure out a position.\n    if (this.contentDOM && this.contentDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode)) {\n      if (bias < 0) {\n        let domBefore, desc\n        if (dom == this.contentDOM) {\n          domBefore = dom.childNodes[offset - 1]\n        } else {\n          while (dom.parentNode != this.contentDOM) dom = dom.parentNode\n          domBefore = dom.previousSibling\n        }\n        while (domBefore && !((desc = domBefore.pmViewDesc) && desc.parent == this)) domBefore = domBefore.previousSibling\n        return domBefore ? this.posBeforeChild(desc) + desc.size : this.posAtStart\n      } else {\n        let domAfter, desc\n        if (dom == this.contentDOM) {\n          domAfter = dom.childNodes[offset]\n        } else {\n          while (dom.parentNode != this.contentDOM) dom = dom.parentNode\n          domAfter = dom.nextSibling\n        }\n        while (domAfter && !((desc = domAfter.pmViewDesc) && desc.parent == this)) domAfter = domAfter.nextSibling\n        return domAfter ? this.posBeforeChild(desc) : this.posAtEnd\n      }\n    }\n    // Otherwise, use various heuristics, falling back on the bias\n    // parameter, to determine whether to return the position at the\n    // start or at the end of this view desc.\n    let atEnd\n    if (this.contentDOM && this.contentDOM != this.dom && this.dom.contains(this.contentDOM)) {\n      atEnd = dom.compareDocumentPosition(this.contentDOM) & 2\n    } else if (this.dom.firstChild) {\n      if (offset == 0) for (let search = dom;; search = search.parentNode) {\n        if (search == this.dom) { atEnd = false; break }\n        if (search.parentNode.firstChild != search) break\n      }\n      if (atEnd == null && offset == dom.childNodes.length) for (let search = dom;; search = search.parentNode) {\n        if (search == this.dom) { atEnd = true; break }\n        if (search.parentNode.lastChild != search) break\n      }\n    }\n    return (atEnd == null ? bias > 0 : atEnd) ? this.posAtEnd : this.posAtStart\n  }\n\n  // Scan up the dom finding the first desc that is a descendant of\n  // this one.\n  nearestDesc(dom, onlyNodes) {\n    for (let first = true, cur = dom; cur; cur = cur.parentNode) {\n      let desc = this.getDesc(cur)\n      if (desc && (!onlyNodes || desc.node)) {\n        // If dom is outside of this desc's nodeDOM, don't count it.\n        if (first && desc.nodeDOM &&\n            !(desc.nodeDOM.nodeType == 1 ? desc.nodeDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode) : desc.nodeDOM == dom))\n          first = false\n        else\n          return desc\n      }\n    }\n  }\n\n  getDesc(dom) {\n    let desc = dom.pmViewDesc\n    for (let cur = desc; cur; cur = cur.parent) if (cur == this) return desc\n  }\n\n  posFromDOM(dom, offset, bias) {\n    for (let scan = dom;; scan = scan.parentNode) {\n      let desc = this.getDesc(scan)\n      if (desc) return desc.localPosFromDOM(dom, offset, bias)\n    }\n  }\n\n  // : (number)  ?NodeViewDesc\n  // Find the desc for the node after the given pos, if any. (When a\n  // parent node overrode rendering, there might not be one.)\n  descAt(pos) {\n    for (let i = 0, offset = 0; i < this.children.length; i++) {\n      let child = this.children[i], end = offset + child.size\n      if (offset == pos && end != offset) {\n        while (!child.border && child.children.length) child = child.children[0]\n        return child\n      }\n      if (pos < end) return child.descAt(pos - offset - child.border)\n      offset = end\n    }\n  }\n\n  // : (number)  {node: dom.Node, offset: number}\n  domFromPos(pos) {\n    if (!this.contentDOM) return {node: this.dom, offset: 0}\n    for (let offset = 0, i = 0;; i++) {\n      if (offset == pos) {\n        while (i < this.children.length && (this.children[i].beforePosition || this.children[i].dom.parentNode != this.contentDOM)) i++\n        return {node: this.contentDOM,\n                offset: i == this.children.length ? this.contentDOM.childNodes.length : domIndex(this.children[i].dom)}\n      }\n      if (i == this.children.length) throw new Error(\"Invalid position \" + pos)\n      let child = this.children[i], end = offset + child.size\n      if (pos < end) return child.domFromPos(pos - offset - child.border)\n      offset = end\n    }\n  }\n\n  // Used to find a DOM range in a single parent for a given changed\n  // range.\n  parseRange(from, to, base = 0) {\n    if (this.children.length == 0)\n      return {node: this.contentDOM, from, to, fromOffset: 0, toOffset: this.contentDOM.childNodes.length}\n\n    let fromOffset = -1, toOffset = -1\n    for (let offset = base, i = 0;; i++) {\n      let child = this.children[i], end = offset + child.size\n      if (fromOffset == -1 && from <= end) {\n        let childBase = offset + child.border\n        // FIXME maybe descend mark views to parse a narrower range?\n        if (from >= childBase && to <= end - child.border && child.node &&\n            child.contentDOM && this.contentDOM.contains(child.contentDOM))\n          return child.parseRange(from, to, childBase)\n\n        from = offset\n        for (let j = i; j > 0; j--) {\n          let prev = this.children[j - 1]\n          if (prev.size && prev.dom.parentNode == this.contentDOM && !prev.emptyChildAt(1)) {\n            fromOffset = domIndex(prev.dom) + 1\n            break\n          }\n          from -= prev.size\n        }\n        if (fromOffset == -1) fromOffset = 0\n      }\n      if (fromOffset > -1 && to <= end) {\n        to = end\n        for (let j = i + 1; j < this.children.length; j++) {\n          let next = this.children[j]\n          if (next.size && next.dom.parentNode == this.contentDOM && !next.emptyChildAt(-1)) {\n            toOffset = domIndex(next.dom)\n            break\n          }\n          to += next.size\n        }\n        if (toOffset == -1) toOffset = this.contentDOM.childNodes.length\n        break\n      }\n      offset = end\n    }\n    return {node: this.contentDOM, from, to, fromOffset, toOffset}\n  }\n\n  emptyChildAt(side) {\n    if (this.border || !this.contentDOM || !this.children.length) return false\n    let child = this.children[side < 0 ? 0 : this.children.length - 1]\n    return child.size == 0 || child.emptyChildAt(side)\n  }\n\n  // : (number)  dom.Node\n  domAfterPos(pos) {\n    let {node, offset} = this.domFromPos(pos)\n    if (node.nodeType != 1 || offset == node.childNodes.length)\n      throw new RangeError(\"No node after pos \" + pos)\n    return node.childNodes[offset]\n  }\n\n  // : (number, number, dom.Document)\n  // View descs are responsible for setting any selection that falls\n  // entirely inside of them, so that custom implementations can do\n  // custom things with the selection. Note that this falls apart when\n  // a selection starts in such a node and ends in another, in which\n  // case we just use whatever domFromPos produces as a best effort.\n  setSelection(anchor, head, root, force) {\n    // If the selection falls entirely in a child, give it to that child\n    let from = Math.min(anchor, head), to = Math.max(anchor, head)\n    for (let i = 0, offset = 0; i < this.children.length; i++) {\n      let child = this.children[i], end = offset + child.size\n      if (from > offset && to < end)\n        return child.setSelection(anchor - offset - child.border, head - offset - child.border, root, force)\n      offset = end\n    }\n\n    let anchorDOM = this.domFromPos(anchor), headDOM = this.domFromPos(head)\n    let domSel = root.getSelection()\n\n    if (!force &&\n        isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset) &&\n        isEquivalentPosition(headDOM.node, headDOM.offset, domSel.focusNode, domSel.focusOffset))\n      return\n\n    // Selection.extend can be used to create an 'inverted' selection\n    // (one where the focus is before the anchor), but not all\n    // browsers support it yet.\n    let domSelExtended = false\n    if (domSel.extend || anchor == head) {\n      domSel.collapse(anchorDOM.node, anchorDOM.offset)\n      try {\n        if (anchor != head) domSel.extend(headDOM.node, headDOM.offset)\n        domSelExtended = true\n      } catch (err) {\n        // In some cases with Chrome the selection is empty after calling\n        // collapse, even when it should be valid. This appears to be a bug, but\n        // it is difficult to isolate. If this happens fallback to the old path\n        // without using extend.\n        if (!(err instanceof DOMException)) throw err\n      }\n    }\n    if (!domSelExtended) {\n      if (anchor > head) { let tmp = anchorDOM; anchorDOM = headDOM; headDOM = tmp }\n      let range = document.createRange()\n      range.setEnd(headDOM.node, headDOM.offset)\n      range.setStart(anchorDOM.node, anchorDOM.offset)\n      domSel.removeAllRanges()\n      domSel.addRange(range)\n    }\n  }\n\n  // : (dom.MutationRecord)  bool\n  ignoreMutation(mutation) {\n    return !this.contentDOM && mutation.type != \"selection\"\n  }\n\n  get contentLost() {\n    return this.contentDOM && this.contentDOM != this.dom && !this.dom.contains(this.contentDOM)\n  }\n\n  // Remove a subtree of the element tree that has been touched\n  // by a DOM change, so that the next update will redraw it.\n  markDirty(from, to) {\n    for (let offset = 0, i = 0; i < this.children.length; i++) {\n      let child = this.children[i], end = offset + child.size\n      if (offset == end ? from <= end && to >= offset : from < end && to > offset) {\n        let startInside = offset + child.border, endInside = end - child.border\n        if (from >= startInside && to <= endInside) {\n          this.dirty = from == offset || to == end ? CONTENT_DIRTY : CHILD_DIRTY\n          if (from == startInside && to == endInside &&\n              (child.contentLost || child.dom.parentNode != this.contentDOM)) child.dirty = NODE_DIRTY\n          else child.markDirty(from - startInside, to - startInside)\n          return\n        } else {\n          child.dirty = NODE_DIRTY\n        }\n      }\n      offset = end\n    }\n    this.dirty = CONTENT_DIRTY\n  }\n\n  markParentsDirty() {\n    let level = 1\n    for (let node = this.parent; node; node = node.parent, level++) {\n      let dirty = level == 1 ? CONTENT_DIRTY : CHILD_DIRTY\n      if (node.dirty < dirty) node.dirty = dirty\n    }\n  }\n}\n\n// Reused array to avoid allocating fresh arrays for things that will\n// stay empty anyway.\nconst nothing = []\n\n// A widget desc represents a widget decoration, which is a DOM node\n// drawn between the document nodes.\nclass WidgetViewDesc extends ViewDesc {\n  // : (ViewDesc, Decoration)\n  constructor(parent, widget, view, pos) {\n    let self, dom = widget.type.toDOM\n    if (typeof dom == \"function\") dom = dom(view, () => {\n      if (!self) return pos\n      if (self.parent) return self.parent.posBeforeChild(self)\n    })\n    if (!widget.type.spec.raw) {\n      if (dom.nodeType != 1) {\n        let wrap = document.createElement(\"span\")\n        wrap.appendChild(dom)\n        dom = wrap\n      }\n      dom.contentEditable = false\n      dom.classList.add(\"ProseMirror-widget\")\n    }\n    super(parent, nothing, dom, null)\n    this.widget = widget\n    self = this\n  }\n\n  get beforePosition() {\n    return this.widget.type.side < 0\n  }\n\n  matchesWidget(widget) {\n    return this.dirty == NOT_DIRTY && widget.type.eq(this.widget.type)\n  }\n\n  parseRule() { return {ignore: true} }\n\n  stopEvent(event) {\n    let stop = this.widget.spec.stopEvent\n    return stop ? stop(event) : false\n  }\n\n  ignoreMutation(mutation) {\n    return mutation.type != \"selection\" || this.widget.spec.ignoreSelection\n  }\n}\n\nclass CompositionViewDesc extends ViewDesc {\n  constructor(parent, dom, textDOM, text) {\n    super(parent, nothing, dom, null)\n    this.textDOM = textDOM\n    this.text = text\n  }\n\n  get size() { return this.text.length }\n\n  localPosFromDOM(dom, offset) {\n    if (dom != this.textDOM) return this.posAtStart + (offset ? this.size : 0)\n    return this.posAtStart + offset\n  }\n\n  domFromPos(pos) {\n    return {node: this.textDOM, offset: pos}\n  }\n\n  ignoreMutation(mut) {\n    return mut.type === 'characterData' && mut.target.nodeValue == mut.oldValue\n   }\n}\n\n// A mark desc represents a mark. May have multiple children,\n// depending on how the mark is split. Note that marks are drawn using\n// a fixed nesting order, for simplicity and predictability, so in\n// some cases they will be split more often than would appear\n// necessary.\nclass MarkViewDesc extends ViewDesc {\n  // : (ViewDesc, Mark, dom.Node)\n  constructor(parent, mark, dom, contentDOM) {\n    super(parent, [], dom, contentDOM)\n    this.mark = mark\n  }\n\n  static create(parent, mark, inline, view) {\n    let custom = view.nodeViews[mark.type.name]\n    let spec = custom && custom(mark, view, inline)\n    if (!spec || !spec.dom)\n      spec = DOMSerializer.renderSpec(document, mark.type.spec.toDOM(mark, inline))\n    return new MarkViewDesc(parent, mark, spec.dom, spec.contentDOM || spec.dom)\n  }\n\n  parseRule() { return {mark: this.mark.type.name, attrs: this.mark.attrs, contentElement: this.contentDOM} }\n\n  matchesMark(mark) { return this.dirty != NODE_DIRTY && this.mark.eq(mark) }\n\n  markDirty(from, to) {\n    super.markDirty(from, to)\n    // Move dirty info to nearest node view\n    if (this.dirty != NOT_DIRTY) {\n      let parent = this.parent\n      while (!parent.node) parent = parent.parent\n      if (parent.dirty < this.dirty) parent.dirty = this.dirty\n      this.dirty = NOT_DIRTY\n    }\n  }\n\n  slice(from, to, view) {\n    let copy = MarkViewDesc.create(this.parent, this.mark, true, view)\n    let nodes = this.children, size = this.size\n    if (to < size) nodes = replaceNodes(nodes, to, size, view)\n    if (from > 0) nodes = replaceNodes(nodes, 0, from, view)\n    for (let i = 0; i < nodes.length; i++) nodes[i].parent = copy\n    copy.children = nodes\n    return copy\n  }\n}\n\n// Node view descs are the main, most common type of view desc, and\n// correspond to an actual node in the document. Unlike mark descs,\n// they populate their child array themselves.\nclass NodeViewDesc extends ViewDesc {\n  // : (?ViewDesc, Node, [Decoration], DecorationSet, dom.Node, ?dom.Node, EditorView)\n  constructor(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos) {\n    super(parent, node.isLeaf ? nothing : [], dom, contentDOM)\n    this.nodeDOM = nodeDOM\n    this.node = node\n    this.outerDeco = outerDeco\n    this.innerDeco = innerDeco\n    if (contentDOM) this.updateChildren(view, pos)\n  }\n\n  // By default, a node is rendered using the `toDOM` method from the\n  // node type spec. But client code can use the `nodeViews` spec to\n  // supply a custom node view, which can influence various aspects of\n  // the way the node works.\n  //\n  // (Using subclassing for this was intentionally decided against,\n  // since it'd require exposing a whole slew of finnicky\n  // implementation details to the user code that they probably will\n  // never need.)\n  static create(parent, node, outerDeco, innerDeco, view, pos) {\n    let custom = view.nodeViews[node.type.name], descObj\n    let spec = custom && custom(node, view, () => {\n      // (This is a function that allows the custom view to find its\n      // own position)\n      if (!descObj) return pos\n      if (descObj.parent) return descObj.parent.posBeforeChild(descObj)\n    }, outerDeco)\n\n    let dom = spec && spec.dom, contentDOM = spec && spec.contentDOM\n    if (node.isText) {\n      if (!dom) dom = document.createTextNode(node.text)\n      else if (dom.nodeType != 3) throw new RangeError(\"Text must be rendered as a DOM text node\")\n    } else if (!dom) {\n      ;({dom, contentDOM} = DOMSerializer.renderSpec(document, node.type.spec.toDOM(node)))\n    }\n    if (!contentDOM && !node.isText && dom.nodeName != \"BR\") { // Chrome gets confused by <br contenteditable=false>\n      if (!dom.hasAttribute(\"contenteditable\")) dom.contentEditable = false\n      if (node.type.spec.draggable) dom.draggable = true\n    }\n\n    let nodeDOM = dom\n    dom = applyOuterDeco(dom, outerDeco, node)\n\n    if (spec)\n      return descObj = new CustomNodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM,\n                                              spec, view, pos + 1)\n    else if (node.isText)\n      return new TextViewDesc(parent, node, outerDeco, innerDeco, dom, nodeDOM, view)\n    else\n      return new NodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos + 1)\n  }\n\n  parseRule() {\n    // Experimental kludge to allow opt-in re-parsing of nodes\n    if (this.node.type.spec.reparseInView) return null\n    // FIXME the assumption that this can always return the current\n    // attrs means that if the user somehow manages to change the\n    // attrs in the dom, that won't be picked up. Not entirely sure\n    // whether this is a problem\n    let rule = {node: this.node.type.name, attrs: this.node.attrs}\n    if (this.node.type.spec.code) rule.preserveWhitespace = \"full\"\n    if (this.contentDOM && !this.contentLost) rule.contentElement = this.contentDOM\n    else rule.getContent = () => this.contentDOM ? Fragment.empty : this.node.content\n    return rule\n  }\n\n  matchesNode(node, outerDeco, innerDeco) {\n    return this.dirty == NOT_DIRTY && node.eq(this.node) &&\n      sameOuterDeco(outerDeco, this.outerDeco) && innerDeco.eq(this.innerDeco)\n  }\n\n  get size() { return this.node.nodeSize }\n\n  get border() { return this.node.isLeaf ? 0 : 1 }\n\n  // Syncs `this.children` to match `this.node.content` and the local\n  // decorations, possibly introducing nesting for marks. Then, in a\n  // separate step, syncs the DOM inside `this.contentDOM` to\n  // `this.children`.\n  updateChildren(view, pos) {\n    let inline = this.node.inlineContent, off = pos\n    let composition = inline && view.composing && this.localCompositionNode(view, pos)\n    let updater = new ViewTreeUpdater(this, composition && composition.node)\n    iterDeco(this.node, this.innerDeco, (widget, i, insideNode) => {\n      if (widget.spec.marks)\n        updater.syncToMarks(widget.spec.marks, inline, view)\n      else if (widget.type.side >= 0 && !insideNode)\n        updater.syncToMarks(i == this.node.childCount ? Mark.none : this.node.child(i).marks, inline, view)\n      // If the next node is a desc matching this widget, reuse it,\n      // otherwise insert the widget as a new view desc.\n      updater.placeWidget(widget, view, off)\n    }, (child, outerDeco, innerDeco, i) => {\n      // Make sure the wrapping mark descs match the node's marks.\n      updater.syncToMarks(child.marks, inline, view)\n      // Either find an existing desc that exactly matches this node,\n      // and drop the descs before it.\n      updater.findNodeMatch(child, outerDeco, innerDeco, i) ||\n        // Or try updating the next desc to reflect this node.\n        updater.updateNextNode(child, outerDeco, innerDeco, view, i) ||\n        // Or just add it as a new desc.\n        updater.addNode(child, outerDeco, innerDeco, view, off)\n      off += child.nodeSize\n    })\n    // Drop all remaining descs after the current position.\n    updater.syncToMarks(nothing, inline, view)\n    if (this.node.isTextblock) updater.addTextblockHacks()\n    updater.destroyRest()\n\n    // Sync the DOM if anything changed\n    if (updater.changed || this.dirty == CONTENT_DIRTY) {\n      // May have to protect focused DOM from being changed if a composition is active\n      if (composition) this.protectLocalComposition(view, composition)\n      this.renderChildren()\n    }\n  }\n\n  renderChildren() {\n    renderDescs(this.contentDOM, this.children, NodeViewDesc.is)\n    if (browser.ios) iosHacks(this.dom)\n  }\n\n  localCompositionNode(view, pos) {\n    // Only do something if both the selection and a focused text node\n    // are inside of this node, and the node isn't already part of a\n    // view that's a child of this view\n    let {from, to} = view.state.selection\n    if (!(view.state.selection instanceof TextSelection) || from < pos || to > pos + this.node.content.size) return\n    let sel = view.root.getSelection()\n    let textNode = nearbyTextNode(sel.focusNode, sel.focusOffset)\n    if (!textNode || !this.dom.contains(textNode.parentNode)) return\n\n    // Find the text in the focused node in the node, stop if it's not\n    // there (may have been modified through other means, in which\n    // case it should overwritten)\n    let text = textNode.nodeValue\n    let textPos = findTextInFragment(this.node.content, text, from - pos, to - pos)\n\n    return textPos < 0 ? null : {node: textNode, pos: textPos, text}\n  }\n\n  protectLocalComposition(view, {node, pos, text}) {\n    // The node is already part of a local view desc, leave it there\n    if (this.getDesc(node)) return\n\n    // Create a composition view for the orphaned nodes\n    let topNode = node\n    for (;; topNode = topNode.parentNode) {\n      if (topNode.parentNode == this.contentDOM) break\n      while (topNode.previousSibling) topNode.parentNode.removeChild(topNode.previousSibling)\n      while (topNode.nextSibling) topNode.parentNode.removeChild(topNode.nextSibling)\n      if (topNode.pmViewDesc) topNode.pmViewDesc = null\n    }\n    let desc = new CompositionViewDesc(this, topNode, node, text)\n    view.compositionNodes.push(desc)\n\n    // Patch up this.children to contain the composition view\n    this.children = replaceNodes(this.children, pos, pos + text.length, view, desc)\n  }\n\n  // : (Node, [Decoration], DecorationSet, EditorView)  bool\n  // If this desc be updated to match the given node decoration,\n  // do so and return true.\n  update(node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY ||\n        !node.sameMarkup(this.node)) return false\n    this.updateInner(node, outerDeco, innerDeco, view)\n    return true\n  }\n\n  updateInner(node, outerDeco, innerDeco, view) {\n    this.updateOuterDeco(outerDeco)\n    this.node = node\n    this.innerDeco = innerDeco\n    if (this.contentDOM) this.updateChildren(view, this.posAtStart)\n    this.dirty = NOT_DIRTY\n  }\n\n  updateOuterDeco(outerDeco) {\n    if (sameOuterDeco(outerDeco, this.outerDeco)) return\n    let needsWrap = this.nodeDOM.nodeType != 1\n    let oldDOM = this.dom\n    this.dom = patchOuterDeco(this.dom, this.nodeDOM,\n                              computeOuterDeco(this.outerDeco, this.node, needsWrap),\n                              computeOuterDeco(outerDeco, this.node, needsWrap))\n    if (this.dom != oldDOM) {\n      oldDOM.pmViewDesc = null\n      this.dom.pmViewDesc = this\n    }\n    this.outerDeco = outerDeco\n  }\n\n  // Mark this node as being the selected node.\n  selectNode() {\n    this.nodeDOM.classList.add(\"ProseMirror-selectednode\")\n    if (this.contentDOM || !this.node.type.spec.draggable) this.dom.draggable = true\n  }\n\n  // Remove selected node marking from this node.\n  deselectNode() {\n    this.nodeDOM.classList.remove(\"ProseMirror-selectednode\")\n    if (this.contentDOM || !this.node.type.spec.draggable) this.dom.removeAttribute(\"draggable\")\n  }\n}\n\n// Create a view desc for the top-level document node, to be exported\n// and used by the view class.\nexport function docViewDesc(doc, outerDeco, innerDeco, dom, view) {\n  applyOuterDeco(dom, outerDeco, doc)\n  return new NodeViewDesc(null, doc, outerDeco, innerDeco, dom, dom, dom, view, 0)\n}\n\nclass TextViewDesc extends NodeViewDesc {\n  constructor(parent, node, outerDeco, innerDeco, dom, nodeDOM, view) {\n    super(parent, node, outerDeco, innerDeco, dom, null, nodeDOM, view)\n  }\n\n  parseRule() {\n    return {skip: this.nodeDOM.parentNode || true}\n  }\n\n  update(node, outerDeco) {\n    if (this.dirty == NODE_DIRTY || (this.dirty != NOT_DIRTY && !this.inParent()) ||\n        !node.sameMarkup(this.node)) return false\n    this.updateOuterDeco(outerDeco)\n    if ((this.dirty != NOT_DIRTY || node.text != this.node.text) && node.text != this.nodeDOM.nodeValue)\n      this.nodeDOM.nodeValue = node.text\n    this.node = node\n    this.dirty = NOT_DIRTY\n    return true\n  }\n\n  inParent() {\n    let parentDOM = this.parent.contentDOM\n    for (let n = this.nodeDOM; n; n = n.parentNode) if (n == parentDOM) return true\n    return false\n  }\n\n  domFromPos(pos) {\n    return {node: this.nodeDOM, offset: pos}\n  }\n\n  localPosFromDOM(dom, offset, bias) {\n    if (dom == this.nodeDOM) return this.posAtStart + Math.min(offset, this.node.text.length)\n    return super.localPosFromDOM(dom, offset, bias)\n  }\n\n  ignoreMutation(mutation) {\n    return mutation.type != \"characterData\" && mutation.type != \"selection\"\n  }\n\n  slice(from, to, view) {\n    let node = this.node.cut(from, to), dom = document.createTextNode(node.text)\n    return new TextViewDesc(this.parent, node, this.outerDeco, this.innerDeco, dom, dom, view)\n  }\n}\n\n// A dummy desc used to tag trailing BR or span nodes created to work\n// around contentEditable terribleness.\nclass BRHackViewDesc extends ViewDesc {\n  parseRule() { return {ignore: true} }\n  matchesHack() { return this.dirty == NOT_DIRTY }\n}\n\n// A separate subclass is used for customized node views, so that the\n// extra checks only have to be made for nodes that are actually\n// customized.\nclass CustomNodeViewDesc extends NodeViewDesc {\n  // : (?ViewDesc, Node, [Decoration], DecorationSet, dom.Node, ?dom.Node, NodeView, EditorView)\n  constructor(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, spec, view, pos) {\n    super(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos)\n    this.spec = spec\n  }\n\n  // A custom `update` method gets to decide whether the update goes\n  // through. If it does, and there's a `contentDOM` node, our logic\n  // updates the children.\n  update(node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY) return false\n    if (this.spec.update) {\n      let result = this.spec.update(node, outerDeco)\n      if (result) this.updateInner(node, outerDeco, innerDeco, view)\n      return result\n    } else if (!this.contentDOM && !node.isLeaf) {\n      return false\n    } else {\n      return super.update(node, outerDeco, innerDeco, view)\n    }\n  }\n\n  selectNode() {\n    this.spec.selectNode ? this.spec.selectNode() : super.selectNode()\n  }\n\n  deselectNode() {\n    this.spec.deselectNode ? this.spec.deselectNode() : super.deselectNode()\n  }\n\n  setSelection(anchor, head, root, force) {\n    this.spec.setSelection ? this.spec.setSelection(anchor, head, root)\n      : super.setSelection(anchor, head, root, force)\n  }\n\n  destroy() {\n    if (this.spec.destroy) this.spec.destroy()\n    super.destroy()\n  }\n\n  stopEvent(event) {\n    return this.spec.stopEvent ? this.spec.stopEvent(event) : false\n  }\n\n  ignoreMutation(mutation) {\n    return this.spec.ignoreMutation ? this.spec.ignoreMutation(mutation) : super.ignoreMutation(mutation)\n  }\n}\n\n// : (dom.Node, [ViewDesc])\n// Sync the content of the given DOM node with the nodes associated\n// with the given array of view descs, recursing into mark descs\n// because this should sync the subtree for a whole node at a time.\nfunction renderDescs(parentDOM, descs) {\n  let dom = parentDOM.firstChild\n  for (let i = 0; i < descs.length; i++) {\n    let desc = descs[i], childDOM = desc.dom\n    if (childDOM.parentNode == parentDOM) {\n      while (childDOM != dom) dom = rm(dom)\n      dom = dom.nextSibling\n    } else {\n      parentDOM.insertBefore(childDOM, dom)\n    }\n    if (desc instanceof MarkViewDesc) {\n      let pos = dom ? dom.previousSibling : parentDOM.lastChild\n      renderDescs(desc.contentDOM, desc.children)\n      dom = pos ? pos.nextSibling : parentDOM.firstChild\n    }\n  }\n  while (dom) dom = rm(dom)\n}\n\nfunction OuterDecoLevel(nodeName) {\n  if (nodeName) this.nodeName = nodeName\n}\nOuterDecoLevel.prototype = Object.create(null)\n\nconst noDeco = [new OuterDecoLevel]\n\nfunction computeOuterDeco(outerDeco, node, needsWrap) {\n  if (outerDeco.length == 0) return noDeco\n\n  let top = needsWrap ? noDeco[0] : new OuterDecoLevel, result = [top]\n\n  for (let i = 0; i < outerDeco.length; i++) {\n    let attrs = outerDeco[i].type.attrs, cur = top\n    if (!attrs) continue\n    if (attrs.nodeName)\n      result.push(cur = new OuterDecoLevel(attrs.nodeName))\n\n    for (let name in attrs) {\n      let val = attrs[name]\n      if (val == null) continue\n      if (needsWrap && result.length == 1)\n        result.push(cur = top = new OuterDecoLevel(node.isInline ? \"span\" : \"div\"))\n      if (name == \"class\") cur.class = (cur.class ? cur.class + \" \" : \"\") + val\n      else if (name == \"style\") cur.style = (cur.style ? cur.style + \";\" : \"\") + val\n      else if (name != \"nodeName\") cur[name] = val\n    }\n  }\n\n  return result\n}\n\nfunction patchOuterDeco(outerDOM, nodeDOM, prevComputed, curComputed) {\n  // Shortcut for trivial case\n  if (prevComputed == noDeco && curComputed == noDeco) return nodeDOM\n\n  let curDOM = nodeDOM\n  for (let i = 0; i < curComputed.length; i++) {\n    let deco = curComputed[i], prev = prevComputed[i]\n    if (i) {\n      let parent\n      if (prev && prev.nodeName == deco.nodeName && curDOM != outerDOM &&\n          (parent = curDOM.parentNode) && parent.tagName.toLowerCase() == deco.nodeName) {\n        curDOM = parent\n      } else {\n        parent = document.createElement(deco.nodeName)\n        parent.appendChild(curDOM)\n        prev = noDeco[0]\n        curDOM = parent\n      }\n    }\n    patchAttributes(curDOM, prev || noDeco[0], deco)\n  }\n  return curDOM\n}\n\nfunction patchAttributes(dom, prev, cur) {\n  for (let name in prev)\n    if (name != \"class\" && name != \"style\" && name != \"nodeName\" && !(name in cur))\n      dom.removeAttribute(name)\n  for (let name in cur)\n    if (name != \"class\" && name != \"style\" && name != \"nodeName\" && cur[name] != prev[name])\n      dom.setAttribute(name, cur[name])\n  if (prev.class != cur.class) {\n    let prevList = prev.class ? prev.class.split(\" \") : nothing\n    let curList = cur.class ? cur.class.split(\" \") : nothing\n    for (let i = 0; i < prevList.length; i++) if (curList.indexOf(prevList[i]) == -1)\n      dom.classList.remove(prevList[i])\n    for (let i = 0; i < curList.length; i++) if (prevList.indexOf(curList[i]) == -1)\n      dom.classList.add(curList[i])\n  }\n  if (prev.style != cur.style) {\n    if (prev.style) {\n      let prop = /\\s*([\\w\\-\\xa1-\\uffff]+)\\s*:(?:\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|\\(.*?\\)|[^;])*/g, m\n      while (m = prop.exec(prev.style))\n        dom.style.removeProperty(m[1])\n    }\n    if (cur.style)\n      dom.style.cssText += cur.style\n  }\n}\n\nfunction applyOuterDeco(dom, deco, node) {\n  return patchOuterDeco(dom, dom, noDeco, computeOuterDeco(deco, node, dom.nodeType != 1))\n}\n\n// : ([Decoration], [Decoration])  bool\nfunction sameOuterDeco(a, b) {\n  if (a.length != b.length) return false\n  for (let i = 0; i < a.length; i++) if (!a[i].type.eq(b[i].type)) return false\n  return true\n}\n\n// Remove a DOM node and return its next sibling.\nfunction rm(dom) {\n  let next = dom.nextSibling\n  dom.parentNode.removeChild(dom)\n  return next\n}\n\n// Helper class for incrementally updating a tree of mark descs and\n// the widget and node descs inside of them.\nclass ViewTreeUpdater {\n  // : (NodeViewDesc)\n  constructor(top, lockedNode) {\n    this.top = top\n    this.lock = lockedNode\n    // Index into `this.top`'s child array, represents the current\n    // update position.\n    this.index = 0\n    // When entering a mark, the current top and index are pushed\n    // onto this.\n    this.stack = []\n    // Tracks whether anything was changed\n    this.changed = false\n\n    let pre = preMatch(top.node.content, top.children)\n    this.preMatched = pre.nodes\n    this.preMatchOffset = pre.offset\n  }\n\n  getPreMatch(index) {\n    return index >= this.preMatchOffset ? this.preMatched[index - this.preMatchOffset] : null\n  }\n\n  // Destroy and remove the children between the given indices in\n  // `this.top`.\n  destroyBetween(start, end) {\n    if (start == end) return\n    for (let i = start; i < end; i++) this.top.children[i].destroy()\n    this.top.children.splice(start, end - start)\n    this.changed = true\n  }\n\n  // Destroy all remaining children in `this.top`.\n  destroyRest() {\n    this.destroyBetween(this.index, this.top.children.length)\n  }\n\n  // : ([Mark], EditorView)\n  // Sync the current stack of mark descs with the given array of\n  // marks, reusing existing mark descs when possible.\n  syncToMarks(marks, inline, view) {\n    let keep = 0, depth = this.stack.length >> 1\n    let maxKeep = Math.min(depth, marks.length)\n    while (keep < maxKeep &&\n           (keep == depth - 1 ? this.top : this.stack[(keep + 1) << 1]).matchesMark(marks[keep]) && marks[keep].type.spec.spanning !== false)\n      keep++\n\n    while (keep < depth) {\n      this.destroyRest()\n      this.top.dirty = NOT_DIRTY\n      this.index = this.stack.pop()\n      this.top = this.stack.pop()\n      depth--\n    }\n    while (depth < marks.length) {\n      this.stack.push(this.top, this.index + 1)\n      let found = -1\n      for (let i = this.index; i < Math.min(this.index + 3, this.top.children.length); i++) {\n        if (this.top.children[i].matchesMark(marks[depth])) { found = i; break }\n      }\n      if (found > -1) {\n        if (found > this.index) {\n          this.changed = true\n          this.destroyBetween(this.index, found)\n        }\n        this.top = this.top.children[this.index]\n      } else {\n        let markDesc = MarkViewDesc.create(this.top, marks[depth], inline, view)\n        this.top.children.splice(this.index, 0, markDesc)\n        this.top = markDesc\n        this.changed = true\n      }\n      this.index = 0\n      depth++\n    }\n  }\n\n  // : (Node, [Decoration], DecorationSet)  bool\n  // Try to find a node desc matching the given data. Skip over it and\n  // return true when successful.\n  findNodeMatch(node, outerDeco, innerDeco, index) {\n    let found = -1, preMatch = index < 0 ? undefined : this.getPreMatch(index), children = this.top.children\n    if (preMatch && preMatch.matchesNode(node, outerDeco, innerDeco)) {\n      found = children.indexOf(preMatch)\n    } else {\n      for (let i = this.index, e = Math.min(children.length, i + 5); i < e; i++) {\n        let child = children[i]\n        if (child.matchesNode(node, outerDeco, innerDeco) && this.preMatched.indexOf(child) < 0) {\n          found = i\n          break\n        }\n      }\n    }\n    if (found < 0) return false\n    this.destroyBetween(this.index, found)\n    this.index++\n    return true\n  }\n\n  // : (Node, [Decoration], DecorationSet, EditorView, Fragment, number)  bool\n  // Try to update the next node, if any, to the given data. Checks\n  // pre-matches to avoid overwriting nodes that could still be used.\n  updateNextNode(node, outerDeco, innerDeco, view, index) {\n    for (let i = this.index; i < this.top.children.length; i++) {\n      let next = this.top.children[i]\n      if (next instanceof NodeViewDesc) {\n        let preMatch = this.preMatched.indexOf(next)\n        if (preMatch > -1 && preMatch + this.preMatchOffset != index) return false\n        let nextDOM = next.dom\n\n        // Can't update if nextDOM is or contains this.lock, except if\n        // it's a text node whose content already matches the new text\n        // and whose decorations match the new ones.\n        let locked = this.lock && (nextDOM == this.lock || nextDOM.nodeType == 1 && nextDOM.contains(this.lock.parentNode)) &&\n            !(node.isText && next.node && next.node.isText && next.nodeDOM.nodeValue == node.text &&\n              next.dirty != NODE_DIRTY && sameOuterDeco(outerDeco, next.outerDeco))\n        if (!locked && next.update(node, outerDeco, innerDeco, view)) {\n          this.destroyBetween(this.index, i)\n          if (next.dom != nextDOM) this.changed = true\n          this.index++\n          return true\n        }\n        break\n      }\n    }\n    return false\n  }\n\n  // : (Node, [Decoration], DecorationSet, EditorView)\n  // Insert the node as a newly created node desc.\n  addNode(node, outerDeco, innerDeco, view, pos) {\n    this.top.children.splice(this.index++, 0, NodeViewDesc.create(this.top, node, outerDeco, innerDeco, view, pos))\n    this.changed = true\n  }\n\n  placeWidget(widget, view, pos) {\n    if (this.index < this.top.children.length && this.top.children[this.index].matchesWidget(widget)) {\n      this.index++\n    } else {\n      let desc = new WidgetViewDesc(this.top, widget, view, pos)\n      this.top.children.splice(this.index++, 0, desc)\n      this.changed = true\n    }\n  }\n\n  // Make sure a textblock looks and behaves correctly in\n  // contentEditable.\n  addTextblockHacks() {\n    let lastChild = this.top.children[this.index - 1]\n    while (lastChild instanceof MarkViewDesc) lastChild = lastChild.children[lastChild.children.length - 1]\n\n    if (!lastChild || // Empty textblock\n        !(lastChild instanceof TextViewDesc) ||\n        /\\n$/.test(lastChild.node.text)) {\n      if (this.index < this.top.children.length && this.top.children[this.index].matchesHack()) {\n        this.index++\n      } else {\n        let dom = document.createElement(\"br\")\n        this.top.children.splice(this.index++, 0, new BRHackViewDesc(this.top, nothing, dom, null))\n        this.changed = true\n      }\n    }\n  }\n}\n\n// : (Fragment, [ViewDesc])  [ViewDesc]\n// Iterate from the end of the fragment and array of descs to find\n// directly matching ones, in order to avoid overeagerly reusing\n// those for other nodes. Returns an array whose positions correspond\n// to node positions in the fragment, and whose elements are either\n// descs matched to the child at that index, or empty.\nfunction preMatch(frag, descs) {\n  let result = [], end = frag.childCount\n  for (let i = descs.length - 1; end > 0 && i >= 0; i--) {\n    let desc = descs[i], node = desc.node\n    if (!node) continue\n    if (node != frag.child(end - 1)) break\n    result.push(desc)\n    --end\n  }\n  return {nodes: result.reverse(), offset: end}\n}\n\nfunction compareSide(a, b) { return a.type.side - b.type.side }\n\n// : (ViewDesc, DecorationSet, (Decoration, number), (Node, [Decoration], DecorationSet, number))\n// This function abstracts iterating over the nodes and decorations in\n// a fragment. Calls `onNode` for each node, with its local and child\n// decorations. Splits text nodes when there is a decoration starting\n// or ending inside of them. Calls `onWidget` for each widget.\nfunction iterDeco(parent, deco, onWidget, onNode) {\n  let locals = deco.locals(parent), offset = 0\n  // Simple, cheap variant for when there are no local decorations\n  if (locals.length == 0) {\n    for (let i = 0; i < parent.childCount; i++) {\n      let child = parent.child(i)\n      onNode(child, locals, deco.forChild(offset, child), i)\n      offset += child.nodeSize\n    }\n    return\n  }\n\n  let decoIndex = 0, active = [], restNode = null\n  for (let parentIndex = 0;;) {\n    if (decoIndex < locals.length && locals[decoIndex].to == offset) {\n      let widget = locals[decoIndex++], widgets\n      while (decoIndex < locals.length && locals[decoIndex].to == offset)\n        (widgets || (widgets = [widget])).push(locals[decoIndex++])\n      if (widgets) {\n        widgets.sort(compareSide)\n        for (let i = 0; i < widgets.length; i++) onWidget(widgets[i], parentIndex, !!restNode)\n      } else {\n        onWidget(widget, parentIndex, !!restNode)\n      }\n    }\n\n    let child, index\n    if (restNode) {\n      index = -1\n      child = restNode\n      restNode = null\n    } else if (parentIndex < parent.childCount) {\n      index = parentIndex\n      child = parent.child(parentIndex++)\n    } else {\n      break\n    }\n\n    for (let i = 0; i < active.length; i++) if (active[i].to <= offset) active.splice(i--, 1)\n    while (decoIndex < locals.length && locals[decoIndex].from == offset) active.push(locals[decoIndex++])\n\n    let end = offset + child.nodeSize\n    if (child.isText) {\n      let cutAt = end\n      if (decoIndex < locals.length && locals[decoIndex].from < cutAt) cutAt = locals[decoIndex].from\n      for (let i = 0; i < active.length; i++) if (active[i].to < cutAt) cutAt = active[i].to\n      if (cutAt < end) {\n        restNode = child.cut(cutAt - offset)\n        child = child.cut(0, cutAt - offset)\n        end = cutAt\n        index = -1\n      }\n    }\n\n    onNode(child, active.length ? active.slice() : nothing, deco.forChild(offset, child), index)\n    offset = end\n  }\n}\n\n// List markers in Mobile Safari will mysteriously disappear\n// sometimes. This works around that.\nfunction iosHacks(dom) {\n  if (dom.nodeName == \"UL\" || dom.nodeName == \"OL\") {\n    let oldCSS = dom.style.cssText\n    dom.style.cssText = oldCSS + \"; list-style: square !important\"\n    window.getComputedStyle(dom).listStyle\n    dom.style.cssText = oldCSS\n  }\n}\n\nfunction nearbyTextNode(node, offset) {\n  for (;;) {\n    if (node.nodeType == 3) return node\n    if (node.nodeType == 1 && offset > 0) {\n      if (node.childNodes.length > offset && node.childNodes[offset].nodeType == 3)\n        return node.childNodes[offset]\n      node = node.childNodes[offset - 1]\n      offset = nodeSize(node)\n    } else if (node.nodeType == 1 && offset < node.childNodes.length) {\n      node = node.childNodes[offset]\n      offset = 0\n    } else {\n      return null\n    }\n  }\n}\n\n// Find a piece of text in an inline fragment, overlapping from-to\nfunction findTextInFragment(frag, text, from, to) {\n  for (let i = 0, pos = 0; i < frag.childCount && pos <= to;) {\n    let child = frag.child(i++), childStart = pos\n    pos += child.nodeSize\n    if (!child.isText) continue\n    let str = child.text\n    while (i < frag.childCount) {\n      let next = frag.child(i++)\n      pos += next.nodeSize\n      if (!next.isText) break\n      str += next.text\n    }\n    if (pos >= from) {\n      let found = str.lastIndexOf(text, to - childStart)\n      if (found >= 0 && found + text.length + childStart >= from)\n        return childStart + found\n    }\n  }\n  return -1\n}\n\n// Replace range from-to in an array of view descs with replacement\n// (may be null to just delete). This goes very much against the grain\n// of the rest of this code, which tends to create nodes with the\n// right shape in one go, rather than messing with them after\n// creation, but is necessary in the composition hack.\nfunction replaceNodes(nodes, from, to, view, replacement) {\n  let result = []\n  for (let i = 0, off = 0; i < nodes.length; i++) {\n    let child = nodes[i], start = off, end = off += child.size\n    if (start >= to || end <= from) {\n      result.push(child)\n    } else {\n      if (start < from) result.push(child.slice(0, from - start, view))\n      if (replacement) {\n        result.push(replacement)\n        replacement = null\n      }\n      if (end > to) result.push(child.slice(to - start, child.size, view))\n    }\n  }\n  return result\n}\n","import {Selection, NodeSelection, TextSelection} from \"prosemirror-state\"\nimport browser from \"./browser\"\nimport {domIndex, selectionCollapsed} from \"./dom\"\n\nfunction moveSelectionBlock(state, dir) {\n  let {$anchor, $head} = state.selection\n  let $side = dir > 0 ? $anchor.max($head) : $anchor.min($head)\n  let $start = !$side.parent.inlineContent ? $side : $side.depth ? state.doc.resolve(dir > 0 ? $side.after() : $side.before()) : null\n  return $start && Selection.findFrom($start, dir)\n}\n\nfunction apply(view, sel) {\n  view.dispatch(view.state.tr.setSelection(sel).scrollIntoView())\n  return true\n}\n\nfunction selectHorizontally(view, dir, mods) {\n  let sel = view.state.selection\n  if (sel instanceof TextSelection) {\n    if (!sel.empty || mods.indexOf(\"s\") > -1) {\n      return false\n    } else if (view.endOfTextblock(dir > 0 ? \"right\" : \"left\")) {\n      let next = moveSelectionBlock(view.state, dir)\n      if (next && (next instanceof NodeSelection)) return apply(view, next)\n      return false\n    } else if (!(browser.mac && mods.indexOf(\"m\"))) {\n      let $head = sel.$head, node = $head.textOffset ? null : dir < 0 ? $head.nodeBefore : $head.nodeAfter, desc\n      if (!node || node.isText) return false\n      let nodePos = dir < 0 ? $head.pos - node.nodeSize : $head.pos\n      if (!(node.isAtom || (desc = view.docView.descAt(nodePos)) && !desc.contentDOM)) return false\n      if (NodeSelection.isSelectable(node)) {\n        return apply(view, new NodeSelection(dir < 0 ? view.state.doc.resolve($head.pos - node.nodeSize) : $head))\n      } else if (browser.webkit) {\n        // Chrome and Safari will introduce extra pointless cursor\n        // positions around inline uneditable nodes, so we have to\n        // take over and move the cursor past them (#937)\n        return apply(view, new TextSelection(view.state.doc.resolve(dir < 0 ? nodePos : nodePos + node.nodeSize)))\n      } else {\n        return false\n      }\n    }\n  } else if (sel instanceof NodeSelection && sel.node.isInline) {\n    return apply(view, new TextSelection(dir > 0 ? sel.$to : sel.$from))\n  } else {\n    let next = moveSelectionBlock(view.state, dir)\n    if (next) return apply(view, next)\n    return false\n  }\n}\n\nfunction nodeLen(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nfunction isIgnorable(dom) {\n  let desc = dom.pmViewDesc\n  return desc && desc.size == 0 && (dom.nextSibling || dom.nodeName != \"BR\")\n}\n\n// Make sure the cursor isn't directly after one or more ignored\n// nodes, which will confuse the browser's cursor motion logic.\nfunction skipIgnoredNodesLeft(view) {\n  let sel = view.root.getSelection()\n  let node = sel.focusNode, offset = sel.focusOffset\n  if (!node) return\n  let moveNode, moveOffset, force = false\n  // Gecko will do odd things when the selection is directly in front\n  // of a non-editable node, so in that case, move it into the next\n  // node if possible. Issue prosemirror/prosemirror#832.\n  if (browser.gecko && node.nodeType == 1 && offset < nodeLen(node) && isIgnorable(node.childNodes[offset])) force = true\n  for (;;) {\n    if (offset > 0) {\n      if (node.nodeType != 1) {\n        break\n      } else {\n        let before = node.childNodes[offset - 1]\n        if (isIgnorable(before)) {\n          moveNode = node\n          moveOffset = --offset\n        } else if (before.nodeType == 3) {\n          node = before\n          offset = node.nodeValue.length\n        } else break\n      }\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      let prev = node.previousSibling\n      while (prev && isIgnorable(prev)) {\n        moveNode = node.parentNode\n        moveOffset = domIndex(prev)\n        prev = prev.previousSibling\n      }\n      if (!prev) {\n        node = node.parentNode\n        if (node == view.dom) break\n        offset = 0\n      } else {\n        node = prev\n        offset = nodeLen(node)\n      }\n    }\n  }\n  if (force) setSelFocus(view, sel, node, offset)\n  else if (moveNode) setSelFocus(view, sel, moveNode, moveOffset)\n}\n\n// Make sure the cursor isn't directly before one or more ignored\n// nodes.\nfunction skipIgnoredNodesRight(view) {\n  let sel = view.root.getSelection()\n  let node = sel.focusNode, offset = sel.focusOffset\n  if (!node) return\n  let len = nodeLen(node)\n  let moveNode, moveOffset\n  for (;;) {\n    if (offset < len) {\n      if (node.nodeType != 1) break\n      let after = node.childNodes[offset]\n      if (isIgnorable(after)) {\n        moveNode = node\n        moveOffset = ++offset\n      }\n      else break\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      let next = node.nextSibling\n      while (next && isIgnorable(next)) {\n        moveNode = next.parentNode\n        moveOffset = domIndex(next) + 1\n        next = next.nextSibling\n      }\n      if (!next) {\n        node = node.parentNode\n        if (node == view.dom) break\n        offset = len = 0\n      } else {\n        node = next\n        offset = 0\n        len = nodeLen(node)\n      }\n    }\n  }\n  if (moveNode) setSelFocus(view, sel, moveNode, moveOffset)\n}\n\nfunction isBlockNode(dom) {\n  let desc = dom.pmViewDesc\n  return desc && desc.node && desc.node.isBlock\n}\n\nfunction setSelFocus(view, sel, node, offset) {\n  if (selectionCollapsed(sel)) {\n    let range = document.createRange()\n    range.setEnd(node, offset)\n    range.setStart(node, offset)\n    sel.removeAllRanges()\n    sel.addRange(range)\n  } else if (sel.extend) {\n    sel.extend(node, offset)\n  }\n  view.domObserver.setCurSelection()\n}\n\n// : (EditorState, number)\n// Check whether vertical selection motion would involve node\n// selections. If so, apply it (if not, the result is left to the\n// browser)\nfunction selectVertically(view, dir, mods) {\n  let sel = view.state.selection\n  if (sel instanceof TextSelection && !sel.empty || mods.indexOf(\"s\") > -1) return false\n  if (browser.mac && mods.indexOf(\"m\")) return false\n  let {$from, $to} = sel\n\n  if (!$from.parent.inlineContent || view.endOfTextblock(dir < 0 ? \"up\" : \"down\")) {\n    let next = moveSelectionBlock(view.state, dir)\n    if (next && (next instanceof NodeSelection))\n      return apply(view, next)\n  }\n  if (!$from.parent.inlineContent) {\n    let beyond = Selection.findFrom(dir < 0 ? $from : $to, dir)\n    return beyond ? apply(view, beyond) : true\n  }\n  return false\n}\n\nfunction stopNativeHorizontalDelete(view, dir) {\n  if (!(view.state.selection instanceof TextSelection)) return true\n  let {$head, $anchor, empty} = view.state.selection\n  if (!$head.sameParent($anchor)) return true\n  if (!empty) return false\n  if (view.endOfTextblock(dir > 0 ? \"forward\" : \"backward\")) return true\n  let nextNode = !$head.textOffset && (dir < 0 ? $head.nodeBefore : $head.nodeAfter)\n  if (nextNode && !nextNode.isText) {\n    let tr = view.state.tr\n    if (dir < 0) tr.delete($head.pos - nextNode.nodeSize, $head.pos)\n    else tr.delete($head.pos, $head.pos + nextNode.nodeSize)\n    view.dispatch(tr)\n    return true\n  }\n  return false\n}\n\nfunction switchEditable(view, node, state) {\n  view.domObserver.stop()\n  node.contentEditable = state\n  view.domObserver.start()\n}\n\n// Issue #867 / https://bugs.chromium.org/p/chromium/issues/detail?id=903821\n// In which Chrome does really wrong things when the down arrow is\n// pressed when the cursor is directly at the start of a textblock and\n// has an uneditable node after it\nfunction chromeDownArrowBug(view) {\n  if (!browser.chrome || view.state.selection.$head.parentOffset > 0) return\n  let {focusNode, focusOffset} = view.root.getSelection()\n  if (focusNode && focusNode.nodeType == 1 && focusOffset == 0 &&\n      focusNode.firstChild && focusNode.firstChild.contentEditable == \"false\") {\n    let child = focusNode.firstChild\n    switchEditable(view, child, true)\n    setTimeout(() => switchEditable(view, child, false), 20)\n  }\n}\n\n// A backdrop key mapping used to make sure we always suppress keys\n// that have a dangerous default effect, even if the commands they are\n// bound to return false, and to make sure that cursor-motion keys\n// find a cursor (as opposed to a node selection) when pressed. For\n// cursor-motion keys, the code in the handlers also takes care of\n// block selections.\n\nfunction getMods(event) {\n  let result = \"\"\n  if (event.ctrlKey) result += \"c\"\n  if (event.metaKey) result += \"m\"\n  if (event.altKey) result += \"a\"\n  if (event.shiftKey) result += \"s\"\n  return result\n}\n\nexport function captureKeyDown(view, event) {\n  let code = event.keyCode, mods = getMods(event)\n  if (code == 8 || (browser.mac && code == 72 && mods == \"c\")) { // Backspace, Ctrl-h on Mac\n    return stopNativeHorizontalDelete(view, -1) || skipIgnoredNodesLeft(view)\n  } else if (code == 46 || (browser.mac && code == 68 && mods == \"c\")) { // Delete, Ctrl-d on Mac\n    return stopNativeHorizontalDelete(view, 1) || skipIgnoredNodesRight(view)\n  } else if (code == 13 || code == 27) { // Enter, Esc\n    return true\n  } else if (code == 37) { // Left arrow\n    return selectHorizontally(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 39) { // Right arrow\n    return selectHorizontally(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (code == 38) { // Up arrow\n    return selectVertically(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 40) { // Down arrow\n    return chromeDownArrowBug(view) || selectVertically(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (mods == (browser.mac ? \"m\" : \"c\") &&\n             (code == 66 || code == 73 || code == 89 || code == 90)) { // Mod-[biyz]\n    return true\n  }\n  return false\n}\n","import {Fragment, DOMParser} from \"prosemirror-model\"\nimport {Selection, TextSelection} from \"prosemirror-state\"\n\nimport {selectionBetween, selectionFromDOM, selectionToDOM} from \"./selection\"\nimport {selectionCollapsed, keyEvent} from \"./dom\"\nimport browser from \"./browser\"\n\n// Note that all referencing and parsing is done with the\n// start-of-operation selection and document, since that's the one\n// that the DOM represents. If any changes came in in the meantime,\n// the modification is mapped over those before it is applied, in\n// readDOMChange.\n\nfunction parseBetween(view, from_, to_) {\n  let {node: parent, fromOffset, toOffset, from, to} = view.docView.parseRange(from_, to_)\n\n  let domSel = view.root.getSelection(), find = null, anchor = domSel.anchorNode\n  if (anchor && view.dom.contains(anchor.nodeType == 1 ? anchor : anchor.parentNode)) {\n    find = [{node: anchor, offset: domSel.anchorOffset}]\n    if (!selectionCollapsed(domSel))\n      find.push({node: domSel.focusNode, offset: domSel.focusOffset})\n  }\n  // Work around issue in Chrome where backspacing sometimes replaces\n  // the deleted content with a random BR node (issues #799, #831)\n  if (browser.chrome && view.lastKeyCode === 8) {\n    for (let off = toOffset; off > fromOffset; off--) {\n      let node = parent.childNodes[off - 1], desc = node.pmViewDesc\n      if (node.nodeType == \"BR\" && !desc) { toOffset = off; break }\n      if (!desc || desc.size) break\n    }\n  }\n  let startDoc = view.state.doc\n  let parser = view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema)\n  let $from = startDoc.resolve(from)\n\n  let sel = null, doc = parser.parse(parent, {\n    topNode: $from.parent,\n    topMatch: $from.parent.contentMatchAt($from.index()),\n    topOpen: true,\n    from: fromOffset,\n    to: toOffset,\n    preserveWhitespace: $from.parent.type.spec.code ? \"full\" : true,\n    editableContent: true,\n    findPositions: find,\n    ruleFromNode,\n    context: $from\n  })\n  if (find && find[0].pos != null) {\n    let anchor = find[0].pos, head = find[1] && find[1].pos\n    if (head == null) head = anchor\n    sel = {anchor: anchor + from, head: head + from}\n  }\n  return {doc, sel, from, to}\n}\n\nfunction ruleFromNode(dom) {\n  let desc = dom.pmViewDesc\n  if (desc) {\n    return desc.parseRule()\n  } else if (dom.nodeName == \"BR\" && dom.parentNode) {\n    // Safari replaces the list item or table cell with a BR\n    // directly in the list node (?!) if you delete the last\n    // character in a list item or table cell (#708, #862)\n    if (browser.safari && /^(ul|ol)$/i.test(dom.parentNode.nodeName)) {\n      let skip = document.createElement(\"div\")\n      skip.appendChild(document.createElement(\"li\"))\n      return {skip}\n    } else if (dom.parentNode.lastChild == dom || browser.safari && /^(tr|table)$/i.test(dom.parentNode.nodeName)) {\n      return {ignore: true}\n    }\n  } else if (dom.nodeName == \"IMG\" && dom.getAttribute(\"mark-placeholder\")) {\n    return {ignore: true}\n  }\n}\n\nexport function readDOMChange(view, from, to, typeOver, addedNodes) {\n  if (from < 0) {\n    let origin = view.lastSelectionTime > Date.now() - 50 ? view.lastSelectionOrigin : null\n    let newSel = selectionFromDOM(view, origin)\n    if (!view.state.selection.eq(newSel)) {\n      let tr = view.state.tr.setSelection(newSel)\n      if (origin == \"pointer\") tr.setMeta(\"pointer\", true)\n      else if (origin == \"key\") tr.scrollIntoView()\n      view.dispatch(tr)\n    }\n    return\n  }\n\n  let $before = view.state.doc.resolve(from)\n  let shared = $before.sharedDepth(to)\n  from = $before.before(shared + 1)\n  to = view.state.doc.resolve(to).after(shared + 1)\n\n  let sel = view.state.selection\n  let parse = parseBetween(view, from, to)\n\n  let doc = view.state.doc, compare = doc.slice(parse.from, parse.to)\n  let preferredPos, preferredSide\n  // Prefer anchoring to end when Backspace is pressed\n  if (view.lastKeyCode === 8 && Date.now() - 100 < view.lastKeyCodeTime) {\n    preferredPos = view.state.selection.to\n    preferredSide = \"end\"\n  } else {\n    preferredPos = view.state.selection.from\n    preferredSide = \"start\"\n  }\n  view.lastKeyCode = null\n\n  let change = findDiff(compare.content, parse.doc.content, parse.from, preferredPos, preferredSide)\n  if (!change) {\n    if (typeOver && sel instanceof TextSelection && !sel.empty && sel.$head.sameParent(sel.$anchor) &&\n        !view.composing && !(parse.sel && parse.sel.anchor != parse.sel.head)) {\n      change = {start: sel.from, endA: sel.to, endB: sel.to}\n    } else {\n      if (parse.sel) {\n        let sel = resolveSelection(view, view.state.doc, parse.sel)\n        if (sel && !sel.eq(view.state.selection)) view.dispatch(view.state.tr.setSelection(sel))\n      }\n      return\n    }\n  }\n  view.domChangeCount++\n  // Handle the case where overwriting a selection by typing matches\n  // the start or end of the selected content, creating a change\n  // that's smaller than what was actually overwritten.\n  if (view.state.selection.from < view.state.selection.to &&\n      change.start == change.endB &&\n      view.state.selection instanceof TextSelection) {\n    if (change.start > view.state.selection.from && change.start <= view.state.selection.from + 2) {\n      change.start = view.state.selection.from\n    } else if (change.endA < view.state.selection.to && change.endA >= view.state.selection.to - 2) {\n      change.endB += (view.state.selection.to - change.endA)\n      change.endA = view.state.selection.to\n    }\n  }\n\n  // IE11 will insert a non-breaking space _ahead_ of the space after\n  // the cursor space when adding a space before another space. When\n  // that happened, adjust the change to cover the space instead.\n  if (browser.ie && browser.ie_version <= 11 && change.endB == change.start + 1 &&\n      change.endA == change.start && change.start > parse.from &&\n      parse.doc.textBetween(change.start - parse.from - 1, change.start - parse.from + 1) == \" \\u00a0\") {\n    change.start--\n    change.endA--\n    change.endB--\n  }\n\n  let $from = parse.doc.resolveNoCache(change.start - parse.from)\n  let $to = parse.doc.resolveNoCache(change.endB - parse.from)\n  let inlineChange = $from.sameParent($to) && $from.parent.inlineContent\n  let nextSel\n  // If this looks like the effect of pressing Enter (or was recorded\n  // as being an iOS enter press), just dispatch an Enter key instead.\n  if (((browser.ios && view.lastIOSEnter > Date.now() - 100 &&\n        (!inlineChange || addedNodes.some(n => n.nodeName == \"DIV\" || n.nodeName == \"P\"))) ||\n       (!inlineChange && $from.pos < parse.doc.content.size &&\n        (nextSel = Selection.findFrom(parse.doc.resolve($from.pos + 1), 1, true)) &&\n        nextSel.head == $to.pos)) &&\n      view.someProp(\"handleKeyDown\", f => f(view, keyEvent(13, \"Enter\")))) {\n    view.lastIOSEnter = 0\n    return\n  }\n  // Same for backspace\n  if (view.state.selection.anchor > change.start &&\n      looksLikeJoin(doc, change.start, change.endA, $from, $to) &&\n      view.someProp(\"handleKeyDown\", f => f(view, keyEvent(8, \"Backspace\")))) {\n    if (browser.android && browser.chrome) view.domObserver.suppressSelectionUpdates() // #820\n    return\n  }\n\n  let chFrom = change.start, chTo = change.endA\n\n  let tr, storedMarks, markChange, $from1\n  if (inlineChange) {\n    if ($from.pos == $to.pos) { // Deletion\n      // IE11 sometimes weirdly moves the DOM selection around after\n      // backspacing out the first element in a textblock\n      if (browser.ie && browser.ie_version <= 11 && $from.parentOffset == 0) {\n        view.domObserver.suppressSelectionUpdates()\n        setTimeout(() => selectionToDOM(view), 20)\n      }\n      tr = view.state.tr.delete(chFrom, chTo)\n      storedMarks = doc.resolve(change.start).marksAcross(doc.resolve(change.endA))\n    } else if ( // Adding or removing a mark\n      change.endA == change.endB && ($from1 = doc.resolve(change.start)) &&\n      (markChange = isMarkChange($from.parent.content.cut($from.parentOffset, $to.parentOffset),\n                                 $from1.parent.content.cut($from1.parentOffset, change.endA - $from1.start())))\n    ) {\n      tr = view.state.tr\n      if (markChange.type == \"add\") tr.addMark(chFrom, chTo, markChange.mark)\n      else tr.removeMark(chFrom, chTo, markChange.mark)\n    } else if ($from.parent.child($from.index()).isText && $from.index() == $to.index() - ($to.textOffset ? 0 : 1)) {\n      // Both positions in the same text node -- simply insert text\n      let text = $from.parent.textBetween($from.parentOffset, $to.parentOffset)\n      if (view.someProp(\"handleTextInput\", f => f(view, chFrom, chTo, text))) return\n      tr = view.state.tr.insertText(text, chFrom, chTo)\n    }\n  }\n\n  if (!tr)\n    tr = view.state.tr.replace(chFrom, chTo, parse.doc.slice(change.start - parse.from, change.endB - parse.from))\n  if (parse.sel) {\n    let sel = resolveSelection(view, tr.doc, parse.sel)\n    // Chrome Android will sometimes, during composition, report the\n    // selection in the wrong place. If it looks like that is\n    // happening, don't update the selection.\n    // Edge just doesn't move the cursor forward when you start typing\n    // in an empty block or between br nodes.\n    if (sel && !(browser.chrome && browser.android && view.composing && sel.empty &&\n                   (sel.head == chFrom || sel.head == tr.mapping.map(chTo) - 1) ||\n                 browser.ie && sel.empty && sel.head == chFrom))\n      tr.setSelection(sel)\n  }\n  if (storedMarks) tr.ensureMarks(storedMarks)\n  view.dispatch(tr.scrollIntoView())\n}\n\nfunction resolveSelection(view, doc, parsedSel) {\n  if (Math.max(parsedSel.anchor, parsedSel.head) > doc.content.size) return null\n  return selectionBetween(view, doc.resolve(parsedSel.anchor), doc.resolve(parsedSel.head))\n}\n\n// : (Fragment, Fragment)  ?{mark: Mark, type: string}\n// Given two same-length, non-empty fragments of inline content,\n// determine whether the first could be created from the second by\n// removing or adding a single mark type.\nfunction isMarkChange(cur, prev) {\n  let curMarks = cur.firstChild.marks, prevMarks = prev.firstChild.marks\n  let added = curMarks, removed = prevMarks, type, mark, update\n  for (let i = 0; i < prevMarks.length; i++) added = prevMarks[i].removeFromSet(added)\n  for (let i = 0; i < curMarks.length; i++) removed = curMarks[i].removeFromSet(removed)\n  if (added.length == 1 && removed.length == 0) {\n    mark = added[0]\n    type = \"add\"\n    update = node => node.mark(mark.addToSet(node.marks))\n  } else if (added.length == 0 && removed.length == 1) {\n    mark = removed[0]\n    type = \"remove\"\n    update = node => node.mark(mark.removeFromSet(node.marks))\n  } else {\n    return null\n  }\n  let updated = []\n  for (let i = 0; i < prev.childCount; i++) updated.push(update(prev.child(i)))\n  if (Fragment.from(updated).eq(cur)) return {mark, type}\n}\n\nfunction looksLikeJoin(old, start, end, $newStart, $newEnd) {\n  if (!$newStart.parent.isTextblock ||\n      // The content must have shrunk\n      end - start <= $newEnd.pos - $newStart.pos ||\n      // newEnd must point directly at or after the end of the block that newStart points into\n      skipClosingAndOpening($newStart, true, false) < $newEnd.pos)\n    return false\n\n  let $start = old.resolve(start)\n  // Start must be at the end of a block\n  if ($start.parentOffset < $start.parent.content.size || !$start.parent.isTextblock)\n    return false\n  let $next = old.resolve(skipClosingAndOpening($start, true, true))\n  // The next textblock must start before end and end near it\n  if (!$next.parent.isTextblock || $next.pos > end ||\n      skipClosingAndOpening($next, true, false) < end)\n    return false\n\n  // The fragments after the join point must match\n  return $newStart.parent.content.cut($newStart.parentOffset).eq($next.parent.content)\n}\n\nfunction skipClosingAndOpening($pos, fromEnd, mayOpen) {\n  let depth = $pos.depth, end = fromEnd ? $pos.end() : $pos.pos\n  while (depth > 0 && (fromEnd || $pos.indexAfter(depth) == $pos.node(depth).childCount)) {\n    depth--\n    end++\n    fromEnd = false\n  }\n  if (mayOpen) {\n    let next = $pos.node(depth).maybeChild($pos.indexAfter(depth))\n    while (next && !next.isLeaf) {\n      next = next.firstChild\n      end++\n    }\n  }\n  return end\n}\n\nfunction findDiff(a, b, pos, preferredPos, preferredSide) {\n  let start = a.findDiffStart(b, pos)\n  if (start == null) return null\n  let {a: endA, b: endB} = a.findDiffEnd(b, pos + a.size, pos + b.size)\n  if (preferredSide == \"end\") {\n    let adjust = Math.max(0, start - Math.min(endA, endB))\n    preferredPos -= endA + adjust - start\n  }\n  if (endA < start && a.size < b.size) {\n    let move = preferredPos <= start && preferredPos >= endA ? start - preferredPos : 0\n    start -= move\n    endB = start + (endB - endA)\n    endA = start\n  } else if (endB < start) {\n    let move = preferredPos <= start && preferredPos >= endB ? start - preferredPos : 0\n    start -= move\n    endA = start + (endA - endB)\n    endB = start\n  }\n  return {start, endA, endB}\n}\n","import {Slice, Fragment, DOMParser, DOMSerializer} from \"prosemirror-model\"\n\nexport function serializeForClipboard(view, slice) {\n  let context = [], {content, openStart, openEnd} = slice\n  while (openStart > 1 && openEnd > 1 && content.childCount == 1 && content.firstChild.childCount == 1) {\n    openStart--\n    openEnd--\n    let node = content.firstChild\n    context.push(node.type.name, node.type.hasRequiredAttrs() ? node.attrs : null)\n    content = node.content\n  }\n\n  let serializer = view.someProp(\"clipboardSerializer\") || DOMSerializer.fromSchema(view.state.schema)\n  let doc = detachedDoc(), wrap = doc.createElement(\"div\")\n  wrap.appendChild(serializer.serializeFragment(content, {document: doc}))\n\n  let firstChild = wrap.firstChild, needsWrap\n  while (firstChild && firstChild.nodeType == 1 && (needsWrap = wrapMap[firstChild.nodeName.toLowerCase()])) {\n    for (let i = needsWrap.length - 1; i >= 0; i--) {\n      let wrapper = doc.createElement(needsWrap[i])\n      while (wrap.firstChild) wrapper.appendChild(wrap.firstChild)\n      wrap.appendChild(wrapper)\n    }\n    firstChild = wrap.firstChild\n  }\n\n  if (firstChild && firstChild.nodeType == 1)\n    firstChild.setAttribute(\"data-pm-slice\", `${openStart} ${openEnd} ${JSON.stringify(context)}`)\n\n  let text = view.someProp(\"clipboardTextSerializer\", f => f(slice)) ||\n      slice.content.textBetween(0, slice.content.size, \"\\n\\n\")\n\n  return {dom: wrap, text}\n}\n\n// : (EditorView, string, string, ?bool, ResolvedPos)  ?Slice\n// Read a slice of content from the clipboard (or drop data).\nexport function parseFromClipboard(view, text, html, plainText, $context) {\n  let dom, inCode = $context.parent.type.spec.code, slice\n  if (!html && !text) return null\n  let asText = text && (plainText || inCode || !html)\n  if (asText) {\n    view.someProp(\"transformPastedText\", f => { text = f(text) })\n    if (inCode) return new Slice(Fragment.from(view.state.schema.text(text)), 0, 0)\n    let parsed = view.someProp(\"clipboardTextParser\", f => f(text, $context))\n    if (parsed) {\n      slice = parsed\n    } else {\n      dom = document.createElement(\"div\")\n      text.trim().split(/(?:\\r\\n?|\\n)+/).forEach(block => {\n        dom.appendChild(document.createElement(\"p\")).textContent = block\n      })\n    }\n  } else {\n    view.someProp(\"transformPastedHTML\", f => { html = f(html) })\n    dom = readHTML(html)\n  }\n\n  let contextNode = dom && dom.querySelector(\"[data-pm-slice]\")\n  let sliceData = contextNode && /^(\\d+) (\\d+) (.*)/.exec(contextNode.getAttribute(\"data-pm-slice\"))\n  if (!slice) {\n    let parser = view.someProp(\"clipboardParser\") || view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema)\n    slice = parser.parseSlice(dom, {preserveWhitespace: !!(asText || sliceData), context: $context})\n  }\n  if (sliceData)\n    slice = addContext(closeSlice(slice, +sliceData[1], +sliceData[2]), sliceData[3])\n  else // HTML wasn't created by ProseMirror. Make sure top-level siblings are coherent\n    slice = Slice.maxOpen(normalizeSiblings(slice.content, $context), false)\n\n  view.someProp(\"transformPasted\", f => { slice = f(slice) })\n  return slice\n}\n\n// Takes a slice parsed with parseSlice, which means there hasn't been\n// any content-expression checking done on the top nodes, tries to\n// find a parent node in the current context that might fit the nodes,\n// and if successful, rebuilds the slice so that it fits into that parent.\n//\n// This addresses the problem that Transform.replace expects a\n// coherent slice, and will fail to place a set of siblings that don't\n// fit anywhere in the schema.\nfunction normalizeSiblings(fragment, $context) {\n  if (fragment.childCount < 2) return fragment\n  for (let d = $context.depth; d >= 0; d--) {\n    let parent = $context.node(d)\n    let match = parent.contentMatchAt($context.index(d))\n    let lastWrap, result = []\n    fragment.forEach(node => {\n      if (!result) return\n      let wrap = match.findWrapping(node.type), inLast\n      if (!wrap) return result = null\n      if (inLast = result.length && lastWrap.length && addToSibling(wrap, lastWrap, node, result[result.length - 1], 0)) {\n        result[result.length - 1] = inLast\n      } else {\n        if (result.length) result[result.length - 1] = closeRight(result[result.length - 1], lastWrap.length)\n        let wrapped = withWrappers(node, wrap)\n        result.push(wrapped)\n        match = match.matchType(wrapped.type, wrapped.attrs)\n        lastWrap = wrap\n      }\n    })\n    if (result) return Fragment.from(result)\n  }\n  return fragment\n}\n\nfunction withWrappers(node, wrap, from = 0) {\n  for (let i = wrap.length - 1; i >= from; i--)\n    node = wrap[i].create(null, Fragment.from(node))\n  return node\n}\n\n// Used to group adjacent nodes wrapped in similar parents by\n// normalizeSiblings into the same parent node\nfunction addToSibling(wrap, lastWrap, node, sibling, depth) {\n  if (depth < wrap.length && depth < lastWrap.length && wrap[depth] == lastWrap[depth]) {\n    let inner = addToSibling(wrap, lastWrap, node, sibling.lastChild, depth + 1)\n    if (inner) return sibling.copy(sibling.content.replaceChild(sibling.childCount - 1, inner))\n    let match = sibling.contentMatchAt(sibling.childCount)\n    if (match.matchType(depth == wrap.length - 1 ? node.type : wrap[depth + 1]))\n      return sibling.copy(sibling.content.append(Fragment.from(withWrappers(node, wrap, depth + 1))))\n  }\n}\n\nfunction closeRight(node, depth) {\n  if (depth == 0) return node\n  let fragment = node.content.replaceChild(node.childCount - 1, closeRight(node.lastChild, depth - 1))\n  let fill = node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true)\n  return node.copy(fragment.append(fill))\n}\n\nfunction closeRange(fragment, side, from, to, depth, openEnd) {\n  let node = side < 0 ? fragment.firstChild : fragment.lastChild, inner = node.content\n  if (depth < to - 1) inner = closeRange(inner, side, from, to, depth + 1, openEnd)\n  if (depth >= from)\n    inner = side < 0 ? node.contentMatchAt(0).fillBefore(inner, fragment.childCount > 1 || openEnd <= depth).append(inner)\n      : inner.append(node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true))\n  return fragment.replaceChild(side < 0 ? 0 : fragment.childCount - 1, node.copy(inner))\n}\n\nfunction closeSlice(slice, openStart, openEnd) {\n  if (openStart < slice.openStart)\n    slice = new Slice(closeRange(slice.content, -1, openStart, slice.openStart, 0, slice.openEnd), openStart, slice.openEnd)\n  if (openEnd < slice.openEnd)\n    slice = new Slice(closeRange(slice.content, 1, openEnd, slice.openEnd, 0, 0), slice.openStart, openEnd)\n  return slice\n}\n\n// Trick from jQuery -- some elements must be wrapped in other\n// elements for innerHTML to work. I.e. if you do `div.innerHTML =\n// \"<td>..</td>\"` the table cells are ignored.\nconst wrapMap = {\n  thead: [\"table\"],\n  tbody: [\"table\"],\n  tfoot: [\"table\"],\n  caption: [\"table\"],\n  colgroup: [\"table\"],\n  col: [\"table\", \"colgroup\"],\n  tr: [\"table\", \"tbody\"],\n  td: [\"table\", \"tbody\", \"tr\"],\n  th: [\"table\", \"tbody\", \"tr\"]\n}\n\nlet _detachedDoc = null\nfunction detachedDoc() {\n  return _detachedDoc || (_detachedDoc = document.implementation.createHTMLDocument(\"title\"))\n}\n\nfunction readHTML(html) {\n  let metas = /(\\s*<meta [^>]*>)*/.exec(html)\n  if (metas) html = html.slice(metas[0].length)\n  let elt = detachedDoc().createElement(\"div\")\n  let firstTag = /(?:<meta [^>]*>)*<([a-z][^>\\s]+)/i.exec(html), wrap, depth = 0\n  if (wrap = firstTag && wrapMap[firstTag[1].toLowerCase()]) {\n    html = wrap.map(n => \"<\" + n + \">\").join(\"\") + html + wrap.map(n => \"</\" + n + \">\").reverse().join(\"\")\n    depth = wrap.length\n  }\n  elt.innerHTML = html\n  for (let i = 0; i < depth; i++) elt = elt.firstChild\n  return elt\n}\n\nfunction addContext(slice, context) {\n  if (!slice.size) return slice\n  let schema = slice.content.firstChild.type.schema, array\n  try { array = JSON.parse(context) }\n  catch(e) { return slice }\n  let {content, openStart, openEnd} = slice\n  for (let i = array.length - 2; i >= 0; i -= 2) {\n    let type = schema.nodes[array[i]]\n    if (!type || type.hasRequiredAttrs()) break\n    content = Fragment.from(type.create(array[i + 1], content))\n    openStart++; openEnd++\n  }\n  return new Slice(content, openStart, openEnd)\n}\n","import browser from \"./browser\"\nimport {domIndex, isEquivalentPosition} from \"./dom\"\nimport {hasFocusAndSelection, hasSelection, selectionToDOM} from \"./selection\"\n\nconst observeOptions = {\n  childList: true,\n  characterData: true,\n  characterDataOldValue: true,\n  attributes: true,\n  attributeOldValue: true,\n  subtree: true\n}\n// IE11 has very broken mutation observers, so we also listen to DOMCharacterDataModified\nconst useCharData = browser.ie && browser.ie_version <= 11\n\nclass SelectionState {\n  constructor() {\n    this.anchorNode = this.anchorOffset = this.focusNode = this.focusOffset = null\n  }\n\n  set(sel) {\n    this.anchorNode = sel.anchorNode; this.anchorOffset = sel.anchorOffset\n    this.focusNode = sel.focusNode; this.focusOffset = sel.focusOffset\n  }\n\n  eq(sel) {\n    return sel.anchorNode == this.anchorNode && sel.anchorOffset == this.anchorOffset &&\n      sel.focusNode == this.focusNode && sel.focusOffset == this.focusOffset\n  }\n}\n\nexport class DOMObserver {\n  constructor(view, handleDOMChange) {\n    this.view = view\n    this.handleDOMChange = handleDOMChange\n    this.queue = []\n    this.flushingSoon = -1\n    this.observer = window.MutationObserver &&\n      new window.MutationObserver(mutations => {\n        for (let i = 0; i < mutations.length; i++) this.queue.push(mutations[i])\n        // IE11 will sometimes (on backspacing out a single character\n        // text node after a BR node) call the observer callback\n        // before actually updating the DOM, which will cause\n        // ProseMirror to miss the change (see #930)\n        if (browser.ie && browser.ie_version <= 11 && mutations.some(\n          m => m.type == \"childList\" && m.removedNodes.length ||\n               m.type == \"characterData\" && m.oldValue.length > m.target.nodeValue.length))\n          this.flushSoon()\n        else\n          this.flush()\n      })\n    this.currentSelection = new SelectionState\n    if (useCharData) {\n      this.onCharData = e => {\n        this.queue.push({target: e.target, type: \"characterData\", oldValue: e.prevValue})\n        this.flushSoon()\n      }\n    }\n    this.onSelectionChange = this.onSelectionChange.bind(this)\n    this.suppressingSelectionUpdates = false\n  }\n\n  flushSoon() {\n    if (this.flushingSoon < 0)\n      this.flushingSoon = window.setTimeout(() => { this.flushingSoon = -1; this.flush() }, 20)\n  }\n\n  forceFlush() {\n    if (this.flushingSoon > -1) {\n      window.clearTimeout(this.flushingSoon)\n      this.flushingSoon = -1\n      this.flush()\n    }\n  }\n\n  start() {\n    if (this.observer)\n      this.observer.observe(this.view.dom, observeOptions)\n    if (useCharData)\n      this.view.dom.addEventListener(\"DOMCharacterDataModified\", this.onCharData)\n    this.connectSelection()\n  }\n\n  stop() {\n    if (this.observer) {\n      let take = this.observer.takeRecords()\n      if (take.length) {\n        for (let i = 0; i < take.length; i++) this.queue.push(take[i])\n        window.setTimeout(() => this.flush(), 20)\n      }\n      this.observer.disconnect()\n    }\n    if (useCharData) this.view.dom.removeEventListener(\"DOMCharacterDataModified\", this.onCharData)\n    this.disconnectSelection()\n  }\n\n  connectSelection() {\n    this.view.dom.ownerDocument.addEventListener(\"selectionchange\", this.onSelectionChange)\n  }\n\n  disconnectSelection() {\n    this.view.dom.ownerDocument.removeEventListener(\"selectionchange\", this.onSelectionChange)\n  }\n\n  suppressSelectionUpdates() {\n    this.suppressingSelectionUpdates = true\n    setTimeout(() => this.suppressingSelectionUpdates = false, 50)\n  }\n\n  onSelectionChange() {\n    if (!hasFocusAndSelection(this.view)) return\n    if (this.suppressingSelectionUpdates) return selectionToDOM(this.view)\n    // Deletions on IE11 fire their events in the wrong order, giving\n    // us a selection change event before the DOM changes are\n    // reported.\n    if (browser.ie && browser.ie_version <= 11 && !this.view.state.selection.empty) {\n      let sel = this.view.root.getSelection()\n      // Selection.isCollapsed isn't reliable on IE\n      if (sel.focusNode && isEquivalentPosition(sel.focusNode, sel.focusOffset, sel.anchorNode, sel.anchorOffset))\n        return this.flushSoon()\n    }\n    this.flush()\n  }\n\n  setCurSelection() {\n    this.currentSelection.set(this.view.root.getSelection())\n  }\n\n  ignoreSelectionChange(sel) {\n    if (sel.rangeCount == 0) return true\n    let container = sel.getRangeAt(0).commonAncestorContainer\n    let desc = this.view.docView.nearestDesc(container)\n    if (desc && desc.ignoreMutation({type: \"selection\", target: container.nodeType == 3 ? container.parentNode : container})) {\n      this.setCurSelection()\n      return true\n    }\n  }\n\n  flush() {\n    if (!this.view.docView || this.flushingSoon > -1) return\n    let mutations = this.observer ? this.observer.takeRecords() : []\n    if (this.queue.length) {\n      mutations = this.queue.concat(mutations)\n      this.queue.length = 0\n    }\n\n    let sel = this.view.root.getSelection()\n    let newSel = !this.suppressingSelectionUpdates && !this.currentSelection.eq(sel) && hasSelection(this.view) && !this.ignoreSelectionChange(sel)\n\n    let from = -1, to = -1, typeOver = false, added = []\n    if (this.view.editable) {\n      for (let i = 0; i < mutations.length; i++) {\n        let result = this.registerMutation(mutations[i], added)\n        if (result) {\n          from = from < 0 ? result.from : Math.min(result.from, from)\n          to = to < 0 ? result.to : Math.max(result.to, to)\n          if (result.typeOver) typeOver = true\n        }\n      }\n    }\n\n    if (browser.gecko && added.length > 1) {\n      let brs = added.filter(n => n.nodeName == \"BR\")\n      if (brs.length == 2) {\n        let [a, b] = brs\n        if (a.parentNode && a.parentNode.parentNode == b.parentNode) b.remove()\n        else a.remove()\n      }\n    }\n\n    if (from > -1 || newSel) {\n      if (from > -1) {\n        this.view.docView.markDirty(from, to)\n        checkCSS(this.view)\n      }\n      this.handleDOMChange(from, to, typeOver, added)\n      if (this.view.docView.dirty) this.view.updateState(this.view.state)\n      else if (!this.currentSelection.eq(sel)) selectionToDOM(this.view)\n    }\n  }\n\n  registerMutation(mut, added) {\n    // Ignore mutations inside nodes that were already noted as inserted\n    if (added.indexOf(mut.target) > -1) return null\n    let desc = this.view.docView.nearestDesc(mut.target)\n    if (mut.type == \"attributes\" &&\n        (desc == this.view.docView || mut.attributeName == \"contenteditable\" ||\n         // Firefox sometimes fires spurious events for null/empty styles\n         (mut.attributeName == \"style\" && !mut.oldValue && !mut.target.getAttribute(\"style\"))))\n      return null\n    if (!desc || desc.ignoreMutation(mut)) return null\n\n    if (mut.type == \"childList\") {\n      let prev = mut.previousSibling, next = mut.nextSibling\n      if (browser.ie && browser.ie_version <= 11 && mut.addedNodes.length) {\n        // IE11 gives us incorrect next/prev siblings for some\n        // insertions, so if there are added nodes, recompute those\n        for (let i = 0; i < mut.addedNodes.length; i++) {\n          let {previousSibling, nextSibling} = mut.addedNodes[i]\n          if (!previousSibling || Array.prototype.indexOf.call(mut.addedNodes, previousSibling) < 0) prev = previousSibling\n          if (!nextSibling || Array.prototype.indexOf.call(mut.addedNodes, nextSibling) < 0) next = nextSibling\n        }\n      }\n      let fromOffset = prev && prev.parentNode == mut.target\n          ? domIndex(prev) + 1 : 0\n      let from = desc.localPosFromDOM(mut.target, fromOffset, -1)\n      let toOffset = next && next.parentNode == mut.target\n          ? domIndex(next) : mut.target.childNodes.length\n      for (let i = 0; i < mut.addedNodes.length; i++) added.push(mut.addedNodes[i])\n      let to = desc.localPosFromDOM(mut.target, toOffset, 1)\n      return {from, to}\n    } else if (mut.type == \"attributes\") {\n      return {from: desc.posAtStart - desc.border, to: desc.posAtEnd + desc.border}\n    } else { // \"characterData\"\n      return {\n        from: desc.posAtStart,\n        to: desc.posAtEnd,\n        // An event was generated for a text change that didn't change\n        // any text. Mark the dom change to fall back to assuming the\n        // selection was typed over with an identical value if it can't\n        // find another change.\n        typeOver: mut.target.nodeValue == mut.oldValue\n      }\n    }\n  }\n}\n\nlet cssChecked = false\n\nfunction checkCSS(view) {\n  if (cssChecked) return\n  cssChecked = true\n  if (getComputedStyle(view.dom).whiteSpace == \"normal\")\n    console[\"warn\"](\"ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.\")\n}\n","import {Selection, NodeSelection, TextSelection} from \"prosemirror-state\"\nimport {dropPoint} from \"prosemirror-transform\"\nimport {Slice} from \"prosemirror-model\"\n\nimport browser from \"./browser\"\nimport {captureKeyDown} from \"./capturekeys\"\nimport {readDOMChange} from \"./domchange\"\nimport {parseFromClipboard, serializeForClipboard} from \"./clipboard\"\nimport {DOMObserver} from \"./domobserver\"\nimport {selectionBetween, selectionToDOM, selectionFromDOM} from \"./selection\"\nimport {keyEvent} from \"./dom\"\n\n// A collection of DOM events that occur within the editor, and callback functions\n// to invoke when the event fires.\nconst handlers = {}, editHandlers = {}\n\nexport function initInput(view) {\n  view.shiftKey = false\n  view.mouseDown = null\n  view.lastKeyCode = null\n  view.lastKeyCodeTime = 0\n  view.lastClick = {time: 0, x: 0, y: 0, type: \"\"}\n  view.lastSelectionOrigin = null\n  view.lastSelectionTime = 0\n\n  view.lastIOSEnter = 0\n\n  view.composing = false\n  view.composingTimeout = null\n  view.compositionNodes = []\n  view.compositionEndedAt = -2e8\n\n  view.domObserver = new DOMObserver(view, (from, to, typeOver, added) => readDOMChange(view, from, to, typeOver, added))\n  view.domObserver.start()\n  // Used by hacks like the beforeinput handler to check whether anything happened in the DOM\n  view.domChangeCount = 0\n\n  view.eventHandlers = Object.create(null)\n  for (let event in handlers) {\n    let handler = handlers[event]\n    view.dom.addEventListener(event, view.eventHandlers[event] = event => {\n      if (eventBelongsToView(view, event) && !runCustomHandler(view, event) &&\n          (view.editable || !(event.type in editHandlers)))\n        handler(view, event)\n    })\n  }\n  // On Safari, for reasons beyond my understanding, adding an input\n  // event handler makes an issue where the composition vanishes when\n  // you press enter go away.\n  if (browser.safari) view.dom.addEventListener(\"input\", () => null)\n\n  ensureListeners(view)\n}\n\nfunction setSelectionOrigin(view, origin) {\n  view.lastSelectionOrigin = origin\n  view.lastSelectionTime = Date.now()\n}\n\nexport function destroyInput(view) {\n  view.domObserver.stop()\n  for (let type in view.eventHandlers)\n    view.dom.removeEventListener(type, view.eventHandlers[type])\n  clearTimeout(view.composingTimeout)\n}\n\nexport function ensureListeners(view) {\n  view.someProp(\"handleDOMEvents\", currentHandlers => {\n    for (let type in currentHandlers) if (!view.eventHandlers[type])\n      view.dom.addEventListener(type, view.eventHandlers[type] = event => runCustomHandler(view, event))\n  })\n}\n\nfunction runCustomHandler(view, event) {\n  return view.someProp(\"handleDOMEvents\", handlers => {\n    let handler = handlers[event.type]\n    return handler ? handler(view, event) || event.defaultPrevented : false\n  })\n}\n\nfunction eventBelongsToView(view, event) {\n  if (!event.bubbles) return true\n  if (event.defaultPrevented) return false\n  for (let node = event.target; node != view.dom; node = node.parentNode)\n    if (!node || node.nodeType == 11 ||\n        (node.pmViewDesc && node.pmViewDesc.stopEvent(event)))\n      return false\n  return true\n}\n\nexport function dispatchEvent(view, event) {\n  if (!runCustomHandler(view, event) && handlers[event.type] &&\n      (view.editable || !(event.type in editHandlers)))\n    handlers[event.type](view, event)\n}\n\neditHandlers.keydown = (view, event) => {\n  view.shiftKey = event.keyCode == 16 || event.shiftKey\n  if (inOrNearComposition(view, event)) return\n  view.domObserver.forceFlush()\n  view.lastKeyCode = event.keyCode\n  view.lastKeyCodeTime = Date.now()\n  // On iOS, if we preventDefault enter key presses, the virtual\n  // keyboard gets confused. So the hack here is to set a flag that\n  // makes the DOM change code recognize that what just happens should\n  // be replaced by whatever the Enter key handlers do.\n  if (browser.ios && event.keyCode == 13 && !event.ctrlKey && !event.altKey && !event.metaKey) {\n    let now = Date.now()\n    view.lastIOSEnter = now\n    setTimeout(() => {\n      if (view.lastIOSEnter == now) {\n        view.someProp(\"handleKeyDown\", f => f(view, keyEvent(13, \"Enter\")))\n        view.lastIOSEnter = 0\n      }\n    }, 50)\n  } else if (view.someProp(\"handleKeyDown\", f => f(view, event)) || captureKeyDown(view, event)) {\n    event.preventDefault()\n  } else {\n    setSelectionOrigin(view, \"key\")\n  }\n}\n\neditHandlers.keyup = (view, e) => {\n  if (e.keyCode == 16) view.shiftKey = false\n}\n\neditHandlers.keypress = (view, event) => {\n  if (inOrNearComposition(view, event) || !event.charCode ||\n      event.ctrlKey && !event.altKey || browser.mac && event.metaKey) return\n\n  if (view.someProp(\"handleKeyPress\", f => f(view, event))) {\n    event.preventDefault()\n    return\n  }\n\n  let sel = view.state.selection\n  if (!(sel instanceof TextSelection) || !sel.$from.sameParent(sel.$to)) {\n    let text = String.fromCharCode(event.charCode)\n    if (!view.someProp(\"handleTextInput\", f => f(view, sel.$from.pos, sel.$to.pos, text)))\n      view.dispatch(view.state.tr.insertText(text).scrollIntoView())\n    event.preventDefault()\n  }\n}\n\nfunction eventCoords(event) { return {left: event.clientX, top: event.clientY} }\n\nfunction isNear(event, click) {\n  let dx = click.x - event.clientX, dy = click.y - event.clientY\n  return dx * dx + dy * dy < 100\n}\n\nfunction runHandlerOnContext(view, propName, pos, inside, event) {\n  if (inside == -1) return false\n  let $pos = view.state.doc.resolve(inside)\n  for (let i = $pos.depth + 1; i > 0; i--) {\n    if (view.someProp(propName, f => i > $pos.depth ? f(view, pos, $pos.nodeAfter, $pos.before(i), event, true)\n                                                    : f(view, pos, $pos.node(i), $pos.before(i), event, false)))\n      return true\n  }\n  return false\n}\n\nfunction updateSelection(view, selection, origin) {\n  if (!view.focused) view.focus()\n  let tr = view.state.tr.setSelection(selection)\n  if (origin == \"pointer\") tr.setMeta(\"pointer\", true)\n  view.dispatch(tr)\n}\n\nfunction selectClickedLeaf(view, inside) {\n  if (inside == -1) return false\n  let $pos = view.state.doc.resolve(inside), node = $pos.nodeAfter\n  if (node && node.isAtom && NodeSelection.isSelectable(node)) {\n    updateSelection(view, new NodeSelection($pos), \"pointer\")\n    return true\n  }\n  return false\n}\n\nfunction selectClickedNode(view, inside) {\n  if (inside == -1) return false\n  let sel = view.state.selection, selectedNode, selectAt\n  if (sel instanceof NodeSelection) selectedNode = sel.node\n\n  let $pos = view.state.doc.resolve(inside)\n  for (let i = $pos.depth + 1; i > 0; i--) {\n    let node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i)\n    if (NodeSelection.isSelectable(node)) {\n      if (selectedNode && sel.$from.depth > 0 &&\n          i >= sel.$from.depth && $pos.before(sel.$from.depth + 1) == sel.$from.pos)\n        selectAt = $pos.before(sel.$from.depth)\n      else\n        selectAt = $pos.before(i)\n      break\n    }\n  }\n\n  if (selectAt != null) {\n    updateSelection(view, NodeSelection.create(view.state.doc, selectAt), \"pointer\")\n    return true\n  } else {\n    return false\n  }\n}\n\nfunction handleSingleClick(view, pos, inside, event, selectNode) {\n  return runHandlerOnContext(view, \"handleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleClick\", f => f(view, pos, event)) ||\n    (selectNode ? selectClickedNode(view, inside) : selectClickedLeaf(view, inside))\n}\n\nfunction handleDoubleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleDoubleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleDoubleClick\", f => f(view, pos, event))\n}\n\nfunction handleTripleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleTripleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleTripleClick\", f => f(view, pos, event)) ||\n    defaultTripleClick(view, inside)\n}\n\nfunction defaultTripleClick(view, inside) {\n  let doc = view.state.doc\n  if (inside == -1) {\n    if (doc.inlineContent) {\n      updateSelection(view, TextSelection.create(doc, 0, doc.content.size), \"pointer\")\n      return true\n    }\n    return false\n  }\n\n  let $pos = doc.resolve(inside)\n  for (let i = $pos.depth + 1; i > 0; i--) {\n    let node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i)\n    let nodePos = $pos.before(i)\n    if (node.inlineContent)\n      updateSelection(view, TextSelection.create(doc, nodePos + 1, nodePos + 1 + node.content.size), \"pointer\")\n    else if (NodeSelection.isSelectable(node))\n      updateSelection(view, NodeSelection.create(doc, nodePos), \"pointer\")\n    else\n      continue\n    return true\n  }\n}\n\nfunction forceDOMFlush(view) {\n  return endComposition(view)\n}\n\nconst selectNodeModifier = browser.mac ? \"metaKey\" : \"ctrlKey\"\n\nhandlers.mousedown = (view, event) => {\n  view.shiftKey = event.shiftKey\n  let flushed = forceDOMFlush(view)\n  let now = Date.now(), type = \"singleClick\"\n  if (now - view.lastClick.time < 500 && isNear(event, view.lastClick) && !event[selectNodeModifier]) {\n    if (view.lastClick.type == \"singleClick\") type = \"doubleClick\"\n    else if (view.lastClick.type == \"doubleClick\") type = \"tripleClick\"\n  }\n  view.lastClick = {time: now, x: event.clientX, y: event.clientY, type}\n\n  let pos = view.posAtCoords(eventCoords(event))\n  if (!pos) return\n\n  if (type == \"singleClick\")\n    view.mouseDown = new MouseDown(view, pos, event, flushed)\n  else if ((type == \"doubleClick\" ? handleDoubleClick : handleTripleClick)(view, pos.pos, pos.inside, event))\n    event.preventDefault()\n  else\n    setSelectionOrigin(view, \"pointer\")\n}\n\nclass MouseDown {\n  constructor(view, pos, event, flushed) {\n    this.view = view\n    this.startDoc = view.state.doc\n    this.pos = pos\n    this.event = event\n    this.flushed = flushed\n    this.selectNode = event[selectNodeModifier]\n    this.allowDefault = event.shiftKey\n\n    let targetNode, targetPos\n    if (pos.inside > -1) {\n      targetNode = view.state.doc.nodeAt(pos.inside)\n      targetPos = pos.inside\n    } else {\n      let $pos = view.state.doc.resolve(pos.pos)\n      targetNode = $pos.parent\n      targetPos = $pos.depth ? $pos.before() : 0\n    }\n\n    this.mightDrag = null\n\n    const target = flushed ? null : event.target\n    const targetDesc = target ? view.docView.nearestDesc(target, true) : null\n    this.target = targetDesc ? targetDesc.dom : null\n\n    if (targetNode.type.spec.draggable && targetNode.type.spec.selectable !== false ||\n        view.state.selection instanceof NodeSelection && targetPos == view.state.selection.from)\n      this.mightDrag = {node: targetNode,\n                        pos: targetPos,\n                        addAttr: this.target && !this.target.draggable,\n                        setUneditable: this.target && browser.gecko && !this.target.hasAttribute(\"contentEditable\")}\n\n    if (this.target && this.mightDrag && (this.mightDrag.addAttr || this.mightDrag.setUneditable)) {\n      this.view.domObserver.stop()\n      if (this.mightDrag.addAttr) this.target.draggable = true\n      if (this.mightDrag.setUneditable)\n        setTimeout(() => this.target.setAttribute(\"contentEditable\", \"false\"), 20)\n      this.view.domObserver.start()\n    }\n\n    view.root.addEventListener(\"mouseup\", this.up = this.up.bind(this))\n    view.root.addEventListener(\"mousemove\", this.move = this.move.bind(this))\n    setSelectionOrigin(view, \"pointer\")\n  }\n\n  done() {\n    this.view.root.removeEventListener(\"mouseup\", this.up)\n    this.view.root.removeEventListener(\"mousemove\", this.move)\n    if (this.mightDrag && this.target) {\n      this.view.domObserver.stop()\n      if (this.mightDrag.addAttr) this.target.removeAttribute(\"draggable\")\n      if (this.mightDrag.setUneditable) this.target.removeAttribute(\"contentEditable\")\n      this.view.domObserver.start()\n    }\n    this.view.mouseDown = null\n  }\n\n  up(event) {\n    this.done()\n\n    if (!this.view.dom.contains(event.target.nodeType == 3 ? event.target.parentNode : event.target))\n      return\n\n    let pos = this.pos\n    if (this.view.state.doc != this.startDoc) pos = this.view.posAtCoords(eventCoords(event))\n\n    if (this.allowDefault || !pos) {\n      setSelectionOrigin(this.view, \"pointer\")\n    } else if (handleSingleClick(this.view, pos.pos, pos.inside, event, this.selectNode)) {\n      event.preventDefault()\n    } else if (this.flushed ||\n               // Safari ignores clicks on draggable elements\n               (browser.safari && this.mightDrag && !this.mightDrag.node.isAtom) ||\n               // Chrome will sometimes treat a node selection as a\n               // cursor, but still report that the node is selected\n               // when asked through getSelection. You'll then get a\n               // situation where clicking at the point where that\n               // (hidden) cursor is doesn't change the selection, and\n               // thus doesn't get a reaction from ProseMirror. This\n               // works around that.\n               (browser.chrome && !(this.view.state.selection instanceof TextSelection) &&\n                (pos.pos == this.view.state.selection.from || pos.pos == this.view.state.selection.to))) {\n      updateSelection(this.view, Selection.near(this.view.state.doc.resolve(pos.pos)), \"pointer\")\n      event.preventDefault()\n    } else {\n      setSelectionOrigin(this.view, \"pointer\")\n    }\n  }\n\n  move(event) {\n    if (!this.allowDefault && (Math.abs(this.event.x - event.clientX) > 4 ||\n                               Math.abs(this.event.y - event.clientY) > 4))\n      this.allowDefault = true\n    setSelectionOrigin(this.view, \"pointer\")\n  }\n}\n\nhandlers.touchdown = view => {\n  forceDOMFlush(view)\n  setSelectionOrigin(view, \"pointer\")\n}\n\nhandlers.contextmenu = view => forceDOMFlush(view)\n\nfunction inOrNearComposition(view, event) {\n  if (view.composing) return true\n  // See https://www.stum.de/2016/06/24/handling-ime-events-in-javascript/.\n  // On Japanese input method editors (IMEs), the Enter key is used to confirm character\n  // selection. On Safari, when Enter is pressed, compositionend and keydown events are\n  // emitted. The keydown event triggers newline insertion, which we don't want.\n  // This method returns true if the keydown event should be ignored.\n  // We only ignore it once, as pressing Enter a second time *should* insert a newline.\n  // Furthermore, the keydown event timestamp must be close to the compositionEndedAt timestamp.\n  // This guards against the case where compositionend is triggered without the keyboard\n  // (e.g. character confirmation may be done with the mouse), and keydown is triggered\n  // afterwards- we wouldn't want to ignore the keydown event in this case.\n  if (browser.safari && Math.abs(event.timeStamp - view.compositionEndedAt) < 500) {\n    view.compositionEndedAt = -2e8\n    return true\n  }\n  return false\n}\n\n// Drop active composition after 5 seconds of inactivity on Android\nconst timeoutComposition = browser.android ? 5000 : -1\n\neditHandlers.compositionstart = editHandlers.compositionupdate = view => {\n  if (!view.composing) {\n    view.domObserver.flush()\n    let {state} = view, $pos = state.selection.$from\n    if (state.selection.empty &&\n        (state.storedMarks || (!$pos.textOffset && $pos.parentOffset && $pos.nodeBefore.marks.some(m => m.type.spec.inclusive === false)))) {\n      // Need to wrap the cursor in mark nodes different from the ones in the DOM context\n      view.markCursor = view.state.storedMarks || $pos.marks()\n      endComposition(view, true)\n      view.markCursor = null\n    } else {\n      endComposition(view)\n      // In firefox, if the cursor is after but outside a marked node,\n      // the inserted text won't inherit the marks. So this moves it\n      // inside if necessary.\n      if (browser.gecko && state.selection.empty && $pos.parentOffset && !$pos.textOffset && $pos.nodeBefore.marks.length) {\n        let sel = view.root.getSelection()\n        for (let node = sel.focusNode, offset = sel.focusOffset; node && node.nodeType == 1 && offset != 0;) {\n          let before = offset < 0 ? node.lastChild : node.childNodes[offset - 1]\n          if (!before) break\n          if (before.nodeType == 3) {\n            sel.collapse(before, before.nodeValue.length)\n            break\n          } else {\n            node = before\n            offset = -1\n          }\n        }\n      }\n    }\n    view.composing = true\n  }\n  scheduleComposeEnd(view, timeoutComposition)\n}\n\neditHandlers.compositionend = (view, event) => {\n  if (view.composing) {\n    view.composing = false\n    view.compositionEndedAt = event.timeStamp\n    scheduleComposeEnd(view, 20)\n  }\n}\n\nfunction scheduleComposeEnd(view, delay) {\n  clearTimeout(view.composingTimeout)\n  if (delay > -1) view.composingTimeout = setTimeout(() => endComposition(view), delay)\n}\n\nexport function endComposition(view, forceUpdate) {\n  view.domObserver.forceFlush()\n  view.composing = false\n  while (view.compositionNodes.length > 0) view.compositionNodes.pop().markParentsDirty()\n  if (forceUpdate || view.docView.dirty) {\n    let sel = selectionFromDOM(view)\n    if (!sel.eq(view.state.selection)) view.dispatch(view.state.tr.setSelection(sel))\n    else view.updateState(view.state)\n    return true\n  }\n  return false\n}\n\nfunction captureCopy(view, dom) {\n  // The extra wrapper is somehow necessary on IE/Edge to prevent the\n  // content from being mangled when it is put onto the clipboard\n  if (!view.dom.parentNode) return\n  let wrap = view.dom.parentNode.appendChild(document.createElement(\"div\"))\n  wrap.appendChild(dom)\n  wrap.style.cssText = \"position: fixed; left: -10000px; top: 10px\"\n  let sel = getSelection(), range = document.createRange()\n  range.selectNodeContents(dom)\n  // Done because IE will fire a selectionchange moving the selection\n  // to its start when removeAllRanges is called and the editor still\n  // has focus (which will mess up the editor's selection state).\n  view.dom.blur()\n  sel.removeAllRanges()\n  sel.addRange(range)\n  setTimeout(() => {\n    if (wrap.parentNode) wrap.parentNode.removeChild(wrap)\n    view.focus()\n  }, 50)\n}\n\n// This is very crude, but unfortunately both these browsers _pretend_\n// that they have a clipboard APIall the objects and methods are\n// there, they just don't work, and they are hard to test.\nconst brokenClipboardAPI = (browser.ie && browser.ie_version < 15) ||\n      (browser.ios && browser.webkit_version < 604)\n\nhandlers.copy = editHandlers.cut = (view, e) => {\n  let sel = view.state.selection, cut = e.type == \"cut\"\n  if (sel.empty) return\n\n  // IE and Edge's clipboard interface is completely broken\n  let data = brokenClipboardAPI ? null : e.clipboardData\n  let slice = sel.content(), {dom, text} = serializeForClipboard(view, slice)\n  if (data) {\n    e.preventDefault()\n    data.clearData()\n    data.setData(\"text/html\", dom.innerHTML)\n    data.setData(\"text/plain\", text)\n  } else {\n    captureCopy(view, dom)\n  }\n  if (cut) view.dispatch(view.state.tr.deleteSelection().scrollIntoView().setMeta(\"uiEvent\", \"cut\"))\n}\n\nfunction sliceSingleNode(slice) {\n  return slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1 ? slice.content.firstChild : null\n}\n\nfunction capturePaste(view, e) {\n  if (!view.dom.parentNode) return\n  let plainText = view.shiftKey || view.state.selection.$from.parent.type.spec.code\n  let target = view.dom.parentNode.appendChild(document.createElement(plainText ? \"textarea\" : \"div\"))\n  if (!plainText) target.contentEditable = \"true\"\n  target.style.cssText = \"position: fixed; left: -10000px; top: 10px\"\n  target.focus()\n  setTimeout(() => {\n    view.focus()\n    if (target.parentNode) target.parentNode.removeChild(target)\n    if (plainText) doPaste(view, target.value, null, e)\n    else doPaste(view, target.textContent, target.innerHTML, e)\n  }, 50)\n}\n\nfunction doPaste(view, text, html, e) {\n  let slice = parseFromClipboard(view, text, html, view.shiftKey, view.state.selection.$from)\n  if (view.someProp(\"handlePaste\", f => f(view, e, slice || Slice.empty)) || !slice) return\n\n  let singleNode = sliceSingleNode(slice)\n  let tr = singleNode ? view.state.tr.replaceSelectionWith(singleNode, view.shiftKey) : view.state.tr.replaceSelection(slice)\n  view.dispatch(tr.scrollIntoView().setMeta(\"paste\", true).setMeta(\"uiEvent\", \"paste\"))\n}\n\neditHandlers.paste = (view, e) => {\n  let data = brokenClipboardAPI ? null : e.clipboardData\n  let html = data && data.getData(\"text/html\"), text = data && data.getData(\"text/plain\")\n  if (data && (html || text || data.files.length)) {\n    doPaste(view, text, html, e)\n    e.preventDefault()\n  } else {\n    capturePaste(view, e)\n  }\n}\n\nclass Dragging {\n  constructor(slice, move) {\n    this.slice = slice\n    this.move = move\n  }\n}\n\nconst dragCopyModifier = browser.mac ? \"altKey\" : \"ctrlKey\"\n\nhandlers.dragstart = (view, e) => {\n  let mouseDown = view.mouseDown\n  if (mouseDown) mouseDown.done()\n  if (!e.dataTransfer) return\n\n  let sel = view.state.selection\n  let pos = sel.empty ? null : view.posAtCoords(eventCoords(e))\n  if (pos && pos.pos >= sel.from && pos.pos <= (sel instanceof NodeSelection ? sel.to - 1: sel.to)) {\n    // In selection\n  } else if (mouseDown && mouseDown.mightDrag) {\n    view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, mouseDown.mightDrag.pos)))\n  } else if (e.target && e.target.nodeType == 1) {\n    let desc = view.docView.nearestDesc(e.target, true)\n    if (!desc || !desc.node.type.spec.draggable || desc == view.docView) return\n    view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, desc.posBefore)))\n  }\n  let slice = view.state.selection.content(), {dom, text} = serializeForClipboard(view, slice)\n  e.dataTransfer.clearData()\n  e.dataTransfer.setData(brokenClipboardAPI ? \"Text\" : \"text/html\", dom.innerHTML)\n  if (!brokenClipboardAPI) e.dataTransfer.setData(\"text/plain\", text)\n  view.dragging = new Dragging(slice, !e[dragCopyModifier])\n}\n\nhandlers.dragend = view => {\n  window.setTimeout(() => view.dragging = null, 50)\n}\n\neditHandlers.dragover = editHandlers.dragenter = (_, e) => e.preventDefault()\n\neditHandlers.drop = (view, e) => {\n  let dragging = view.dragging\n  view.dragging = null\n\n  if (!e.dataTransfer) return\n\n  let eventPos = view.posAtCoords(eventCoords(e))\n  if (!eventPos) return\n  let $mouse = view.state.doc.resolve(eventPos.pos)\n  if (!$mouse) return\n  let slice = dragging && dragging.slice ||\n      parseFromClipboard(view, e.dataTransfer.getData(brokenClipboardAPI ? \"Text\" : \"text/plain\"),\n                         brokenClipboardAPI ? null : e.dataTransfer.getData(\"text/html\"), false, $mouse)\n  if (view.someProp(\"handleDrop\", f => f(view, e, slice || Slice.empty, dragging && dragging.move))) {\n    e.preventDefault()\n    return\n  }\n  if (!slice) return\n\n  e.preventDefault()\n  let insertPos = slice ? dropPoint(view.state.doc, $mouse.pos, slice) : $mouse.pos\n  if (insertPos == null) insertPos = $mouse.pos\n\n  let tr = view.state.tr\n  if (dragging && dragging.move) tr.deleteSelection()\n\n  let pos = tr.mapping.map(insertPos)\n  let isNode = slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1\n  let beforeInsert = tr.doc\n  if (isNode)\n    tr.replaceRangeWith(pos, pos, slice.content.firstChild)\n  else\n    tr.replaceRange(pos, pos, slice)\n  if (tr.doc.eq(beforeInsert)) return\n\n  let $pos = tr.doc.resolve(pos)\n  if (isNode && NodeSelection.isSelectable(slice.content.firstChild) &&\n      $pos.nodeAfter && $pos.nodeAfter.sameMarkup(slice.content.firstChild))\n    tr.setSelection(new NodeSelection($pos))\n  else\n    tr.setSelection(selectionBetween(view, $pos, tr.doc.resolve(tr.mapping.map(insertPos))))\n  view.focus()\n  view.dispatch(tr.setMeta(\"uiEvent\", \"drop\"))\n}\n\nhandlers.focus = view => {\n  if (!view.focused) {\n    view.domObserver.stop()\n    view.dom.classList.add(\"ProseMirror-focused\")\n    view.domObserver.start()\n    view.focused = true\n    setTimeout(() => {\n      if (view.docView && view.hasFocus() && !view.domObserver.currentSelection.eq(view.root.getSelection()))\n        selectionToDOM(view)\n    }, 20)\n  }\n}\n\nhandlers.blur = view => {\n  if (view.focused) {\n    view.domObserver.stop()\n    view.dom.classList.remove(\"ProseMirror-focused\")\n    view.domObserver.start()\n    view.domObserver.currentSelection.set({})\n    view.focused = false\n  }\n}\n\nhandlers.beforeinput = (view, event) => {\n  // We should probably do more with beforeinput events, but support\n  // is so spotty that I'm still waiting to see where they are going.\n\n  // Very specific hack to deal with backspace sometimes failing on\n  // Chrome Android when after an uneditable node.\n  if (browser.chrome && browser.android && event.inputType == \"deleteContentBackward\") {\n    let {domChangeCount} = view\n    setTimeout(() => {\n      if (view.domChangeCount != domChangeCount) return // Event already had some effect\n      // This bug tends to close the virtual keyboard, so we refocus\n      view.dom.blur()\n      view.focus()\n      if (view.someProp(\"handleKeyDown\", f => f(view, keyEvent(8, \"Backspace\")))) return\n      let {$cursor} = view.state.selection\n      // Crude approximation of backspace behavior when no command handled it\n      if ($cursor && $cursor.pos > 0) view.dispatch(view.state.tr.delete($cursor.pos - 1, $cursor.pos).scrollIntoView())\n    }, 50)\n  }\n}\n\n// Make sure all handlers get registered\nfor (let prop in editHandlers) handlers[prop] = editHandlers[prop]\n","function compareObjs(a, b) {\n  if (a == b) return true\n  for (let p in a) if (a[p] !== b[p]) return false\n  for (let p in b) if (!(p in a)) return false\n  return true\n}\n\nclass WidgetType {\n  constructor(toDOM, spec) {\n    this.spec = spec || noSpec\n    this.side = this.spec.side || 0\n    this.toDOM = toDOM\n  }\n\n  map(mapping, span, offset, oldOffset) {\n    let {pos, deleted} = mapping.mapResult(span.from + oldOffset, this.side < 0 ? -1 : 1)\n    return deleted ? null : new Decoration(pos - offset, pos - offset, this)\n  }\n\n  valid() { return true }\n\n  eq(other) {\n    return this == other ||\n      (other instanceof WidgetType &&\n       (this.spec.key && this.spec.key == other.spec.key ||\n        this.toDOM == other.toDOM && compareObjs(this.spec, other.spec)))\n  }\n}\n\nclass InlineType {\n  constructor(attrs, spec) {\n    this.spec = spec || noSpec\n    this.attrs = attrs\n  }\n\n  map(mapping, span, offset, oldOffset) {\n    let from = mapping.map(span.from + oldOffset, this.spec.inclusiveStart ? -1 : 1) - offset\n    let to = mapping.map(span.to + oldOffset, this.spec.inclusiveEnd ? 1 : -1) - offset\n    return from >= to ? null : new Decoration(from, to, this)\n  }\n\n  valid(_, span) { return span.from < span.to }\n\n  eq(other) {\n    return this == other ||\n      (other instanceof InlineType && compareObjs(this.attrs, other.attrs) &&\n       compareObjs(this.spec, other.spec))\n  }\n\n  static is(span) { return span.type instanceof InlineType }\n}\n\nclass NodeType {\n  constructor(attrs, spec) {\n    this.spec = spec || noSpec\n    this.attrs = attrs\n  }\n\n  map(mapping, span, offset, oldOffset) {\n    let from = mapping.mapResult(span.from + oldOffset, 1)\n    if (from.deleted) return null\n    let to = mapping.mapResult(span.to + oldOffset, -1)\n    if (to.deleted || to.pos <= from.pos) return null\n    return new Decoration(from.pos - offset, to.pos - offset, this)\n  }\n\n  valid(node, span) {\n    let {index, offset} = node.content.findIndex(span.from)\n    return offset == span.from && offset + node.child(index).nodeSize == span.to\n  }\n\n  eq(other) {\n    return this == other ||\n      (other instanceof NodeType && compareObjs(this.attrs, other.attrs) &&\n       compareObjs(this.spec, other.spec))\n  }\n}\n\n// ::- Decoration objects can be provided to the view through the\n// [`decorations` prop](#view.EditorProps.decorations). They come in\n// several variantssee the static members of this class for details.\nexport class Decoration {\n  constructor(from, to, type) {\n    // :: number\n    // The start position of the decoration.\n    this.from = from\n    // :: number\n    // The end position. Will be the same as `from` for [widget\n    // decorations](#view.Decoration^widget).\n    this.to = to\n    this.type = type\n  }\n\n  copy(from, to) {\n    return new Decoration(from, to, this.type)\n  }\n\n  eq(other, offset = 0) {\n    return this.type.eq(other.type) && this.from + offset == other.from && this.to + offset == other.to\n  }\n\n  map(mapping, offset, oldOffset) {\n    return this.type.map(mapping, this, offset, oldOffset)\n  }\n\n  // :: (number, union<(view: EditorView, getPos: ()  number)  dom.Node, dom.Node>, ?Object)  Decoration\n  // Creates a widget decoration, which is a DOM node that's shown in\n  // the document at the given position. It is recommended that you\n  // delay rendering the widget by passing a function that will be\n  // called when the widget is actually drawn in a view, but you can\n  // also directly pass a DOM node. `getPos` can be used to find the\n  // widget's current document position.\n  //\n  //   spec::- These options are supported:\n  //\n  //     side:: ?number\n  //     Controls which side of the document position this widget is\n  //     associated with. When negative, it is drawn before a cursor\n  //     at its position, and content inserted at that position ends\n  //     up after the widget. When zero (the default) or positive, the\n  //     widget is drawn after the cursor and content inserted there\n  //     ends up before the widget.\n  //\n  //     When there are multiple widgets at a given position, their\n  //     `side` values determine the order in which they appear. Those\n  //     with lower values appear first. The ordering of widgets with\n  //     the same `side` value is unspecified.\n  //\n  //     When `marks` is null, `side` also determines the marks that\n  //     the widget is wrapped inthose of the node before when\n  //     negative, those of the node after when positive.\n  //\n  //     marks:: ?[Mark]\n  //     The precise set of marks to draw around the widget.\n  //\n  //     stopEvent:: ?(event: dom.Event)  bool\n  //     Can be used to control which DOM events, when they bubble out\n  //     of this widget, the editor view should ignore.\n  //\n  //     ignoreSelection:: ?bool\n  //     When set (defaults to false), selection changes inside the\n  //     widget are ignored, and don't cause ProseMirror to try and\n  //     re-sync the selection with its selection state.\n  //\n  //     key:: ?string\n  //     When comparing decorations of this type (in order to decide\n  //     whether it needs to be redrawn), ProseMirror will by default\n  //     compare the widget DOM node by identity. If you pass a key,\n  //     that key will be compared instead, which can be useful when\n  //     you generate decorations on the fly and don't want to store\n  //     and reuse DOM nodes. Make sure that any widgets with the same\n  //     key are interchangeableif widgets differ in, for example,\n  //     the behavior of some event handler, they should get\n  //     different keys.\n  static widget(pos, toDOM, spec) {\n    return new Decoration(pos, pos, new WidgetType(toDOM, spec))\n  }\n\n  // :: (number, number, DecorationAttrs, ?Object)  Decoration\n  // Creates an inline decoration, which adds the given attributes to\n  // each inline node between `from` and `to`.\n  //\n  //   spec::- These options are recognized:\n  //\n  //     inclusiveStart:: ?bool\n  //     Determines how the left side of the decoration is\n  //     [mapped](#transform.Position_Mapping) when content is\n  //     inserted directly at that position. By default, the decoration\n  //     won't include the new content, but you can set this to `true`\n  //     to make it inclusive.\n  //\n  //     inclusiveEnd:: ?bool\n  //     Determines how the right side of the decoration is mapped.\n  //     See\n  //     [`inclusiveStart`](#view.Decoration^inline^spec.inclusiveStart).\n  static inline(from, to, attrs, spec) {\n    return new Decoration(from, to, new InlineType(attrs, spec))\n  }\n\n  // :: (number, number, DecorationAttrs, ?Object)  Decoration\n  // Creates a node decoration. `from` and `to` should point precisely\n  // before and after a node in the document. That node, and only that\n  // node, will receive the given attributes.\n  //\n  //   spec::-\n  //\n  //   Optional information to store with the decoration. It\n  //   is also used when comparing decorators for equality.\n  static node(from, to, attrs, spec) {\n    return new Decoration(from, to, new NodeType(attrs, spec))\n  }\n\n  // :: Object\n  // The spec provided when creating this decoration. Can be useful\n  // if you've stored extra information in that object.\n  get spec() { return this.type.spec }\n}\n\n// DecorationAttrs:: interface\n// A set of attributes to add to a decorated node. Most properties\n// simply directly correspond to DOM attributes of the same name,\n// which will be set to the property's value. These are exceptions:\n//\n//   class:: ?string\n//   A CSS class name or a space-separated set of class names to be\n//   _added_ to the classes that the node already had.\n//\n//   style:: ?string\n//   A string of CSS to be _added_ to the node's existing `style` property.\n//\n//   nodeName:: ?string\n//   When non-null, the target node is wrapped in a DOM element of\n//   this type (and the other attributes are applied to this element).\n\nconst none = [], noSpec = {}\n\n// ::- A collection of [decorations](#view.Decoration), organized in\n// such a way that the drawing algorithm can efficiently use and\n// compare them. This is a persistent data structureit is not\n// modified, updates create a new value.\nexport class DecorationSet {\n  constructor(local, children) {\n    this.local = local && local.length ? local : none\n    this.children = children && children.length ? children : none\n  }\n\n  // :: (Node, [Decoration])  DecorationSet\n  // Create a set of decorations, using the structure of the given\n  // document.\n  static create(doc, decorations) {\n    return decorations.length ? buildTree(decorations, doc, 0, noSpec) : empty\n  }\n\n  // :: (?number, ?number, ?(spec: Object)  bool)  [Decoration]\n  // Find all decorations in this set which touch the given range\n  // (including decorations that start or end directly at the\n  // boundaries) and match the given predicate on their spec. When\n  // `start` and `end` are omitted, all decorations in the set are\n  // considered. When `predicate` isn't given, all decorations are\n  // assumed to match.\n  find(start, end, predicate) {\n    let result = []\n    this.findInner(start == null ? 0 : start, end == null ? 1e9 : end, result, 0, predicate)\n    return result\n  }\n\n  findInner(start, end, result, offset, predicate) {\n    for (let i = 0; i < this.local.length; i++) {\n      let span = this.local[i]\n      if (span.from <= end && span.to >= start && (!predicate || predicate(span.spec)))\n        result.push(span.copy(span.from + offset, span.to + offset))\n    }\n    for (let i = 0; i < this.children.length; i += 3) {\n      if (this.children[i] < end && this.children[i + 1] > start) {\n        let childOff = this.children[i] + 1\n        this.children[i + 2].findInner(start - childOff, end - childOff, result, offset + childOff, predicate)\n      }\n    }\n  }\n\n  // :: (Mapping, Node, ?Object)  DecorationSet\n  // Map the set of decorations in response to a change in the\n  // document.\n  //\n  //   options::- An optional set of options.\n  //\n  //     onRemove:: ?(decorationSpec: Object)\n  //     When given, this function will be called for each decoration\n  //     that gets dropped as a result of the mapping, passing the\n  //     spec of that decoration.\n  map(mapping, doc, options) {\n    if (this == empty || mapping.maps.length == 0) return this\n    return this.mapInner(mapping, doc, 0, 0, options || noSpec)\n  }\n\n  mapInner(mapping, node, offset, oldOffset, options) {\n    let newLocal\n    for (let i = 0; i < this.local.length; i++) {\n      let mapped = this.local[i].map(mapping, offset, oldOffset)\n      if (mapped && mapped.type.valid(node, mapped)) (newLocal || (newLocal = [])).push(mapped)\n      else if (options.onRemove) options.onRemove(this.local[i].spec)\n    }\n\n    if (this.children.length)\n      return mapChildren(this.children, newLocal, mapping, node, offset, oldOffset, options)\n    else\n      return newLocal ? new DecorationSet(newLocal.sort(byPos)) : empty\n  }\n\n  // :: (Node, [Decoration])  DecorationSet\n  // Add the given array of decorations to the ones in the set,\n  // producing a new set. Needs access to the current document to\n  // create the appropriate tree structure.\n  add(doc, decorations) {\n    if (!decorations.length) return this\n    if (this == empty) return DecorationSet.create(doc, decorations)\n    return this.addInner(doc, decorations, 0)\n  }\n\n  addInner(doc, decorations, offset) {\n    let children, childIndex = 0\n    doc.forEach((childNode, childOffset) => {\n      let baseOffset = childOffset + offset, found\n      if (!(found = takeSpansForNode(decorations, childNode, baseOffset))) return\n\n      if (!children) children = this.children.slice()\n      while (childIndex < children.length && children[childIndex] < childOffset) childIndex += 3\n      if (children[childIndex] == childOffset)\n        children[childIndex + 2] = children[childIndex + 2].addInner(childNode, found, baseOffset + 1)\n      else\n        children.splice(childIndex, 0, childOffset, childOffset + childNode.nodeSize, buildTree(found, childNode, baseOffset + 1, noSpec))\n      childIndex += 3\n    })\n\n    let local = moveSpans(childIndex ? withoutNulls(decorations) : decorations, -offset)\n    return new DecorationSet(local.length ? this.local.concat(local).sort(byPos) : this.local,\n                             children || this.children)\n  }\n\n  // :: ([Decoration])  DecorationSet\n  // Create a new set that contains the decorations in this set, minus\n  // the ones in the given array.\n  remove(decorations) {\n    if (decorations.length == 0 || this == empty) return this\n    return this.removeInner(decorations, 0)\n  }\n\n  removeInner(decorations, offset) {\n    let children = this.children, local = this.local\n    for (let i = 0; i < children.length; i += 3) {\n      let found, from = children[i] + offset, to = children[i + 1] + offset\n      for (let j = 0, span; j < decorations.length; j++) if (span = decorations[j]) {\n        if (span.from > from && span.to < to) {\n          decorations[j] = null\n          ;(found || (found = [])).push(span)\n        }\n      }\n      if (!found) continue\n      if (children == this.children) children = this.children.slice()\n      let removed = children[i + 2].removeInner(found, from + 1)\n      if (removed != empty) {\n        children[i + 2] = removed\n      } else {\n        children.splice(i, 3)\n        i -= 3\n      }\n    }\n    if (local.length) for (let i = 0, span; i < decorations.length; i++) if (span = decorations[i]) {\n      for (let j = 0; j < local.length; j++) if (local[j].eq(span, offset)) {\n        if (local == this.local) local = this.local.slice()\n        local.splice(j--, 1)\n      }\n    }\n    if (children == this.children && local == this.local) return this\n    return local.length || children.length ? new DecorationSet(local, children) : empty\n  }\n\n  forChild(offset, node) {\n    if (this == empty) return this\n    if (node.isLeaf) return DecorationSet.empty\n\n    let child, local\n    for (let i = 0; i < this.children.length; i += 3) if (this.children[i] >= offset) {\n      if (this.children[i] == offset) child = this.children[i + 2]\n      break\n    }\n    let start = offset + 1, end = start + node.content.size\n    for (let i = 0; i < this.local.length; i++) {\n      let dec = this.local[i]\n      if (dec.from < end && dec.to > start && (dec.type instanceof InlineType)) {\n        let from = Math.max(start, dec.from) - start, to = Math.min(end, dec.to) - start\n        if (from < to) (local || (local = [])).push(dec.copy(from, to))\n      }\n    }\n    if (local) {\n      let localSet = new DecorationSet(local.sort(byPos))\n      return child ? new DecorationGroup([localSet, child]) : localSet\n    }\n    return child || empty\n  }\n\n  eq(other) {\n    if (this == other) return true\n    if (!(other instanceof DecorationSet) ||\n        this.local.length != other.local.length ||\n        this.children.length != other.children.length) return false\n    for (let i = 0; i < this.local.length; i++)\n      if (!this.local[i].eq(other.local[i])) return false\n    for (let i = 0; i < this.children.length; i += 3)\n      if (this.children[i] != other.children[i] ||\n          this.children[i + 1] != other.children[i + 1] ||\n          !this.children[i + 2].eq(other.children[i + 2])) return false\n    return true\n  }\n\n  locals(node) {\n    return removeOverlap(this.localsInner(node))\n  }\n\n  localsInner(node) {\n    if (this == empty) return none\n    if (node.inlineContent || !this.local.some(InlineType.is)) return this.local\n    let result = []\n    for (let i = 0; i < this.local.length; i++) {\n      if (!(this.local[i].type instanceof InlineType))\n        result.push(this.local[i])\n    }\n    return result\n  }\n}\n\nconst empty = new DecorationSet()\n\n// :: DecorationSet\n// The empty set of decorations.\nDecorationSet.empty = empty\n\nDecorationSet.removeOverlap = removeOverlap\n\n// :- An abstraction that allows the code dealing with decorations to\n// treat multiple DecorationSet objects as if it were a single object\n// with (a subset of) the same interface.\nclass DecorationGroup {\n  constructor(members) {\n    this.members = members\n  }\n\n  forChild(offset, child) {\n    if (child.isLeaf) return DecorationSet.empty\n    let found = []\n    for (let i = 0; i < this.members.length; i++) {\n      let result = this.members[i].forChild(offset, child)\n      if (result == empty) continue\n      if (result instanceof DecorationGroup) found = found.concat(result.members)\n      else found.push(result)\n    }\n    return DecorationGroup.from(found)\n  }\n\n  eq(other) {\n    if (!(other instanceof DecorationGroup) ||\n        other.members.length != this.members.length) return false\n    for (let i = 0; i < this.members.length; i++)\n      if (!this.members[i].eq(other.members[i])) return false\n    return true\n  }\n\n  locals(node) {\n    let result, sorted = true\n    for (let i = 0; i < this.members.length; i++) {\n      let locals = this.members[i].localsInner(node)\n      if (!locals.length) continue\n      if (!result) {\n        result = locals\n      } else {\n        if (sorted) {\n          result = result.slice()\n          sorted = false\n        }\n        for (let j = 0; j < locals.length; j++) result.push(locals[j])\n      }\n    }\n    return result ? removeOverlap(sorted ? result : result.sort(byPos)) : none\n  }\n\n  // : ([DecorationSet])  union<DecorationSet, DecorationGroup>\n  // Create a group for the given array of decoration sets, or return\n  // a single set when possible.\n  static from(members) {\n    switch (members.length) {\n      case 0: return empty\n      case 1: return members[0]\n      default: return new DecorationGroup(members)\n    }\n  }\n}\n\nfunction mapChildren(oldChildren, newLocal, mapping, node, offset, oldOffset, options) {\n  let children = oldChildren.slice()\n\n  // Mark the children that are directly touched by changes, and\n  // move those that are after the changes.\n  let shift = (oldStart, oldEnd, newStart, newEnd) => {\n    for (let i = 0; i < children.length; i += 3) {\n      let end = children[i + 1], dSize\n      if (end == -1 || oldStart > end + oldOffset) continue\n      if (oldEnd >= children[i] + oldOffset) {\n        children[i + 1] = -1\n      } else if (newStart >= offset && (dSize = (newEnd - newStart) - (oldEnd - oldStart))) {\n        children[i] += dSize\n        children[i + 1] += dSize\n      }\n    }\n  }\n  for (let i = 0; i < mapping.maps.length; i++) mapping.maps[i].forEach(shift)\n\n  // Find the child nodes that still correspond to a single node,\n  // recursively call mapInner on them and update their positions.\n  let mustRebuild = false\n  for (let i = 0; i < children.length; i += 3) if (children[i + 1] == -1) { // Touched nodes\n    let from = mapping.map(children[i] + oldOffset), fromLocal = from - offset\n    if (fromLocal < 0 || fromLocal >= node.content.size) {\n      mustRebuild = true\n      continue\n    }\n    // Must read oldChildren because children was tagged with -1\n    let to = mapping.map(oldChildren[i + 1] + oldOffset, -1), toLocal = to - offset\n    let {index, offset: childOffset} = node.content.findIndex(fromLocal)\n    let childNode = node.maybeChild(index)\n    if (childNode && childOffset == fromLocal && childOffset + childNode.nodeSize == toLocal) {\n      let mapped = children[i + 2].mapInner(mapping, childNode, from + 1, children[i] + oldOffset + 1, options)\n      if (mapped != empty) {\n        children[i] = fromLocal\n        children[i + 1] = toLocal\n        children[i + 2] = mapped\n      } else {\n        children[i + 1] = -2\n        mustRebuild = true\n      }\n    } else {\n      mustRebuild = true\n    }\n  }\n\n  // Remaining children must be collected and rebuilt into the appropriate structure\n  if (mustRebuild) {\n    let decorations = mapAndGatherRemainingDecorations(children, oldChildren, newLocal || [], mapping,\n                                                       offset, oldOffset, options)\n    let built = buildTree(decorations, node, 0, options)\n    newLocal = built.local\n    for (let i = 0; i < children.length; i += 3) if (children[i + 1] < 0) {\n      children.splice(i, 3)\n      i -= 3\n    }\n    for (let i = 0, j = 0; i < built.children.length; i += 3) {\n      let from = built.children[i]\n      while (j < children.length && children[j] < from) j += 3\n      children.splice(j, 0, built.children[i], built.children[i + 1], built.children[i + 2])\n    }\n  }\n\n  return new DecorationSet(newLocal && newLocal.sort(byPos), children)\n}\n\nfunction moveSpans(spans, offset) {\n  if (!offset || !spans.length) return spans\n  let result = []\n  for (let i = 0; i < spans.length; i++) {\n    let span = spans[i]\n    result.push(new Decoration(span.from + offset, span.to + offset, span.type))\n  }\n  return result\n}\n\nfunction mapAndGatherRemainingDecorations(children, oldChildren, decorations, mapping, offset, oldOffset, options) {\n  // Gather all decorations from the remaining marked children\n  function gather(set, oldOffset) {\n    for (let i = 0; i < set.local.length; i++) {\n      let mapped = set.local[i].map(mapping, offset, oldOffset)\n      if (mapped) decorations.push(mapped)\n      else if (options.onRemove) options.onRemove(set.local[i].spec)\n    }\n    for (let i = 0; i < set.children.length; i += 3)\n      gather(set.children[i + 2], set.children[i] + oldOffset + 1)\n  }\n  for (let i = 0; i < children.length; i += 3) if (children[i + 1] == -1)\n    gather(children[i + 2], oldChildren[i] + oldOffset + 1)\n\n  return decorations\n}\n\nfunction takeSpansForNode(spans, node, offset) {\n  if (node.isLeaf) return null\n  let end = offset + node.nodeSize, found = null\n  for (let i = 0, span; i < spans.length; i++) {\n    if ((span = spans[i]) && span.from > offset && span.to < end) {\n      ;(found || (found = [])).push(span)\n      spans[i] = null\n    }\n  }\n  return found\n}\n\nfunction withoutNulls(array) {\n  let result = []\n  for (let i = 0; i < array.length; i++)\n    if (array[i] != null) result.push(array[i])\n  return result\n}\n\n// : ([Decoration], Node, number)  DecorationSet\n// Build up a tree that corresponds to a set of decorations. `offset`\n// is a base offset that should be subtractet from the `from` and `to`\n// positions in the spans (so that we don't have to allocate new spans\n// for recursive calls).\nfunction buildTree(spans, node, offset, options) {\n  let children = [], hasNulls = false\n  node.forEach((childNode, localStart) => {\n    let found = takeSpansForNode(spans, childNode, localStart + offset)\n    if (found) {\n      hasNulls = true\n      let subtree = buildTree(found, childNode, offset + localStart + 1, options)\n      if (subtree != empty)\n        children.push(localStart, localStart + childNode.nodeSize, subtree)\n    }\n  })\n  let locals = moveSpans(hasNulls ? withoutNulls(spans) : spans, -offset).sort(byPos)\n  for (let i = 0; i < locals.length; i++) if (!locals[i].type.valid(node, locals[i])) {\n    if (options.onRemove) options.onRemove(locals[i].spec)\n    locals.splice(i--, 1)\n  }\n  return locals.length || children.length ? new DecorationSet(locals, children) : empty\n}\n\n// : (Decoration, Decoration)  number\n// Used to sort decorations so that ones with a low start position\n// come first, and within a set with the same start position, those\n// with an smaller end position come first.\nfunction byPos(a, b) {\n  return a.from - b.from || a.to - b.to\n}\n\n// : ([Decoration])  [Decoration]\n// Scan a sorted array of decorations for partially overlapping spans,\n// and split those so that only fully overlapping spans are left (to\n// make subsequent rendering easier). Will return the input array if\n// no partially overlapping spans are found (the common case).\nfunction removeOverlap(spans) {\n  let working = spans\n  for (let i = 0; i < working.length - 1; i++) {\n    let span = working[i]\n    if (span.from != span.to) for (let j = i + 1; j < working.length; j++) {\n      let next = working[j]\n      if (next.from == span.from) {\n        if (next.to != span.to) {\n          if (working == spans) working = spans.slice()\n          // Followed by a partially overlapping larger span. Split that\n          // span.\n          working[j] = next.copy(next.from, span.to)\n          insertAhead(working, j + 1, next.copy(span.to, next.to))\n        }\n        continue\n      } else {\n        if (next.from < span.to) {\n          if (working == spans) working = spans.slice()\n          // The end of this one overlaps with a subsequent span. Split\n          // this one.\n          working[i] = span.copy(span.from, next.from)\n          insertAhead(working, j, span.copy(next.from, span.to))\n        }\n        break\n      }\n    }\n  }\n  return working\n}\n\nfunction insertAhead(array, i, deco) {\n  while (i < array.length && byPos(deco, array[i]) > 0) i++\n  array.splice(i, 0, deco)\n}\n\n// : (EditorView)  union<DecorationSet, DecorationGroup>\n// Get the decorations associated with the current props of a view.\nexport function viewDecorations(view) {\n  let found = []\n  view.someProp(\"decorations\", f => {\n    let result = f(view.state)\n    if (result && result != empty) found.push(result)\n  })\n  if (view.cursorWrapper)\n    found.push(DecorationSet.create(view.state.doc, [view.cursorWrapper.deco]))\n  return DecorationGroup.from(found)\n}\n","import { Schema, DOMParser } from \"prosemirror-model\";\nimport { EditorState, Plugin, PluginKey, Selection } from \"prosemirror-state\";\nimport { EditorView, DecorationSet, Decoration } from \"prosemirror-view\";\nimport { exampleSetup } from \"prosemirror-example-setup\";\n\nimport \"prosemirror-view/style/prosemirror.css\";\nimport \"prosemirror-example-setup/style/style.css\";\nimport \"./styles.css\";\n\nconst schema = new Schema({\n  marks: {\n    example: {\n      parseDOM: [\n        {\n          tag: \"test-mark\",\n        },\n      ],\n      toDOM: (mark) => [\"span\", { class: \"test-mark\" }],\n    },\n  },\n  nodes: {\n    doc: {\n      content: \"block+\",\n    },\n    paragraph: {\n      group: \"block\",\n      content: \"inline*\",\n      parseDOM: [{ tag: \"p\" }],\n      toDOM: () => [\"p\", 0],\n    },\n    text: {\n      group: \"inline\",\n    },\n  },\n});\n\nconst testDecoToDom = (decoClass, side) => (view, getPos) => {\n  const el = document.createElement(\"span\");\n  el.classList.add(decoClass, \"test-deco\");\n  el.innerHTML = \" \"\n  side <= 0 ? el.style.paddingLeft = '20px' : el.style.paddingRight = '20px'\n  return el;\n};\n\nconst pluginKey = new PluginKey(\"side-test-plugin\");\n\nconst noOfDecos = 3;\nconst decoStartPos = 6;\nconst MODIFY_OFFSET = \"MODIFY_OFFSET\";\nconst DECREMENT_OFFSET = \"DECREMENT\";\nconst INCREMENT_OFFSET = \"INCREMENT\";\n\nconst getSide = (cursorPos, offset, index) =>\n  cursorPos === decoStartPos && offset > index ? -1 : 1;\n\nconst createPluginDecorations = (state, decoClass, index) => {\n  const decos = new Array(noOfDecos).fill(undefined).map((_, index) => {\n    const { offset } = pluginKey.getState(state);\n    const orderOffset = (index + 1) / noOfDecos / 2;\n    const {\n      selection: { from, to },\n    } = state;\n    const isRange = from !== to;\n    const side = isRange ? orderOffset : getSide(from, offset, index);\n    const relativeSide = side + orderOffset;\n    return Decoration.widget(decoStartPos, testDecoToDom(decoClass, relativeSide), {\n      key: Math.random(),\n      side: relativeSide,\n      ignoreSelection: true\n    });\n  });\n\n  // For debugging purposes, to make the decoration sides visible\n  document.getElementById(\n    getDebugId(index)\n  ).innerHTML = `Widget 'side' properties, in render order: ${decos\n    .map((_) => _.spec.side.toString().substring(0, 6))\n    .join(\", \")}`;\n\n  return DecorationSet.create(state.doc, decos);\n};\n\nconst createPlugin = (decoClass, index) =>\n  new Plugin({\n    key: pluginKey,\n    props: {\n      decorations: (state) => createPluginDecorations(state, decoClass, index),\n    },\n    state: {\n      init: (_, state) => {\n        return { offset: 0 };\n      },\n      apply: (tr, plState, oldState, newState) => {\n        const { offset } = plState;\n        const modifyOffset = tr.getMeta(MODIFY_OFFSET);\n        if (!modifyOffset) {\n          return plState;\n        }\n        return {\n          offset: modifyOffset === INCREMENT_OFFSET ? offset + 1 : offset - 1,\n        };\n      },\n    },\n    appendTransaction: (trs, oldState, newState) => {\n      const { offset } = pluginKey.getState(newState);\n      const {\n        selection: { $cursor: $oldCursor },\n      } = oldState;\n      const {\n        selection: { $cursor },\n      } = newState;\n      if (!$cursor || !$oldCursor) {\n        return;\n      }\n      const movement = $cursor.pos - $oldCursor.pos;\n      if (\n        // Haven't moved\n        movement === 0 ||\n        // Just moved into deco position\n        $oldCursor.pos !== decoStartPos\n      ) {\n        return;\n      }\n      if (\n        (movement > 0 && offset < noOfDecos) ||\n        (movement < 0 && offset > 0)\n      ) {\n        const modifyOffset = movement > 0 ? INCREMENT_OFFSET : DECREMENT_OFFSET;\n        const tr = newState.tr\n          .setMeta(MODIFY_OFFSET, modifyOffset)\n          .setSelection(Selection.near(oldState.selection.$cursor));\n        return tr;\n      }\n      return;\n    },\n  });\n\nconst createStateFromContent = (content, decoClass, index) => {\n  const plugin = createPlugin(decoClass, index);\n  return EditorState.create({\n    doc: DOMParser.fromSchema(schema).parse(content),\n    plugins: [...exampleSetup({ schema, menuBar: false }), plugin],\n  });\n};\n\nconst getDebugId = (decoClass) => `debug-${decoClass}`;\n\nconst examples = [\n  [\n    \"Example with decorations only, inline\",\n    \"<p>An example document</p>\",\n    \"test-deco-inline\",\n  ],\n  [\n    \"Example with decorations only, inline-block\",\n    \"<p>An example document</p>\",\n    \"test-deco-inline-block\",\n  ],\n  [\n    \"Example with decorations and mark, inline\",\n    \"<p><test-mark>An ex</test-mark>ample document</p>\",\n    \"test-deco-inline\",\n  ],\n  [\n    \"Example with decorations and mark, inline-block\",\n    \"<p><test-mark>An ex</test-mark>ample document</p>\",\n    \"test-deco-inline-block\",\n  ],\n];\n\nconst root = document.getElementById(\"root\");\n\nexamples.forEach(([description, content, decoClass], index) => {\n  const docRootEl = document.createElement(\"div\");\n  docRootEl.classList.add(\"doc-root\");\n\n  const descriptionEl = document.createElement(\"div\");\n  descriptionEl.innerText = description;\n  descriptionEl.classList.add(\"description\");\n\n  const contentEl = document.createElement(\"div\");\n  contentEl.innerHTML = content;\n\n  const debugEl = document.createElement(\"div\");\n  debugEl.id = getDebugId(index);\n  debugEl.classList.add(\"debug\")\n\n  root.appendChild(descriptionEl);\n  root.appendChild(docRootEl);\n  root.appendChild(debugEl);\n\n  const state = createStateFromContent(contentEl, decoClass, index);\n\n  new EditorView(docRootEl, {\n    state,\n  });\n});\n","export var base = {\n  8: \"Backspace\",\n  9: \"Tab\",\n  10: \"Enter\",\n  12: \"NumLock\",\n  13: \"Enter\",\n  16: \"Shift\",\n  17: \"Control\",\n  18: \"Alt\",\n  20: \"CapsLock\",\n  27: \"Escape\",\n  32: \" \",\n  33: \"PageUp\",\n  34: \"PageDown\",\n  35: \"End\",\n  36: \"Home\",\n  37: \"ArrowLeft\",\n  38: \"ArrowUp\",\n  39: \"ArrowRight\",\n  40: \"ArrowDown\",\n  44: \"PrintScreen\",\n  45: \"Insert\",\n  46: \"Delete\",\n  59: \";\",\n  61: \"=\",\n  91: \"Meta\",\n  92: \"Meta\",\n  106: \"*\",\n  107: \"+\",\n  108: \",\",\n  109: \"-\",\n  110: \".\",\n  111: \"/\",\n  144: \"NumLock\",\n  145: \"ScrollLock\",\n  160: \"Shift\",\n  161: \"Shift\",\n  162: \"Control\",\n  163: \"Control\",\n  164: \"Alt\",\n  165: \"Alt\",\n  173: \"-\",\n  186: \";\",\n  187: \"=\",\n  188: \",\",\n  189: \"-\",\n  190: \".\",\n  191: \"/\",\n  192: \"`\",\n  219: \"[\",\n  220: \"\\\\\",\n  221: \"]\",\n  222: \"'\",\n  229: \"q\"\n}\n\nexport var shift = {\n  48: \")\",\n  49: \"!\",\n  50: \"@\",\n  51: \"#\",\n  52: \"$\",\n  53: \"%\",\n  54: \"^\",\n  55: \"&\",\n  56: \"*\",\n  57: \"(\",\n  59: \":\",\n  61: \"+\",\n  173: \"_\",\n  186: \":\",\n  187: \"+\",\n  188: \"<\",\n  189: \"_\",\n  190: \">\",\n  191: \"?\",\n  192: \"~\",\n  219: \"{\",\n  220: \"|\",\n  221: \"}\",\n  222: \"\\\"\",\n  229: \"Q\"\n}\n\nvar chrome = typeof navigator != \"undefined\" && /Chrome\\/(\\d+)/.exec(navigator.userAgent)\nvar safari = typeof navigator != \"undefined\" && /Apple Computer/.test(navigator.vendor)\nvar gecko = typeof navigator != \"undefined\" && /Gecko\\/\\d+/.test(navigator.userAgent)\nvar mac = typeof navigator != \"undefined\" && /Mac/.test(navigator.platform)\nvar ie = typeof navigator != \"undefined\" && /MSIE \\d|Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent)\nvar brokenModifierNames = chrome && (mac || +chrome[1] < 57) || gecko && mac\n\n// Fill in the digit keys\nfor (var i = 0; i < 10; i++) base[48 + i] = base[96 + i] = String(i)\n\n// The function keys\nfor (var i = 1; i <= 24; i++) base[i + 111] = \"F\" + i\n\n// And the alphabetic keys\nfor (var i = 65; i <= 90; i++) {\n  base[i] = String.fromCharCode(i + 32)\n  shift[i] = String.fromCharCode(i)\n}\n\n// For each code that doesn't have a shift-equivalent, copy the base name\nfor (var code in base) if (!shift.hasOwnProperty(code)) shift[code] = base[code]\n\nexport function keyName(event) {\n  // Don't trust event.key in Chrome when there are modifiers until\n  // they fix https://bugs.chromium.org/p/chromium/issues/detail?id=633838\n  var ignoreKey = brokenModifierNames && (event.ctrlKey || event.altKey || event.metaKey) ||\n    (safari || ie) && event.shiftKey && event.key && event.key.length == 1\n  var name = (!ignoreKey && event.key) ||\n    (event.shiftKey ? shift : base)[event.keyCode] ||\n    event.key || \"Unidentified\"\n  // Edge sometimes produces wrong names (Issue #3)\n  if (name == \"Esc\") name = \"Escape\"\n  if (name == \"Del\") name = \"Delete\"\n  // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8860571/\n  if (name == \"Left\") name = \"ArrowLeft\"\n  if (name == \"Up\") name = \"ArrowUp\"\n  if (name == \"Right\") name = \"ArrowRight\"\n  if (name == \"Down\") name = \"ArrowDown\"\n  return name\n}\n","import {base, keyName} from \"w3c-keyname\"\nimport {Plugin} from \"prosemirror-state\"\n\n// declare global: navigator\n\nconst mac = typeof navigator != \"undefined\" ? /Mac/.test(navigator.platform) : false\n\nfunction normalizeKeyName(name) {\n  let parts = name.split(/-(?!$)/), result = parts[parts.length - 1]\n  if (result == \"Space\") result = \" \"\n  let alt, ctrl, shift, meta\n  for (let i = 0; i < parts.length - 1; i++) {\n    let mod = parts[i]\n    if (/^(cmd|meta|m)$/i.test(mod)) meta = true\n    else if (/^a(lt)?$/i.test(mod)) alt = true\n    else if (/^(c|ctrl|control)$/i.test(mod)) ctrl = true\n    else if (/^s(hift)?$/i.test(mod)) shift = true\n    else if (/^mod$/i.test(mod)) { if (mac) meta = true; else ctrl = true }\n    else throw new Error(\"Unrecognized modifier name: \" + mod)\n  }\n  if (alt) result = \"Alt-\" + result\n  if (ctrl) result = \"Ctrl-\" + result\n  if (meta) result = \"Meta-\" + result\n  if (shift) result = \"Shift-\" + result\n  return result\n}\n\nfunction normalize(map) {\n  let copy = Object.create(null)\n  for (let prop in map) copy[normalizeKeyName(prop)] = map[prop]\n  return copy\n}\n\nfunction modifiers(name, event, shift) {\n  if (event.altKey) name = \"Alt-\" + name\n  if (event.ctrlKey) name = \"Ctrl-\" + name\n  if (event.metaKey) name = \"Meta-\" + name\n  if (shift !== false && event.shiftKey) name = \"Shift-\" + name\n  return name\n}\n\n// :: (Object)  Plugin\n// Create a keymap plugin for the given set of bindings.\n//\n// Bindings should map key names to [command](#commands)-style\n// functions, which will be called with `(EditorState, dispatch,\n// EditorView)` arguments, and should return true when they've handled\n// the key. Note that the view argument isn't part of the command\n// protocol, but can be used as an escape hatch if a binding needs to\n// directly interact with the UI.\n//\n// Key names may be strings like `\"Shift-Ctrl-Enter\"`a key\n// identifier prefixed with zero or more modifiers. Key identifiers\n// are based on the strings that can appear in\n// [`KeyEvent.key`](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key).\n// Use lowercase letters to refer to letter keys (or uppercase letters\n// if you want shift to be held). You may use `\"Space\"` as an alias\n// for the `\" \"` name.\n//\n// Modifiers can be given in any order. `Shift-` (or `s-`), `Alt-` (or\n// `a-`), `Ctrl-` (or `c-` or `Control-`) and `Cmd-` (or `m-` or\n// `Meta-`) are recognized. For characters that are created by holding\n// shift, the `Shift-` prefix is implied, and should not be added\n// explicitly.\n//\n// You can use `Mod-` as a shorthand for `Cmd-` on Mac and `Ctrl-` on\n// other platforms.\n//\n// You can add multiple keymap plugins to an editor. The order in\n// which they appear determines their precedence (the ones early in\n// the array get to dispatch first).\nexport function keymap(bindings) {\n  return new Plugin({props: {handleKeyDown: keydownHandler(bindings)}})\n}\n\n// :: (Object)  (view: EditorView, event: dom.Event)  bool\n// Given a set of bindings (using the same format as\n// [`keymap`](#keymap.keymap), return a [keydown\n// handler](#view.EditorProps.handleKeyDown) that handles them.\nexport function keydownHandler(bindings) {\n  let map = normalize(bindings)\n  return function(view, event) {\n    let name = keyName(event), isChar = name.length == 1 && name != \" \", baseName\n    let direct = map[modifiers(name, event, !isChar)]\n    if (direct && direct(view.state, view.dispatch, view)) return true\n    if (isChar && (event.shiftKey || event.altKey || event.metaKey || name.charCodeAt(0) > 127) &&\n        (baseName = base[event.keyCode]) && baseName != name) {\n      // Try falling back to the keyCode when there's a modifier\n      // active or the character produced isn't ASCII, and our table\n      // produces a different name from the the keyCode. See #668,\n      // #1060\n      let fromCode = map[modifiers(baseName, event, true)]\n      if (fromCode && fromCode(view.state, view.dispatch, view)) return true\n    } else if (isChar && event.shiftKey) {\n      // Otherwise, if shift is active, also try the binding with the\n      // Shift- prefix enabled. See #997\n      let withShift = map[modifiers(name, event, true)]\n      if (withShift && withShift(view.state, view.dispatch, view)) return true\n    }\n    return false\n  }\n}\n","var GOOD_LEAF_SIZE = 200;\n\n// :: class<T> A rope sequence is a persistent sequence data structure\n// that supports appending, prepending, and slicing without doing a\n// full copy. It is represented as a mostly-balanced tree.\nvar RopeSequence = function RopeSequence () {};\n\nRopeSequence.prototype.append = function append (other) {\n  if (!other.length) { return this }\n  other = RopeSequence.from(other);\n\n  return (!this.length && other) ||\n    (other.length < GOOD_LEAF_SIZE && this.leafAppend(other)) ||\n    (this.length < GOOD_LEAF_SIZE && other.leafPrepend(this)) ||\n    this.appendInner(other)\n};\n\n// :: (union<[T], RopeSequence<T>>)  RopeSequence<T>\n// Prepend an array or other rope to this one, returning a new rope.\nRopeSequence.prototype.prepend = function prepend (other) {\n  if (!other.length) { return this }\n  return RopeSequence.from(other).append(this)\n};\n\nRopeSequence.prototype.appendInner = function appendInner (other) {\n  return new Append(this, other)\n};\n\n// :: (?number, ?number)  RopeSequence<T>\n// Create a rope repesenting a sub-sequence of this rope.\nRopeSequence.prototype.slice = function slice (from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  if (from >= to) { return RopeSequence.empty }\n  return this.sliceInner(Math.max(0, from), Math.min(this.length, to))\n};\n\n// :: (number)  T\n// Retrieve the element at the given position from this rope.\nRopeSequence.prototype.get = function get (i) {\n  if (i < 0 || i >= this.length) { return undefined }\n  return this.getInner(i)\n};\n\n// :: ((element: T, index: number)  ?bool, ?number, ?number)\n// Call the given function for each element between the given\n// indices. This tends to be more efficient than looping over the\n// indices and calling `get`, because it doesn't have to descend the\n// tree for every element.\nRopeSequence.prototype.forEach = function forEach (f, from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  if (from <= to)\n    { this.forEachInner(f, from, to, 0); }\n  else\n    { this.forEachInvertedInner(f, from, to, 0); }\n};\n\n// :: ((element: T, index: number)  U, ?number, ?number)  [U]\n// Map the given functions over the elements of the rope, producing\n// a flat array.\nRopeSequence.prototype.map = function map (f, from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  var result = [];\n  this.forEach(function (elt, i) { return result.push(f(elt, i)); }, from, to);\n  return result\n};\n\n// :: (?union<[T], RopeSequence<T>>)  RopeSequence<T>\n// Create a rope representing the given array, or return the rope\n// itself if a rope was given.\nRopeSequence.from = function from (values) {\n  if (values instanceof RopeSequence) { return values }\n  return values && values.length ? new Leaf(values) : RopeSequence.empty\n};\n\nvar Leaf = /*@__PURE__*/(function (RopeSequence) {\n  function Leaf(values) {\n    RopeSequence.call(this);\n    this.values = values;\n  }\n\n  if ( RopeSequence ) Leaf.__proto__ = RopeSequence;\n  Leaf.prototype = Object.create( RopeSequence && RopeSequence.prototype );\n  Leaf.prototype.constructor = Leaf;\n\n  var prototypeAccessors = { length: { configurable: true },depth: { configurable: true } };\n\n  Leaf.prototype.flatten = function flatten () {\n    return this.values\n  };\n\n  Leaf.prototype.sliceInner = function sliceInner (from, to) {\n    if (from == 0 && to == this.length) { return this }\n    return new Leaf(this.values.slice(from, to))\n  };\n\n  Leaf.prototype.getInner = function getInner (i) {\n    return this.values[i]\n  };\n\n  Leaf.prototype.forEachInner = function forEachInner (f, from, to, start) {\n    for (var i = from; i < to; i++)\n      { if (f(this.values[i], start + i) === false) { return false } }\n  };\n\n  Leaf.prototype.forEachInvertedInner = function forEachInvertedInner (f, from, to, start) {\n    for (var i = from - 1; i >= to; i--)\n      { if (f(this.values[i], start + i) === false) { return false } }\n  };\n\n  Leaf.prototype.leafAppend = function leafAppend (other) {\n    if (this.length + other.length <= GOOD_LEAF_SIZE)\n      { return new Leaf(this.values.concat(other.flatten())) }\n  };\n\n  Leaf.prototype.leafPrepend = function leafPrepend (other) {\n    if (this.length + other.length <= GOOD_LEAF_SIZE)\n      { return new Leaf(other.flatten().concat(this.values)) }\n  };\n\n  prototypeAccessors.length.get = function () { return this.values.length };\n\n  prototypeAccessors.depth.get = function () { return 0 };\n\n  Object.defineProperties( Leaf.prototype, prototypeAccessors );\n\n  return Leaf;\n}(RopeSequence));\n\n// :: RopeSequence\n// The empty rope sequence.\nRopeSequence.empty = new Leaf([]);\n\nvar Append = /*@__PURE__*/(function (RopeSequence) {\n  function Append(left, right) {\n    RopeSequence.call(this);\n    this.left = left;\n    this.right = right;\n    this.length = left.length + right.length;\n    this.depth = Math.max(left.depth, right.depth) + 1;\n  }\n\n  if ( RopeSequence ) Append.__proto__ = RopeSequence;\n  Append.prototype = Object.create( RopeSequence && RopeSequence.prototype );\n  Append.prototype.constructor = Append;\n\n  Append.prototype.flatten = function flatten () {\n    return this.left.flatten().concat(this.right.flatten())\n  };\n\n  Append.prototype.getInner = function getInner (i) {\n    return i < this.left.length ? this.left.get(i) : this.right.get(i - this.left.length)\n  };\n\n  Append.prototype.forEachInner = function forEachInner (f, from, to, start) {\n    var leftLen = this.left.length;\n    if (from < leftLen &&\n        this.left.forEachInner(f, from, Math.min(to, leftLen), start) === false)\n      { return false }\n    if (to > leftLen &&\n        this.right.forEachInner(f, Math.max(from - leftLen, 0), Math.min(this.length, to) - leftLen, start + leftLen) === false)\n      { return false }\n  };\n\n  Append.prototype.forEachInvertedInner = function forEachInvertedInner (f, from, to, start) {\n    var leftLen = this.left.length;\n    if (from > leftLen &&\n        this.right.forEachInvertedInner(f, from - leftLen, Math.max(to, leftLen) - leftLen, start + leftLen) === false)\n      { return false }\n    if (to < leftLen &&\n        this.left.forEachInvertedInner(f, Math.min(from, leftLen), to, start) === false)\n      { return false }\n  };\n\n  Append.prototype.sliceInner = function sliceInner (from, to) {\n    if (from == 0 && to == this.length) { return this }\n    var leftLen = this.left.length;\n    if (to <= leftLen) { return this.left.slice(from, to) }\n    if (from >= leftLen) { return this.right.slice(from - leftLen, to - leftLen) }\n    return this.left.slice(from, leftLen).append(this.right.slice(0, to - leftLen))\n  };\n\n  Append.prototype.leafAppend = function leafAppend (other) {\n    var inner = this.right.leafAppend(other);\n    if (inner) { return new Append(this.left, inner) }\n  };\n\n  Append.prototype.leafPrepend = function leafPrepend (other) {\n    var inner = this.left.leafPrepend(other);\n    if (inner) { return new Append(inner, this.right) }\n  };\n\n  Append.prototype.appendInner = function appendInner (other) {\n    if (this.left.depth >= Math.max(this.right.depth, other.depth) + 1)\n      { return new Append(this.left, new Append(this.right, other)) }\n    return new Append(this, other)\n  };\n\n  return Append;\n}(RopeSequence));\n\nvar ropeSequence = RopeSequence;\n\nexport default ropeSequence;\n","import RopeSequence from \"rope-sequence\"\nimport {Mapping} from \"prosemirror-transform\"\nimport {Plugin, PluginKey} from \"prosemirror-state\"\n\n// ProseMirror's history isn't simply a way to roll back to a previous\n// state, because ProseMirror supports applying changes without adding\n// them to the history (for example during collaboration).\n//\n// To this end, each 'Branch' (one for the undo history and one for\n// the redo history) keeps an array of 'Items', which can optionally\n// hold a step (an actual undoable change), and always hold a position\n// map (which is needed to move changes below them to apply to the\n// current document).\n//\n// An item that has both a step and a selection bookmark is the start\n// of an 'event'  a group of changes that will be undone or redone at\n// once. (It stores only the bookmark, since that way we don't have to\n// provide a document until the selection is actually applied, which\n// is useful when compressing.)\n\n// Used to schedule history compression\nconst max_empty_items = 500\n\nclass Branch {\n  constructor(items, eventCount) {\n    this.items = items\n    this.eventCount = eventCount\n  }\n\n  // : (EditorState, bool)  ?{transform: Transform, selection: ?SelectionBookmark, remaining: Branch}\n  // Pop the latest event off the branch's history and apply it\n  // to a document transform.\n  popEvent(state, preserveItems) {\n    if (this.eventCount == 0) return null\n\n    let end = this.items.length\n    for (;; end--) {\n      let next = this.items.get(end - 1)\n      if (next.selection) { --end; break }\n    }\n\n    let remap, mapFrom\n    if (preserveItems) {\n      remap = this.remapping(end, this.items.length)\n      mapFrom = remap.maps.length\n    }\n    let transform = state.tr\n    let selection, remaining\n    let addAfter = [], addBefore = []\n\n    this.items.forEach((item, i) => {\n      if (!item.step) {\n        if (!remap) {\n          remap = this.remapping(end, i + 1)\n          mapFrom = remap.maps.length\n        }\n        mapFrom--\n        addBefore.push(item)\n        return\n      }\n\n      if (remap) {\n        addBefore.push(new Item(item.map))\n        let step = item.step.map(remap.slice(mapFrom)), map\n\n        if (step && transform.maybeStep(step).doc) {\n          map = transform.mapping.maps[transform.mapping.maps.length - 1]\n          addAfter.push(new Item(map, null, null, addAfter.length + addBefore.length))\n        }\n        mapFrom--\n        if (map) remap.appendMap(map, mapFrom)\n      } else {\n        transform.maybeStep(item.step)\n      }\n\n      if (item.selection) {\n        selection = remap ? item.selection.map(remap.slice(mapFrom)) : item.selection\n        remaining = new Branch(this.items.slice(0, end).append(addBefore.reverse().concat(addAfter)), this.eventCount - 1)\n        return false\n      }\n    }, this.items.length, 0)\n\n    return {remaining, transform, selection}\n  }\n\n  // : (Transform, ?SelectionBookmark, Object)  Branch\n  // Create a new branch with the given transform added.\n  addTransform(transform, selection, histOptions, preserveItems) {\n    let newItems = [], eventCount = this.eventCount\n    let oldItems = this.items, lastItem = !preserveItems && oldItems.length ? oldItems.get(oldItems.length - 1) : null\n\n    for (let i = 0; i < transform.steps.length; i++) {\n      let step = transform.steps[i].invert(transform.docs[i])\n      let item = new Item(transform.mapping.maps[i], step, selection), merged\n      if (merged = lastItem && lastItem.merge(item)) {\n        item = merged\n        if (i) newItems.pop()\n        else oldItems = oldItems.slice(0, oldItems.length - 1)\n      }\n      newItems.push(item)\n      if (selection) {\n        eventCount++\n        selection = null\n      }\n      if (!preserveItems) lastItem = item\n    }\n    let overflow = eventCount - histOptions.depth\n    if (overflow > DEPTH_OVERFLOW) {\n      oldItems = cutOffEvents(oldItems, overflow)\n      eventCount -= overflow\n    }\n    return new Branch(oldItems.append(newItems), eventCount)\n  }\n\n  remapping(from, to) {\n    let maps = new Mapping\n    this.items.forEach((item, i) => {\n      let mirrorPos = item.mirrorOffset != null && i - item.mirrorOffset >= from\n          ? maps.maps.length - item.mirrorOffset : null\n      maps.appendMap(item.map, mirrorPos)\n    }, from, to)\n    return maps\n  }\n\n  addMaps(array) {\n    if (this.eventCount == 0) return this\n    return new Branch(this.items.append(array.map(map => new Item(map))), this.eventCount)\n  }\n\n  // : (Transform, number)\n  // When the collab module receives remote changes, the history has\n  // to know about those, so that it can adjust the steps that were\n  // rebased on top of the remote changes, and include the position\n  // maps for the remote changes in its array of items.\n  rebased(rebasedTransform, rebasedCount) {\n    if (!this.eventCount) return this\n\n    let rebasedItems = [], start = Math.max(0, this.items.length - rebasedCount)\n\n    let mapping = rebasedTransform.mapping\n    let newUntil = rebasedTransform.steps.length\n    let eventCount = this.eventCount\n    this.items.forEach(item => { if (item.selection) eventCount-- }, start)\n\n    let iRebased = rebasedCount\n    this.items.forEach(item => {\n      let pos = mapping.getMirror(--iRebased)\n      if (pos == null) return\n      newUntil = Math.min(newUntil, pos)\n      let map = mapping.maps[pos]\n      if (item.step) {\n        let step = rebasedTransform.steps[pos].invert(rebasedTransform.docs[pos])\n        let selection = item.selection && item.selection.map(mapping.slice(iRebased + 1, pos))\n        if (selection) eventCount++\n        rebasedItems.push(new Item(map, step, selection))\n      } else {\n        rebasedItems.push(new Item(map))\n      }\n    }, start)\n\n    let newMaps = []\n    for (let i = rebasedCount; i < newUntil; i++)\n      newMaps.push(new Item(mapping.maps[i]))\n    let items = this.items.slice(0, start).append(newMaps).append(rebasedItems)\n    let branch = new Branch(items, eventCount)\n\n    if (branch.emptyItemCount() > max_empty_items)\n      branch = branch.compress(this.items.length - rebasedItems.length)\n    return branch\n  }\n\n  emptyItemCount() {\n    let count = 0\n    this.items.forEach(item => { if (!item.step) count++ })\n    return count\n  }\n\n  // Compressing a branch means rewriting it to push the air (map-only\n  // items) out. During collaboration, these naturally accumulate\n  // because each remote change adds one. The `upto` argument is used\n  // to ensure that only the items below a given level are compressed,\n  // because `rebased` relies on a clean, untouched set of items in\n  // order to associate old items with rebased steps.\n  compress(upto = this.items.length) {\n    let remap = this.remapping(0, upto), mapFrom = remap.maps.length\n    let items = [], events = 0\n    this.items.forEach((item, i) => {\n      if (i >= upto) {\n        items.push(item)\n        if (item.selection) events++\n      } else if (item.step) {\n        let step = item.step.map(remap.slice(mapFrom)), map = step && step.getMap()\n        mapFrom--\n        if (map) remap.appendMap(map, mapFrom)\n        if (step) {\n          let selection = item.selection && item.selection.map(remap.slice(mapFrom))\n          if (selection) events++\n          let newItem = new Item(map.invert(), step, selection), merged, last = items.length - 1\n          if (merged = items.length && items[last].merge(newItem))\n            items[last] = merged\n          else\n            items.push(newItem)\n        }\n      } else if (item.map) {\n        mapFrom--\n      }\n    }, this.items.length, 0)\n    return new Branch(RopeSequence.from(items.reverse()), events)\n  }\n}\n\nBranch.empty = new Branch(RopeSequence.empty, 0)\n\nfunction cutOffEvents(items, n) {\n  let cutPoint\n  items.forEach((item, i) => {\n    if (item.selection && (n-- == 0)) {\n      cutPoint = i\n      return false\n    }\n  })\n  return items.slice(cutPoint)\n}\n\nclass Item {\n  constructor(map, step, selection, mirrorOffset) {\n    // The (forward) step map for this item.\n    this.map = map\n    // The inverted step\n    this.step = step\n    // If this is non-null, this item is the start of a group, and\n    // this selection is the starting selection for the group (the one\n    // that was active before the first step was applied)\n    this.selection = selection\n    // If this item is the inverse of a previous mapping on the stack,\n    // this points at the inverse's offset\n    this.mirrorOffset = mirrorOffset\n  }\n\n  merge(other) {\n    if (this.step && other.step && !other.selection) {\n      let step = other.step.merge(this.step)\n      if (step) return new Item(step.getMap().invert(), step, this.selection)\n    }\n  }\n}\n\n// The value of the state field that tracks undo/redo history for that\n// state. Will be stored in the plugin state when the history plugin\n// is active.\nexport class HistoryState {\n  constructor(done, undone, prevRanges, prevTime) {\n    this.done = done\n    this.undone = undone\n    this.prevRanges = prevRanges\n    this.prevTime = prevTime\n  }\n}\n\nconst DEPTH_OVERFLOW = 20\n\n// : (HistoryState, EditorState, Transaction, Object)\n// Record a transformation in undo history.\nfunction applyTransaction(history, state, tr, options) {\n  let historyTr = tr.getMeta(historyKey), rebased\n  if (historyTr) return historyTr.historyState\n\n  if (tr.getMeta(closeHistoryKey)) history = new HistoryState(history.done, history.undone, null, 0)\n\n  let appended = tr.getMeta(\"appendedTransaction\")\n\n  if (tr.steps.length == 0) {\n    return history\n  } else if (appended && appended.getMeta(historyKey)) {\n    if (appended.getMeta(historyKey).redo)\n      return new HistoryState(history.done.addTransform(tr, null, options, mustPreserveItems(state)),\n                              history.undone, rangesFor(tr.mapping.maps[tr.steps.length - 1]), history.prevTime)\n    else\n      return new HistoryState(history.done, history.undone.addTransform(tr, null, options, mustPreserveItems(state)),\n                              null, history.prevTime)\n  } else if (tr.getMeta(\"addToHistory\") !== false && !(appended && appended.getMeta(\"addToHistory\") === false)) {\n    // Group transforms that occur in quick succession into one event.\n    let newGroup = history.prevTime == 0 || !appended && (history.prevTime < (tr.time || 0) - options.newGroupDelay ||\n                                                          !isAdjacentTo(tr, history.prevRanges))\n    let prevRanges = appended ? mapRanges(history.prevRanges, tr.mapping) : rangesFor(tr.mapping.maps[tr.steps.length - 1])\n    return new HistoryState(history.done.addTransform(tr, newGroup ? state.selection.getBookmark() : null,\n                                                      options, mustPreserveItems(state)),\n                            Branch.empty, prevRanges, tr.time)\n  } else if (rebased = tr.getMeta(\"rebased\")) {\n    // Used by the collab module to tell the history that some of its\n    // content has been rebased.\n    return new HistoryState(history.done.rebased(tr, rebased),\n                            history.undone.rebased(tr, rebased),\n                            mapRanges(history.prevRanges, tr.mapping), history.prevTime)\n  } else {\n    return new HistoryState(history.done.addMaps(tr.mapping.maps),\n                            history.undone.addMaps(tr.mapping.maps),\n                            mapRanges(history.prevRanges, tr.mapping), history.prevTime)\n  }\n}\n\nfunction isAdjacentTo(transform, prevRanges) {\n  if (!prevRanges) return false\n  if (!transform.docChanged) return true\n  let adjacent = false\n  transform.mapping.maps[0].forEach((start, end) => {\n    for (let i = 0; i < prevRanges.length; i += 2)\n      if (start <= prevRanges[i + 1] && end >= prevRanges[i])\n        adjacent = true\n  })\n  return adjacent\n}\n\nfunction rangesFor(map) {\n  let result = []\n  map.forEach((_from, _to, from, to) => result.push(from, to))\n  return result\n}\n\nfunction mapRanges(ranges, mapping) {\n  if (!ranges) return null\n  let result = []\n  for (let i = 0; i < ranges.length; i += 2) {\n    let from = mapping.map(ranges[i], 1), to = mapping.map(ranges[i + 1], -1)\n    if (from <= to) result.push(from, to)\n  }\n  return result\n}\n\n// : (HistoryState, EditorState, (tr: Transaction), bool)\n// Apply the latest event from one branch to the document and shift the event\n// onto the other branch.\nfunction histTransaction(history, state, dispatch, redo) {\n  let preserveItems = mustPreserveItems(state), histOptions = historyKey.get(state).spec.config\n  let pop = (redo ? history.undone : history.done).popEvent(state, preserveItems)\n  if (!pop) return\n\n  let selection = pop.selection.resolve(pop.transform.doc)\n  let added = (redo ? history.done : history.undone).addTransform(pop.transform, state.selection.getBookmark(),\n                                                                  histOptions, preserveItems)\n\n  let newHist = new HistoryState(redo ? added : pop.remaining, redo ? pop.remaining : added, null, 0)\n  dispatch(pop.transform.setSelection(selection).setMeta(historyKey, {redo, historyState: newHist}).scrollIntoView())\n}\n\nlet cachedPreserveItems = false, cachedPreserveItemsPlugins = null\n// Check whether any plugin in the given state has a\n// `historyPreserveItems` property in its spec, in which case we must\n// preserve steps exactly as they came in, so that they can be\n// rebased.\nfunction mustPreserveItems(state) {\n  let plugins = state.plugins\n  if (cachedPreserveItemsPlugins != plugins) {\n    cachedPreserveItems = false\n    cachedPreserveItemsPlugins = plugins\n    for (let i = 0; i < plugins.length; i++) if (plugins[i].spec.historyPreserveItems) {\n      cachedPreserveItems = true\n      break\n    }\n  }\n  return cachedPreserveItems\n}\n\n// :: (Transaction)  Transaction\n// Set a flag on the given transaction that will prevent further steps\n// from being appended to an existing history event (so that they\n// require a separate undo command to undo).\nexport function closeHistory(tr) {\n  return tr.setMeta(closeHistoryKey, true)\n}\n\nconst historyKey = new PluginKey(\"history\")\nconst closeHistoryKey = new PluginKey(\"closeHistory\")\n\n// :: (?Object)  Plugin\n// Returns a plugin that enables the undo history for an editor. The\n// plugin will track undo and redo stacks, which can be used with the\n// [`undo`](#history.undo) and [`redo`](#history.redo) commands.\n//\n// You can set an `\"addToHistory\"` [metadata\n// property](#state.Transaction.setMeta) of `false` on a transaction\n// to prevent it from being rolled back by undo.\n//\n//   config::-\n//   Supports the following configuration options:\n//\n//     depth:: ?number\n//     The amount of history events that are collected before the\n//     oldest events are discarded. Defaults to 100.\n//\n//     newGroupDelay:: ?number\n//     The delay between changes after which a new group should be\n//     started. Defaults to 500 (milliseconds). Note that when changes\n//     aren't adjacent, a new group is always started.\nexport function history(config) {\n  config = {depth: config && config.depth || 100,\n            newGroupDelay: config && config.newGroupDelay || 500}\n  return new Plugin({\n    key: historyKey,\n\n    state: {\n      init() {\n        return new HistoryState(Branch.empty, Branch.empty, null, 0)\n      },\n      apply(tr, hist, state) {\n        return applyTransaction(hist, state, tr, config)\n      }\n    },\n\n    config\n  })\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// A command function that undoes the last change, if any.\nexport function undo(state, dispatch) {\n  let hist = historyKey.getState(state)\n  if (!hist || hist.done.eventCount == 0) return false\n  if (dispatch) histTransaction(hist, state, dispatch, false)\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// A command function that redoes the last undone change, if any.\nexport function redo(state, dispatch) {\n  let hist = historyKey.getState(state)\n  if (!hist || hist.undone.eventCount == 0) return false\n  if (dispatch) histTransaction(hist, state, dispatch, true)\n  return true\n}\n\n// :: (EditorState)  number\n// The amount of undoable events available in a given state.\nexport function undoDepth(state) {\n  let hist = historyKey.getState(state)\n  return hist ? hist.done.eventCount : 0\n}\n\n// :: (EditorState)  number\n// The amount of redoable events available in a given editor state.\nexport function redoDepth(state) {\n  let hist = historyKey.getState(state)\n  return hist ? hist.undone.eventCount : 0\n}\n","import {joinPoint, canJoin, findWrapping, liftTarget, canSplit, ReplaceAroundStep} from \"prosemirror-transform\"\nimport {Slice, Fragment} from \"prosemirror-model\"\nimport {Selection, TextSelection, NodeSelection, AllSelection} from \"prosemirror-state\"\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Delete the selection, if there is one.\nexport function deleteSelection(state, dispatch) {\n  if (state.selection.empty) return false\n  if (dispatch) dispatch(state.tr.deleteSelection().scrollIntoView())\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView)  bool\n// If the selection is empty and at the start of a textblock, try to\n// reduce the distance between that block and the one before itif\n// there's a block directly before it that can be joined, join them.\n// If not, try to move the selected block closer to the next one in\n// the document structure by lifting it out of its parent or moving it\n// into a parent of the previous block. Will use the view for accurate\n// (bidi-aware) start-of-textblock detection if given.\nexport function joinBackward(state, dispatch, view) {\n  let {$cursor} = state.selection\n  if (!$cursor || (view ? !view.endOfTextblock(\"backward\", state)\n                        : $cursor.parentOffset > 0))\n    return false\n\n  let $cut = findCutBefore($cursor)\n\n  // If there is no node before this, try to lift\n  if (!$cut) {\n    let range = $cursor.blockRange(), target = range && liftTarget(range)\n    if (target == null) return false\n    if (dispatch) dispatch(state.tr.lift(range, target).scrollIntoView())\n    return true\n  }\n\n  let before = $cut.nodeBefore\n  // Apply the joining algorithm\n  if (!before.type.spec.isolating && deleteBarrier(state, $cut, dispatch))\n    return true\n\n  // If the node below has no content and the node above is\n  // selectable, delete the node below and select the one above.\n  if ($cursor.parent.content.size == 0 &&\n      (textblockAt(before, \"end\") || NodeSelection.isSelectable(before))) {\n    if (dispatch) {\n      let tr = state.tr.deleteRange($cursor.before(), $cursor.after())\n      tr.setSelection(textblockAt(before, \"end\") ? Selection.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos, -1)), -1)\n                      : NodeSelection.create(tr.doc, $cut.pos - before.nodeSize))\n      dispatch(tr.scrollIntoView())\n    }\n    return true\n  }\n\n  // If the node before is an atom, delete it\n  if (before.isAtom && $cut.depth == $cursor.depth - 1) {\n    if (dispatch) dispatch(state.tr.delete($cut.pos - before.nodeSize, $cut.pos).scrollIntoView())\n    return true\n  }\n\n  return false\n}\n\nfunction textblockAt(node, side) {\n  for (; node; node = (side == \"start\" ? node.firstChild : node.lastChild))\n    if (node.isTextblock) return true\n  return false\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView)  bool\n// When the selection is empty and at the start of a textblock, select\n// the node before that textblock, if possible. This is intended to be\n// bound to keys like backspace, after\n// [`joinBackward`](#commands.joinBackward) or other deleting\n// commands, as a fall-back behavior when the schema doesn't allow\n// deletion at the selected point.\nexport function selectNodeBackward(state, dispatch, view) {\n  let {$head, empty} = state.selection, $cut = $head\n  if (!empty) return false\n\n  if ($head.parent.isTextblock) {\n    if (view ? !view.endOfTextblock(\"backward\", state) : $head.parentOffset > 0) return false\n    $cut = findCutBefore($head)\n  }\n  let node = $cut && $cut.nodeBefore\n  if (!node || !NodeSelection.isSelectable(node)) return false\n  if (dispatch)\n    dispatch(state.tr.setSelection(NodeSelection.create(state.doc, $cut.pos - node.nodeSize)).scrollIntoView())\n  return true\n}\n\nfunction findCutBefore($pos) {\n  if (!$pos.parent.type.spec.isolating) for (let i = $pos.depth - 1; i >= 0; i--) {\n    if ($pos.index(i) > 0) return $pos.doc.resolve($pos.before(i + 1))\n    if ($pos.node(i).type.spec.isolating) break\n  }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView)  bool\n// If the selection is empty and the cursor is at the end of a\n// textblock, try to reduce or remove the boundary between that block\n// and the one after it, either by joining them or by moving the other\n// block closer to this one in the tree structure. Will use the view\n// for accurate start-of-textblock detection if given.\nexport function joinForward(state, dispatch, view) {\n  let {$cursor} = state.selection\n  if (!$cursor || (view ? !view.endOfTextblock(\"forward\", state)\n                        : $cursor.parentOffset < $cursor.parent.content.size))\n    return false\n\n  let $cut = findCutAfter($cursor)\n\n  // If there is no node after this, there's nothing to do\n  if (!$cut) return false\n\n  let after = $cut.nodeAfter\n  // Try the joining algorithm\n  if (deleteBarrier(state, $cut, dispatch)) return true\n\n  // If the node above has no content and the node below is\n  // selectable, delete the node above and select the one below.\n  if ($cursor.parent.content.size == 0 &&\n      (textblockAt(after, \"start\") || NodeSelection.isSelectable(after))) {\n    if (dispatch) {\n      let tr = state.tr.deleteRange($cursor.before(), $cursor.after())\n      tr.setSelection(textblockAt(after, \"start\") ? Selection.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos)), 1)\n                      : NodeSelection.create(tr.doc, tr.mapping.map($cut.pos)))\n      dispatch(tr.scrollIntoView())\n    }\n    return true\n  }\n\n  // If the next node is an atom, delete it\n  if (after.isAtom && $cut.depth == $cursor.depth - 1) {\n    if (dispatch) dispatch(state.tr.delete($cut.pos, $cut.pos + after.nodeSize).scrollIntoView())\n    return true\n  }\n\n  return false\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView)  bool\n// When the selection is empty and at the end of a textblock, select\n// the node coming after that textblock, if possible. This is intended\n// to be bound to keys like delete, after\n// [`joinForward`](#commands.joinForward) and similar deleting\n// commands, to provide a fall-back behavior when the schema doesn't\n// allow deletion at the selected point.\nexport function selectNodeForward(state, dispatch, view) {\n  let {$head, empty} = state.selection, $cut = $head\n  if (!empty) return false\n  if ($head.parent.isTextblock) {\n    if (view ? !view.endOfTextblock(\"forward\", state) : $head.parentOffset < $head.parent.content.size)\n      return false\n    $cut = findCutAfter($head)\n  }\n  let node = $cut && $cut.nodeAfter\n  if (!node || !NodeSelection.isSelectable(node)) return false\n  if (dispatch)\n    dispatch(state.tr.setSelection(NodeSelection.create(state.doc, $cut.pos)).scrollIntoView())\n  return true\n}\n\nfunction findCutAfter($pos) {\n  if (!$pos.parent.type.spec.isolating) for (let i = $pos.depth - 1; i >= 0; i--) {\n    let parent = $pos.node(i)\n    if ($pos.index(i) + 1 < parent.childCount) return $pos.doc.resolve($pos.after(i + 1))\n    if (parent.type.spec.isolating) break\n  }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Join the selected block or, if there is a text selection, the\n// closest ancestor block of the selection that can be joined, with\n// the sibling above it.\nexport function joinUp(state, dispatch) {\n  let sel = state.selection, nodeSel = sel instanceof NodeSelection, point\n  if (nodeSel) {\n    if (sel.node.isTextblock || !canJoin(state.doc, sel.from)) return false\n    point = sel.from\n  } else {\n    point = joinPoint(state.doc, sel.from, -1)\n    if (point == null) return false\n  }\n  if (dispatch) {\n    let tr = state.tr.join(point)\n    if (nodeSel) tr.setSelection(NodeSelection.create(tr.doc, point - state.doc.resolve(point).nodeBefore.nodeSize))\n    dispatch(tr.scrollIntoView())\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Join the selected block, or the closest ancestor of the selection\n// that can be joined, with the sibling after it.\nexport function joinDown(state, dispatch) {\n  let sel = state.selection, point\n  if (sel instanceof NodeSelection) {\n    if (sel.node.isTextblock || !canJoin(state.doc, sel.to)) return false\n    point = sel.to\n  } else {\n    point = joinPoint(state.doc, sel.to, 1)\n    if (point == null) return false\n  }\n  if (dispatch)\n    dispatch(state.tr.join(point).scrollIntoView())\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Lift the selected block, or the closest ancestor block of the\n// selection that can be lifted, out of its parent node.\nexport function lift(state, dispatch) {\n  let {$from, $to} = state.selection\n  let range = $from.blockRange($to), target = range && liftTarget(range)\n  if (target == null) return false\n  if (dispatch) dispatch(state.tr.lift(range, target).scrollIntoView())\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// If the selection is in a node whose type has a truthy\n// [`code`](#model.NodeSpec.code) property in its spec, replace the\n// selection with a newline character.\nexport function newlineInCode(state, dispatch) {\n  let {$head, $anchor} = state.selection\n  if (!$head.parent.type.spec.code || !$head.sameParent($anchor)) return false\n  if (dispatch) dispatch(state.tr.insertText(\"\\n\").scrollIntoView())\n  return true\n}\n\nfunction defaultBlockAt(match) {\n  for (let i = 0; i < match.edgeCount; i++) {\n    let {type} = match.edge(i)\n    if (type.isTextblock && !type.hasRequiredAttrs()) return type\n  }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// When the selection is in a node with a truthy\n// [`code`](#model.NodeSpec.code) property in its spec, create a\n// default block after the code block, and move the cursor there.\nexport function exitCode(state, dispatch) {\n  let {$head, $anchor} = state.selection\n  if (!$head.parent.type.spec.code || !$head.sameParent($anchor)) return false\n  let above = $head.node(-1), after = $head.indexAfter(-1), type = defaultBlockAt(above.contentMatchAt(after))\n  if (!above.canReplaceWith(after, after, type)) return false\n  if (dispatch) {\n    let pos = $head.after(), tr = state.tr.replaceWith(pos, pos, type.createAndFill())\n    tr.setSelection(Selection.near(tr.doc.resolve(pos), 1))\n    dispatch(tr.scrollIntoView())\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// If a block node is selected, create an empty paragraph before (if\n// it is its parent's first child) or after it.\nexport function createParagraphNear(state, dispatch) {\n  let {$from, $to} = state.selection\n  if ($from.parent.inlineContent || $to.parent.inlineContent) return false\n  let type = defaultBlockAt($from.parent.contentMatchAt($to.indexAfter()))\n  if (!type || !type.isTextblock) return false\n  if (dispatch) {\n    let side = (!$from.parentOffset && $to.index() < $to.parent.childCount ? $from : $to).pos\n    let tr = state.tr.insert(side, type.createAndFill())\n    tr.setSelection(TextSelection.create(tr.doc, side + 1))\n    dispatch(tr.scrollIntoView())\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// If the cursor is in an empty textblock that can be lifted, lift the\n// block.\nexport function liftEmptyBlock(state, dispatch) {\n  let {$cursor} = state.selection\n  if (!$cursor || $cursor.parent.content.size) return false\n  if ($cursor.depth > 1 && $cursor.after() != $cursor.end(-1)) {\n    let before = $cursor.before()\n    if (canSplit(state.doc, before)) {\n      if (dispatch) dispatch(state.tr.split(before).scrollIntoView())\n      return true\n    }\n  }\n  let range = $cursor.blockRange(), target = range && liftTarget(range)\n  if (target == null) return false\n  if (dispatch) dispatch(state.tr.lift(range, target).scrollIntoView())\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Split the parent block of the selection. If the selection is a text\n// selection, also delete its content.\nexport function splitBlock(state, dispatch) {\n  let {$from, $to} = state.selection\n  if (state.selection instanceof NodeSelection && state.selection.node.isBlock) {\n    if (!$from.parentOffset || !canSplit(state.doc, $from.pos)) return false\n    if (dispatch) dispatch(state.tr.split($from.pos).scrollIntoView())\n    return true\n  }\n\n  if (!$from.parent.isBlock) return false\n\n  if (dispatch) {\n    let atEnd = $to.parentOffset == $to.parent.content.size\n    let tr = state.tr\n    if (state.selection instanceof TextSelection) tr.deleteSelection()\n    let deflt = $from.depth == 0 ? null : defaultBlockAt($from.node(-1).contentMatchAt($from.indexAfter(-1)))\n    let types = atEnd && deflt ? [{type: deflt}] : null\n    let can = canSplit(tr.doc, tr.mapping.map($from.pos), 1, types)\n    if (!types && !can && canSplit(tr.doc, tr.mapping.map($from.pos), 1, deflt && [{type: deflt}])) {\n      types = [{type: deflt}]\n      can = true\n    }\n    if (can) {\n      tr.split(tr.mapping.map($from.pos), 1, types)\n      if (!atEnd && !$from.parentOffset && $from.parent.type != deflt &&\n          $from.node(-1).canReplace($from.index(-1), $from.indexAfter(-1), Fragment.from(deflt.create(), $from.parent)))\n        tr.setNodeMarkup(tr.mapping.map($from.before()), deflt)\n    }\n    dispatch(tr.scrollIntoView())\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Acts like [`splitBlock`](#commands.splitBlock), but without\n// resetting the set of active marks at the cursor.\nexport function splitBlockKeepMarks(state, dispatch) {\n  return splitBlock(state, dispatch && (tr => {\n    let marks = state.storedMarks || (state.selection.$to.parentOffset && state.selection.$from.marks())\n    if (marks) tr.ensureMarks(marks)\n    dispatch(tr)\n  }))\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Move the selection to the node wrapping the current selection, if\n// any. (Will not select the document node.)\nexport function selectParentNode(state, dispatch) {\n  let {$from, to} = state.selection, pos\n  let same = $from.sharedDepth(to)\n  if (same == 0) return false\n  pos = $from.before(same)\n  if (dispatch) dispatch(state.tr.setSelection(NodeSelection.create(state.doc, pos)))\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction))  bool\n// Select the whole document.\nexport function selectAll(state, dispatch) {\n  if (dispatch) dispatch(state.tr.setSelection(new AllSelection(state.doc)))\n  return true\n}\n\nfunction joinMaybeClear(state, $pos, dispatch) {\n  let before = $pos.nodeBefore, after = $pos.nodeAfter, index = $pos.index()\n  if (!before || !after || !before.type.compatibleContent(after.type)) return false\n  if (!before.content.size && $pos.parent.canReplace(index - 1, index)) {\n    if (dispatch) dispatch(state.tr.delete($pos.pos - before.nodeSize, $pos.pos).scrollIntoView())\n    return true\n  }\n  if (!$pos.parent.canReplace(index, index + 1) || !(after.isTextblock || canJoin(state.doc, $pos.pos)))\n    return false\n  if (dispatch)\n    dispatch(state.tr\n             .clearIncompatible($pos.pos, before.type, before.contentMatchAt(before.childCount))\n             .join($pos.pos)\n             .scrollIntoView())\n  return true\n}\n\nfunction deleteBarrier(state, $cut, dispatch) {\n  let before = $cut.nodeBefore, after = $cut.nodeAfter, conn, match\n  if (before.type.spec.isolating || after.type.spec.isolating) return false\n  if (joinMaybeClear(state, $cut, dispatch)) return true\n\n  if ($cut.parent.canReplace($cut.index(), $cut.index() + 1) &&\n      (conn = (match = before.contentMatchAt(before.childCount)).findWrapping(after.type)) &&\n      match.matchType(conn[0] || after.type).validEnd) {\n    if (dispatch) {\n      let end = $cut.pos + after.nodeSize, wrap = Fragment.empty\n      for (let i = conn.length - 1; i >= 0; i--)\n        wrap = Fragment.from(conn[i].create(null, wrap))\n      wrap = Fragment.from(before.copy(wrap))\n      let tr = state.tr.step(new ReplaceAroundStep($cut.pos - 1, end, $cut.pos, end, new Slice(wrap, 1, 0), conn.length, true))\n      let joinAt = end + 2 * conn.length\n      if (canJoin(tr.doc, joinAt)) tr.join(joinAt)\n      dispatch(tr.scrollIntoView())\n    }\n    return true\n  }\n\n  let selAfter = Selection.findFrom($cut, 1)\n  let range = selAfter && selAfter.$from.blockRange(selAfter.$to), target = range && liftTarget(range)\n  if (target != null && target >= $cut.depth) {\n    if (dispatch) dispatch(state.tr.lift(range, target).scrollIntoView())\n    return true\n  }\n\n  return false\n}\n\n// Parameterized commands\n\n// :: (NodeType, ?Object)  (state: EditorState, dispatch: ?(tr: Transaction))  bool\n// Wrap the selection in a node of the given type with the given\n// attributes.\nexport function wrapIn(nodeType, attrs) {\n  return function(state, dispatch) {\n    let {$from, $to} = state.selection\n    let range = $from.blockRange($to), wrapping = range && findWrapping(range, nodeType, attrs)\n    if (!wrapping) return false\n    if (dispatch) dispatch(state.tr.wrap(range, wrapping).scrollIntoView())\n    return true\n  }\n}\n\n// :: (NodeType, ?Object)  (state: EditorState, dispatch: ?(tr: Transaction))  bool\n// Returns a command that tries to set the selected textblocks to the\n// given node type with the given attributes.\nexport function setBlockType(nodeType, attrs) {\n  return function(state, dispatch) {\n    let {from, to} = state.selection\n    let applicable = false\n    state.doc.nodesBetween(from, to, (node, pos) => {\n      if (applicable) return false\n      if (!node.isTextblock || node.hasMarkup(nodeType, attrs)) return\n      if (node.type == nodeType) {\n        applicable = true\n      } else {\n        let $pos = state.doc.resolve(pos), index = $pos.index()\n        applicable = $pos.parent.canReplaceWith(index, index + 1, nodeType)\n      }\n    })\n    if (!applicable) return false\n    if (dispatch) dispatch(state.tr.setBlockType(from, to, nodeType, attrs).scrollIntoView())\n    return true\n  }\n}\n\nfunction markApplies(doc, ranges, type) {\n  for (let i = 0; i < ranges.length; i++) {\n    let {$from, $to} = ranges[i]\n    let can = $from.depth == 0 ? doc.type.allowsMarkType(type) : false\n    doc.nodesBetween($from.pos, $to.pos, node => {\n      if (can) return false\n      can = node.inlineContent && node.type.allowsMarkType(type)\n    })\n    if (can) return true\n  }\n  return false\n}\n\n// :: (MarkType, ?Object)  (state: EditorState, dispatch: ?(tr: Transaction))  bool\n// Create a command function that toggles the given mark with the\n// given attributes. Will return `false` when the current selection\n// doesn't support that mark. This will remove the mark if any marks\n// of that type exist in the selection, or add it otherwise. If the\n// selection is empty, this applies to the [stored\n// marks](#state.EditorState.storedMarks) instead of a range of the\n// document.\nexport function toggleMark(markType, attrs) {\n  return function(state, dispatch) {\n    let {empty, $cursor, ranges} = state.selection\n    if ((empty && !$cursor) || !markApplies(state.doc, ranges, markType)) return false\n    if (dispatch) {\n      if ($cursor) {\n        if (markType.isInSet(state.storedMarks || $cursor.marks()))\n          dispatch(state.tr.removeStoredMark(markType))\n        else\n          dispatch(state.tr.addStoredMark(markType.create(attrs)))\n      } else {\n        let has = false, tr = state.tr\n        for (let i = 0; !has && i < ranges.length; i++) {\n          let {$from, $to} = ranges[i]\n          has = state.doc.rangeHasMark($from.pos, $to.pos, markType)\n        }\n        for (let i = 0; i < ranges.length; i++) {\n          let {$from, $to} = ranges[i]\n          if (has) tr.removeMark($from.pos, $to.pos, markType)\n          else tr.addMark($from.pos, $to.pos, markType.create(attrs))\n        }\n        dispatch(tr.scrollIntoView())\n      }\n    }\n    return true\n  }\n}\n\nfunction wrapDispatchForJoin(dispatch, isJoinable) {\n  return tr => {\n    if (!tr.isGeneric) return dispatch(tr)\n\n    let ranges = []\n    for (let i = 0; i < tr.mapping.maps.length; i++) {\n      let map = tr.mapping.maps[i]\n      for (let j = 0; j < ranges.length; j++)\n        ranges[j] = map.map(ranges[j])\n      map.forEach((_s, _e, from, to) => ranges.push(from, to))\n    }\n\n    // Figure out which joinable points exist inside those ranges,\n    // by checking all node boundaries in their parent nodes.\n    let joinable = []\n    for (let i = 0; i < ranges.length; i += 2) {\n      let from = ranges[i], to = ranges[i + 1]\n      let $from = tr.doc.resolve(from), depth = $from.sharedDepth(to), parent = $from.node(depth)\n      for (let index = $from.indexAfter(depth), pos = $from.after(depth + 1); pos <= to; ++index) {\n        let after = parent.maybeChild(index)\n        if (!after) break\n        if (index && joinable.indexOf(pos) == -1) {\n          let before = parent.child(index - 1)\n          if (before.type == after.type && isJoinable(before, after))\n            joinable.push(pos)\n        }\n        pos += after.nodeSize\n      }\n    }\n    // Join the joinable points\n    joinable.sort((a, b) => a - b)\n    for (let i = joinable.length - 1; i >= 0; i--) {\n      if (canJoin(tr.doc, joinable[i])) tr.join(joinable[i])\n    }\n    dispatch(tr)\n  }\n}\n\n// :: ((state: EditorState, ?(tr: Transaction))  bool, union<(before: Node, after: Node)  bool, [string]>)  (state: EditorState, ?(tr: Transaction))  bool\n// Wrap a command so that, when it produces a transform that causes\n// two joinable nodes to end up next to each other, those are joined.\n// Nodes are considered joinable when they are of the same type and\n// when the `isJoinable` predicate returns true for them or, if an\n// array of strings was passed, if their node type name is in that\n// array.\nexport function autoJoin(command, isJoinable) {\n  if (Array.isArray(isJoinable)) {\n    let types = isJoinable\n    isJoinable = node => types.indexOf(node.type.name) > -1\n  }\n  return (state, dispatch) => command(state, dispatch && wrapDispatchForJoin(dispatch, isJoinable))\n}\n\n// :: (...[(EditorState, ?(tr: Transaction), ?EditorView)  bool])  (EditorState, ?(tr: Transaction), ?EditorView)  bool\n// Combine a number of command functions into a single function (which\n// calls them one by one until one returns true).\nexport function chainCommands(...commands) {\n  return function(state, dispatch, view) {\n    for (let i = 0; i < commands.length; i++)\n      if (commands[i](state, dispatch, view)) return true\n    return false\n  }\n}\n\nlet backspace = chainCommands(deleteSelection, joinBackward, selectNodeBackward)\nlet del = chainCommands(deleteSelection, joinForward, selectNodeForward)\n\n// :: Object\n// A basic keymap containing bindings not specific to any schema.\n// Binds the following keys (when multiple commands are listed, they\n// are chained with [`chainCommands`](#commands.chainCommands)):\n//\n// * **Enter** to `newlineInCode`, `createParagraphNear`, `liftEmptyBlock`, `splitBlock`\n// * **Mod-Enter** to `exitCode`\n// * **Backspace** and **Mod-Backspace** to `deleteSelection`, `joinBackward`, `selectNodeBackward`\n// * **Delete** and **Mod-Delete** to `deleteSelection`, `joinForward`, `selectNodeForward`\n// * **Mod-Delete** to `deleteSelection`, `joinForward`, `selectNodeForward`\n// * **Mod-a** to `selectAll`\nexport let pcBaseKeymap = {\n  \"Enter\": chainCommands(newlineInCode, createParagraphNear, liftEmptyBlock, splitBlock),\n  \"Mod-Enter\": exitCode,\n  \"Backspace\": backspace,\n  \"Mod-Backspace\": backspace,\n  \"Delete\": del,\n  \"Mod-Delete\": del,\n  \"Mod-a\": selectAll\n}\n\n// :: Object\n// A copy of `pcBaseKeymap` that also binds **Ctrl-h** like Backspace,\n// **Ctrl-d** like Delete, **Alt-Backspace** like Ctrl-Backspace, and\n// **Ctrl-Alt-Backspace**, **Alt-Delete**, and **Alt-d** like\n// Ctrl-Delete.\nexport let macBaseKeymap = {\n  \"Ctrl-h\": pcBaseKeymap[\"Backspace\"],\n  \"Alt-Backspace\": pcBaseKeymap[\"Mod-Backspace\"],\n  \"Ctrl-d\": pcBaseKeymap[\"Delete\"],\n  \"Ctrl-Alt-Backspace\": pcBaseKeymap[\"Mod-Delete\"],\n  \"Alt-Delete\": pcBaseKeymap[\"Mod-Delete\"],\n  \"Alt-d\": pcBaseKeymap[\"Mod-Delete\"]\n}\nfor (let key in pcBaseKeymap) macBaseKeymap[key] = pcBaseKeymap[key]\n\n// declare global: os, navigator\nconst mac = typeof navigator != \"undefined\" ? /Mac/.test(navigator.platform)\n          : typeof os != \"undefined\" ? os.platform() == \"darwin\" : false\n\n// :: Object\n// Depending on the detected platform, this will hold\n// [`pcBasekeymap`](#commands.pcBaseKeymap) or\n// [`macBaseKeymap`](#commands.macBaseKeymap).\nexport let baseKeymap = mac ? macBaseKeymap : pcBaseKeymap\n","import {Plugin} from \"prosemirror-state\"\nimport {dropPoint} from \"prosemirror-transform\"\n\n// :: (options: ?Object)  Plugin\n// Create a plugin that, when added to a ProseMirror instance,\n// causes a decoration to show up at the drop position when something\n// is dragged over the editor.\n//\n//   options::- These options are supported:\n//\n//     color:: ?string\n//     The color of the cursor. Defaults to `black`.\n//\n//     width:: ?number\n//     The precise width of the cursor in pixels. Defaults to 1.\n//\n//     class:: ?string\n//     A CSS class name to add to the cursor element.\nexport function dropCursor(options = {}) {\n  return new Plugin({\n    view(editorView) { return new DropCursorView(editorView, options) }\n  })\n}\n\nclass DropCursorView {\n  constructor(editorView, options) {\n    this.editorView = editorView\n    this.width = options.width || 1\n    this.color = options.color || \"black\"\n    this.class = options.class\n    this.cursorPos = null\n    this.element = null\n    this.timeout = null\n\n    this.handlers = [\"dragover\", \"dragend\", \"drop\", \"dragleave\"].map(name => {\n      let handler = e => this[name](e)\n      editorView.dom.addEventListener(name, handler)\n      return {name, handler}\n    })\n  }\n\n  destroy() {\n    this.handlers.forEach(({name, handler}) => this.editorView.dom.removeEventListener(name, handler))\n  }\n\n  update(editorView, prevState) {\n    if (this.cursorPos != null && prevState.doc != editorView.state.doc) this.updateOverlay()\n  }\n\n  setCursor(pos) {\n    if (pos == this.cursorPos) return\n    this.cursorPos = pos\n    if (pos == null) {\n      this.element.parentNode.removeChild(this.element)\n      this.element = null\n    } else {\n      this.updateOverlay()\n    }\n  }\n\n  updateOverlay() {\n    let $pos = this.editorView.state.doc.resolve(this.cursorPos), rect\n    if (!$pos.parent.inlineContent) {\n      let before = $pos.nodeBefore, after = $pos.nodeAfter\n      if (before || after) {\n        let nodeRect = this.editorView.nodeDOM(this.cursorPos - (before ?  before.nodeSize : 0)).getBoundingClientRect()\n        let top = before ? nodeRect.bottom : nodeRect.top\n        if (before && after)\n          top = (top + this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top) / 2\n        rect = {left: nodeRect.left, right: nodeRect.right, top: top - this.width / 2, bottom: top + this.width / 2}\n      }\n    }\n    if (!rect) {\n      let coords = this.editorView.coordsAtPos(this.cursorPos)\n      rect = {left: coords.left - this.width / 2, right: coords.left + this.width / 2, top: coords.top, bottom: coords.bottom}\n    }\n\n    let parent = this.editorView.dom.offsetParent\n    if (!this.element) {\n      this.element = parent.appendChild(document.createElement(\"div\"))\n      if (this.class) this.element.className = this.class\n      this.element.style.cssText = \"position: absolute; z-index: 50; pointer-events: none; background-color: \" + this.color\n    }\n    let parentRect = !parent || parent == document.body && getComputedStyle(parent).position == \"static\"\n        ? {left: -pageXOffset, top: -pageYOffset} : parent.getBoundingClientRect()\n    this.element.style.left = (rect.left - parentRect.left) + \"px\"\n    this.element.style.top = (rect.top - parentRect.top) + \"px\"\n    this.element.style.width = (rect.right - rect.left) + \"px\"\n    this.element.style.height = (rect.bottom - rect.top) + \"px\"\n  }\n\n  scheduleRemoval(timeout) {\n    clearTimeout(this.timeout)\n    this.timeout = setTimeout(() => this.setCursor(null), timeout)\n  }\n\n  dragover(event) {\n    if (!this.editorView.editable) return\n    let pos = this.editorView.posAtCoords({left: event.clientX, top: event.clientY})\n    if (pos) {\n      let target = pos.pos\n      if (this.editorView.dragging && this.editorView.dragging.slice) {\n        target = dropPoint(this.editorView.state.doc, target, this.editorView.dragging.slice)\n        if (target == null) target = pos.pos\n      }\n      this.setCursor(target)\n      this.scheduleRemoval(5000)\n    }\n  }\n\n  dragend() {\n    this.scheduleRemoval(20)\n  }\n\n  drop() {\n    this.scheduleRemoval(20)\n  }\n\n  dragleave(event) {\n    if (event.target == this.editorView.dom || !this.editorView.dom.contains(event.relatedTarget))\n      this.setCursor(null)\n  }\n}\n","import {Selection, NodeSelection} from \"prosemirror-state\"\nimport {Slice} from \"prosemirror-model\"\n\n// ::- Gap cursor selections are represented using this class. Its\n// `$anchor` and `$head` properties both point at the cursor position.\nexport class GapCursor extends Selection {\n  // : (ResolvedPos)\n  constructor($pos) {\n    super($pos, $pos)\n  }\n\n  map(doc, mapping) {\n    let $pos = doc.resolve(mapping.map(this.head))\n    return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos)\n  }\n\n  content() { return Slice.empty }\n\n  eq(other) {\n    return other instanceof GapCursor && other.head == this.head\n  }\n\n  toJSON() {\n    return {type: \"gapcursor\", pos: this.head}\n  }\n\n  static fromJSON(doc, json) {\n    if (typeof json.pos != \"number\") throw new RangeError(\"Invalid input for GapCursor.fromJSON\")\n    return new GapCursor(doc.resolve(json.pos))\n  }\n\n  getBookmark() { return new GapBookmark(this.anchor) }\n\n  static valid($pos) {\n    let parent = $pos.parent\n    if (parent.isTextblock || !closedBefore($pos) || !closedAfter($pos)) return false\n    let override = parent.type.spec.allowGapCursor\n    if (override != null) return override\n    let deflt = parent.contentMatchAt($pos.index()).defaultType\n    return deflt && deflt.isTextblock\n  }\n\n  static findFrom($pos, dir, mustMove) {\n    search: for (;;) {\n      if (!mustMove && GapCursor.valid($pos)) return $pos\n      let pos = $pos.pos, next = null\n      // Scan up from this position\n      for (let d = $pos.depth;; d--) {\n        let parent = $pos.node(d)\n        if (dir > 0 ? $pos.indexAfter(d) < parent.childCount : $pos.index(d) > 0) {\n          next = parent.child(dir > 0 ? $pos.indexAfter(d) : $pos.index(d) - 1)\n          break\n        } else if (d == 0) {\n          return null\n        }\n        pos += dir\n        let $cur = $pos.doc.resolve(pos)\n        if (GapCursor.valid($cur)) return $cur\n      }\n\n      // And then down into the next node\n      for (;;) {\n        let inside = dir > 0 ? next.firstChild : next.lastChild\n        if (!inside) {\n          if (next.isAtom && !next.isText && !NodeSelection.isSelectable(next)) {\n            $pos = $pos.doc.resolve(pos + next.nodeSize * dir)\n            mustMove = false\n            continue search\n          }\n          break\n        }\n        next = inside\n        pos += dir\n        let $cur = $pos.doc.resolve(pos)\n        if (GapCursor.valid($cur)) return $cur\n      }\n\n      return null\n    }\n  }\n}\n\nGapCursor.prototype.visible = false\n\nSelection.jsonID(\"gapcursor\", GapCursor)\n\nclass GapBookmark {\n  constructor(pos) {\n    this.pos = pos\n  }\n  map(mapping) {\n    return new GapBookmark(mapping.map(this.pos))\n  }\n  resolve(doc) {\n    let $pos = doc.resolve(this.pos)\n    return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos)\n  }\n}\n\nfunction closedBefore($pos) {\n  for (let d = $pos.depth; d >= 0; d--) {\n    let index = $pos.index(d)\n    // At the start of this parent, look at next one\n    if (index == 0) continue\n    // See if the node before (or its first ancestor) is closed\n    for (let before = $pos.node(d).child(index - 1);; before = before.lastChild) {\n      if ((before.childCount == 0 && !before.inlineContent) || before.isAtom || before.type.spec.isolating) return true\n      if (before.inlineContent) return false\n    }\n  }\n  // Hit start of document\n  return true\n}\n\nfunction closedAfter($pos) {\n  for (let d = $pos.depth; d >= 0; d--) {\n    let index = $pos.indexAfter(d), parent = $pos.node(d)\n    if (index == parent.childCount) continue\n    for (let after = parent.child(index);; after = after.firstChild) {\n      if ((after.childCount == 0 && !after.inlineContent) || after.isAtom || after.type.spec.isolating) return true\n      if (after.inlineContent) return false\n    }\n  }\n  return true\n}\n","export default function crelt() {\n  var elt = arguments[0]\n  if (typeof elt == \"string\") elt = document.createElement(elt)\n  var i = 1, next = arguments[1]\n  if (next && typeof next == \"object\" && next.nodeType == null && !Array.isArray(next)) {\n    for (var name in next) if (Object.prototype.hasOwnProperty.call(next, name)) {\n      var value = next[name]\n      if (typeof value == \"string\") elt.setAttribute(name, value)\n      else if (value != null) elt[name] = value\n    }\n    i++\n  }\n  for (; i < arguments.length; i++) add(elt, arguments[i])\n  return elt\n}\n\nfunction add(elt, child) {\n  if (typeof child == \"string\") {\n    elt.appendChild(document.createTextNode(child))\n  } else if (child == null) {\n  } else if (child.nodeType != null) {\n    elt.appendChild(child)\n  } else if (Array.isArray(child)) {\n    for (var i = 0; i < child.length; i++) add(elt, child[i])\n  } else {\n    throw new RangeError(\"Unsupported child node: \" + child)\n  }\n}\n","const SVG = \"http://www.w3.org/2000/svg\"\nconst XLINK = \"http://www.w3.org/1999/xlink\"\n\nconst prefix = \"ProseMirror-icon\"\n\nfunction hashPath(path) {\n  let hash = 0\n  for (let i = 0; i < path.length; i++)\n    hash = (((hash << 5) - hash) + path.charCodeAt(i)) | 0\n  return hash\n}\n\nexport function getIcon(icon) {\n  let node = document.createElement(\"div\")\n  node.className = prefix\n  if (icon.path) {\n    let name = \"pm-icon-\" + hashPath(icon.path).toString(16)\n    if (!document.getElementById(name)) buildSVG(name, icon)\n    let svg = node.appendChild(document.createElementNS(SVG, \"svg\"))\n    svg.style.width = (icon.width / icon.height) + \"em\"\n    let use = svg.appendChild(document.createElementNS(SVG, \"use\"))\n    use.setAttributeNS(XLINK, \"href\", /([^#]*)/.exec(document.location)[1] + \"#\" + name)\n  } else if (icon.dom) {\n    node.appendChild(icon.dom.cloneNode(true))\n  } else {\n    node.appendChild(document.createElement(\"span\")).textContent = icon.text || ''\n    if (icon.css) node.firstChild.style.cssText = icon.css\n  }\n  return node\n}\n\nfunction buildSVG(name, data) {\n  let collection = document.getElementById(prefix + \"-collection\")\n  if (!collection) {\n    collection = document.createElementNS(SVG, \"svg\")\n    collection.id = prefix + \"-collection\"\n    collection.style.display = \"none\"\n    document.body.insertBefore(collection, document.body.firstChild)\n  }\n  let sym = document.createElementNS(SVG, \"symbol\")\n  sym.id = name\n  sym.setAttribute(\"viewBox\", \"0 0 \" + data.width + \" \" + data.height)\n  let path = sym.appendChild(document.createElementNS(SVG, \"path\"))\n  path.setAttribute(\"d\", data.path)\n  collection.appendChild(sym)\n}\n","import crel from \"crelt\"\nimport {lift, joinUp, selectParentNode, wrapIn, setBlockType} from \"prosemirror-commands\"\nimport {undo, redo} from \"prosemirror-history\"\n\nimport {getIcon} from \"./icons\"\n\nconst prefix = \"ProseMirror-menu\"\n\n// ::- An icon or label that, when clicked, executes a command.\nexport class MenuItem {\n  // :: (MenuItemSpec)\n  constructor(spec) {\n    // :: MenuItemSpec\n    // The spec used to create the menu item.\n    this.spec = spec\n  }\n\n  // :: (EditorView)  {dom: dom.Node, update: (EditorState)  bool}\n  // Renders the icon according to its [display\n  // spec](#menu.MenuItemSpec.display), and adds an event handler which\n  // executes the command when the representation is clicked.\n  render(view) {\n    let spec = this.spec\n    let dom = spec.render ? spec.render(view)\n        : spec.icon ? getIcon(spec.icon)\n        : spec.label ? crel(\"div\", null, translate(view, spec.label))\n        : null\n    if (!dom) throw new RangeError(\"MenuItem without icon or label property\")\n    if (spec.title) {\n      const title = (typeof spec.title === \"function\" ? spec.title(view.state) : spec.title)\n      dom.setAttribute(\"title\", translate(view, title))\n    }\n    if (spec.class) dom.classList.add(spec.class)\n    if (spec.css) dom.style.cssText += spec.css\n\n    dom.addEventListener(\"mousedown\", e => {\n      e.preventDefault()\n      if (!dom.classList.contains(prefix + \"-disabled\"))\n        spec.run(view.state, view.dispatch, view, e)\n    })\n\n    function update(state) {\n      if (spec.select) {\n        let selected = spec.select(state)\n        dom.style.display = selected ? \"\" : \"none\"\n        if (!selected) return false\n      }\n      let enabled = true\n      if (spec.enable) {\n        enabled = spec.enable(state) || false\n        setClass(dom, prefix + \"-disabled\", !enabled)\n      }\n      if (spec.active) {\n        let active = enabled && spec.active(state) || false\n        setClass(dom, prefix + \"-active\", active)\n      }\n      return true\n    }\n\n    return {dom, update}\n  }\n}\n\nfunction translate(view, text) {\n  return view._props.translate ? view._props.translate(text) : text\n}\n\n// MenuItemSpec:: interface\n// The configuration object passed to the `MenuItem` constructor.\n//\n//   run:: (EditorState, (Transaction), EditorView, dom.Event)\n//   The function to execute when the menu item is activated.\n//\n//   select:: ?(EditorState)  bool\n//   Optional function that is used to determine whether the item is\n//   appropriate at the moment. Deselected items will be hidden.\n//\n//   enable:: ?(EditorState)  bool\n//   Function that is used to determine if the item is enabled. If\n//   given and returning false, the item will be given a disabled\n//   styling.\n//\n//   active:: ?(EditorState)  bool\n//   A predicate function to determine whether the item is 'active' (for\n//   example, the item for toggling the strong mark might be active then\n//   the cursor is in strong text).\n//\n//   render:: ?(EditorView)  dom.Node\n//   A function that renders the item. You must provide either this,\n//   [`icon`](#menu.MenuItemSpec.icon), or [`label`](#MenuItemSpec.label).\n//\n//   icon:: ?Object\n//   Describes an icon to show for this item. The object may specify\n//   an SVG icon, in which case its `path` property should be an [SVG\n//   path\n//   spec](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d),\n//   and `width` and `height` should provide the viewbox in which that\n//   path exists. Alternatively, it may have a `text` property\n//   specifying a string of text that makes up the icon, with an\n//   optional `css` property giving additional CSS styling for the\n//   text. _Or_ it may contain `dom` property containing a DOM node.\n//\n//   label:: ?string\n//   Makes the item show up as a text label. Mostly useful for items\n//   wrapped in a [drop-down](#menu.Dropdown) or similar menu. The object\n//   should have a `label` property providing the text to display.\n//\n//   title:: ?union<string, (EditorState)  string>\n//   Defines DOM title (mouseover) text for the item.\n//\n//   class:: ?string\n//   Optionally adds a CSS class to the item's DOM representation.\n//\n//   css:: ?string\n//   Optionally adds a string of inline CSS to the item's DOM\n//   representation.\n\nlet lastMenuEvent = {time: 0, node: null}\nfunction markMenuEvent(e) {\n  lastMenuEvent.time = Date.now()\n  lastMenuEvent.node = e.target\n}\nfunction isMenuEvent(wrapper) {\n  return Date.now() - 100 < lastMenuEvent.time &&\n    lastMenuEvent.node && wrapper.contains(lastMenuEvent.node)\n}\n\n// ::- A drop-down menu, displayed as a label with a downwards-pointing\n// triangle to the right of it.\nexport class Dropdown {\n  // :: ([MenuElement], ?Object)\n  // Create a dropdown wrapping the elements. Options may include\n  // the following properties:\n  //\n  // **`label`**`: string`\n  //   : The label to show on the drop-down control.\n  //\n  // **`title`**`: string`\n  //   : Sets the\n  //     [`title`](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/title)\n  //     attribute given to the menu control.\n  //\n  // **`class`**`: string`\n  //   : When given, adds an extra CSS class to the menu control.\n  //\n  // **`css`**`: string`\n  //   : When given, adds an extra set of CSS styles to the menu control.\n  constructor(content, options) {\n    this.options = options || {}\n    this.content = Array.isArray(content) ? content : [content]\n  }\n\n  // :: (EditorView)  {dom: dom.Node, update: (EditorState)}\n  // Render the dropdown menu and sub-items.\n  render(view) {\n    let content = renderDropdownItems(this.content, view)\n\n    let label = crel(\"div\", {class: prefix + \"-dropdown \" + (this.options.class || \"\"),\n                             style: this.options.css},\n                     translate(view, this.options.label))\n    if (this.options.title) label.setAttribute(\"title\", translate(view, this.options.title))\n    let wrap = crel(\"div\", {class: prefix + \"-dropdown-wrap\"}, label)\n    let open = null, listeningOnClose = null\n    let close = () => {\n      if (open && open.close()) {\n        open = null\n        window.removeEventListener(\"mousedown\", listeningOnClose)\n      }\n    }\n    label.addEventListener(\"mousedown\", e => {\n      e.preventDefault()\n      markMenuEvent(e)\n      if (open) {\n        close()\n      } else {\n        open = this.expand(wrap, content.dom)\n        window.addEventListener(\"mousedown\", listeningOnClose = () => {\n          if (!isMenuEvent(wrap)) close()\n        })\n      }\n    })\n\n    function update(state) {\n      let inner = content.update(state)\n      wrap.style.display = inner ? \"\" : \"none\"\n      return inner\n    }\n\n    return {dom: wrap, update}\n  }\n\n  expand(dom, items) {\n    let menuDOM = crel(\"div\", {class: prefix + \"-dropdown-menu \" + (this.options.class || \"\")}, items)\n\n    let done = false\n    function close() {\n      if (done) return\n      done = true\n      dom.removeChild(menuDOM)\n      return true\n    }\n    dom.appendChild(menuDOM)\n    return {close, node: menuDOM}\n  }\n}\n\nfunction renderDropdownItems(items, view) {\n  let rendered = [], updates = []\n  for (let i = 0; i < items.length; i++) {\n    let {dom, update} = items[i].render(view)\n    rendered.push(crel(\"div\", {class: prefix + \"-dropdown-item\"}, dom))\n    updates.push(update)\n  }\n  return {dom: rendered, update: combineUpdates(updates, rendered)}\n}\n\nfunction combineUpdates(updates, nodes) {\n  return state => {\n    let something = false\n    for (let i = 0; i < updates.length; i++) {\n      let up = updates[i](state)\n      nodes[i].style.display = up ? \"\" : \"none\"\n      if (up) something = true\n    }\n    return something\n  }\n}\n\n// ::- Represents a submenu wrapping a group of elements that start\n// hidden and expand to the right when hovered over or tapped.\nexport class DropdownSubmenu {\n  // :: ([MenuElement], ?Object)\n  // Creates a submenu for the given group of menu elements. The\n  // following options are recognized:\n  //\n  // **`label`**`: string`\n  //   : The label to show on the submenu.\n  constructor(content, options) {\n    this.options = options || {}\n    this.content = Array.isArray(content) ? content : [content]\n  }\n\n  // :: (EditorView)  {dom: dom.Node, update: (EditorState)  bool}\n  // Renders the submenu.\n  render(view) {\n    let items = renderDropdownItems(this.content, view)\n\n    let label = crel(\"div\", {class: prefix + \"-submenu-label\"}, translate(view, this.options.label))\n    let wrap = crel(\"div\", {class: prefix + \"-submenu-wrap\"}, label,\n                   crel(\"div\", {class: prefix + \"-submenu\"}, items.dom))\n    let listeningOnClose = null\n    label.addEventListener(\"mousedown\", e => {\n      e.preventDefault()\n      markMenuEvent(e)\n      setClass(wrap, prefix + \"-submenu-wrap-active\")\n      if (!listeningOnClose)\n        window.addEventListener(\"mousedown\", listeningOnClose = () => {\n          if (!isMenuEvent(wrap)) {\n            wrap.classList.remove(prefix + \"-submenu-wrap-active\")\n            window.removeEventListener(\"mousedown\", listeningOnClose)\n            listeningOnClose = null\n          }\n        })\n    })\n\n    function update(state) {\n      let inner = items.update(state)\n      wrap.style.display = inner ? \"\" : \"none\"\n      return inner\n    }\n    return {dom: wrap, update}\n  }\n}\n\n// :: (EditorView, [union<MenuElement, [MenuElement]>])  {dom: ?dom.DocumentFragment, update: (EditorState)  bool}\n// Render the given, possibly nested, array of menu elements into a\n// document fragment, placing separators between them (and ensuring no\n// superfluous separators appear when some of the groups turn out to\n// be empty).\nexport function renderGrouped(view, content) {\n  let result = document.createDocumentFragment()\n  let updates = [], separators = []\n  for (let i = 0; i < content.length; i++) {\n    let items = content[i], localUpdates = [], localNodes = []\n    for (let j = 0; j < items.length; j++) {\n      let {dom, update} = items[j].render(view)\n      let span = crel(\"span\", {class: prefix + \"item\"}, dom)\n      result.appendChild(span)\n      localNodes.push(span)\n      localUpdates.push(update)\n    }\n    if (localUpdates.length) {\n      updates.push(combineUpdates(localUpdates, localNodes))\n      if (i < content.length - 1)\n        separators.push(result.appendChild(separator()))\n    }\n  }\n\n  function update(state) {\n    let something = false, needSep = false\n    for (let i = 0; i < updates.length; i++) {\n      let hasContent = updates[i](state)\n      if (i) separators[i - 1].style.display = needSep && hasContent ? \"\" : \"none\"\n      needSep = hasContent\n      if (hasContent) something = true\n    }\n    return something\n  }\n  return {dom: result, update}\n}\n\nfunction separator() {\n  return crel(\"span\", {class: prefix + \"separator\"})\n}\n\n// :: Object\n// A set of basic editor-related icons. Contains the properties\n// `join`, `lift`, `selectParentNode`, `undo`, `redo`, `strong`, `em`,\n// `code`, `link`, `bulletList`, `orderedList`, and `blockquote`, each\n// holding an object that can be used as the `icon` option to\n// `MenuItem`.\nexport const icons = {\n  join: {\n    width: 800, height: 900,\n    path: \"M0 75h800v125h-800z M0 825h800v-125h-800z M250 400h100v-100h100v100h100v100h-100v100h-100v-100h-100z\"\n  },\n  lift: {\n    width: 1024, height: 1024,\n    path: \"M219 310v329q0 7-5 12t-12 5q-8 0-13-5l-164-164q-5-5-5-13t5-13l164-164q5-5 13-5 7 0 12 5t5 12zM1024 749v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12zM1024 530v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 310v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 91v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12z\"\n  },\n  selectParentNode: {text: \"\\u2b1a\", css: \"font-weight: bold\"},\n  undo: {\n    width: 1024, height: 1024,\n    path: \"M761 1024c113-206 132-520-313-509v253l-384-384 384-384v248c534-13 594 472 313 775z\"\n  },\n  redo: {\n    width: 1024, height: 1024,\n    path: \"M576 248v-248l384 384-384 384v-253c-446-10-427 303-313 509-280-303-221-789 313-775z\"\n  },\n  strong: {\n    width: 805, height: 1024,\n    path: \"M317 869q42 18 80 18 214 0 214-191 0-65-23-102-15-25-35-42t-38-26-46-14-48-6-54-1q-41 0-57 5 0 30-0 90t-0 90q0 4-0 38t-0 55 2 47 6 38zM309 442q24 4 62 4 46 0 81-7t62-25 42-51 14-81q0-40-16-70t-45-46-61-24-70-8q-28 0-74 7 0 28 2 86t2 86q0 15-0 45t-0 45q0 26 0 39zM0 950l1-53q8-2 48-9t60-15q4-6 7-15t4-19 3-18 1-21 0-19v-37q0-561-12-585-2-4-12-8t-25-6-28-4-27-2-17-1l-2-47q56-1 194-6t213-5q13 0 39 0t38 0q40 0 78 7t73 24 61 40 42 59 16 78q0 29-9 54t-22 41-36 32-41 25-48 22q88 20 146 76t58 141q0 57-20 102t-53 74-78 48-93 27-100 8q-25 0-75-1t-75-1q-60 0-175 6t-132 6z\"\n  },\n  em: {\n    width: 585, height: 1024,\n    path: \"M0 949l9-48q3-1 46-12t63-21q16-20 23-57 0-4 35-165t65-310 29-169v-14q-13-7-31-10t-39-4-33-3l10-58q18 1 68 3t85 4 68 1q27 0 56-1t69-4 56-3q-2 22-10 50-17 5-58 16t-62 19q-4 10-8 24t-5 22-4 26-3 24q-15 84-50 239t-44 203q-1 5-7 33t-11 51-9 47-3 32l0 10q9 2 105 17-1 25-9 56-6 0-18 0t-18 0q-16 0-49-5t-49-5q-78-1-117-1-29 0-81 5t-69 6z\"\n  },\n  code: {\n    width: 896, height: 1024,\n    path: \"M608 192l-96 96 224 224-224 224 96 96 288-320-288-320zM288 192l-288 320 288 320 96-96-224-224 224-224-96-96z\"\n  },\n  link: {\n    width: 951, height: 1024,\n    path: \"M832 694q0-22-16-38l-118-118q-16-16-38-16-24 0-41 18 1 1 10 10t12 12 8 10 7 14 2 15q0 22-16 38t-38 16q-8 0-15-2t-14-7-10-8-12-12-10-10q-18 17-18 41 0 22 16 38l117 118q15 15 38 15 22 0 38-14l84-83q16-16 16-38zM430 292q0-22-16-38l-117-118q-16-16-38-16-22 0-38 15l-84 83q-16 16-16 38 0 22 16 38l118 118q15 15 38 15 24 0 41-17-1-1-10-10t-12-12-8-10-7-14-2-15q0-22 16-38t38-16q8 0 15 2t14 7 10 8 12 12 10 10q18-17 18-41zM941 694q0 68-48 116l-84 83q-47 47-116 47-69 0-116-48l-117-118q-47-47-47-116 0-70 50-119l-50-50q-49 50-118 50-68 0-116-48l-118-118q-48-48-48-116t48-116l84-83q47-47 116-47 69 0 116 48l117 118q47 47 47 116 0 70-50 119l50 50q49-50 118-50 68 0 116 48l118 118q48 48 48 116z\"\n  },\n  bulletList: {\n    width: 768, height: 896,\n    path: \"M0 512h128v-128h-128v128zM0 256h128v-128h-128v128zM0 768h128v-128h-128v128zM256 512h512v-128h-512v128zM256 256h512v-128h-512v128zM256 768h512v-128h-512v128z\"\n  },\n  orderedList: {\n    width: 768, height: 896,\n    path: \"M320 512h448v-128h-448v128zM320 768h448v-128h-448v128zM320 128v128h448v-128h-448zM79 384h78v-256h-36l-85 23v50l43-2v185zM189 590c0-36-12-78-96-78-33 0-64 6-83 16l1 66c21-10 42-15 67-15s32 11 32 28c0 26-30 58-110 112v50h192v-67l-91 2c49-30 87-66 87-113l1-1z\"\n  },\n  blockquote: {\n    width: 640, height: 896,\n    path: \"M0 448v256h256v-256h-128c0 0 0-128 128-128v-128c0 0-256 0-256 256zM640 320v-128c0 0-256 0-256 256v256h256v-256h-128c0 0 0-128 128-128z\"\n  }\n}\n\n// :: MenuItem\n// Menu item for the `joinUp` command.\nexport const joinUpItem = new MenuItem({\n  title: \"Join with above block\",\n  run: joinUp,\n  select: state => joinUp(state),\n  icon: icons.join\n})\n\n// :: MenuItem\n// Menu item for the `lift` command.\nexport const liftItem = new MenuItem({\n  title: \"Lift out of enclosing block\",\n  run: lift,\n  select: state => lift(state),\n  icon: icons.lift\n})\n\n// :: MenuItem\n// Menu item for the `selectParentNode` command.\nexport const selectParentNodeItem = new MenuItem({\n  title: \"Select parent node\",\n  run: selectParentNode,\n  select: state => selectParentNode(state),\n  icon: icons.selectParentNode\n})\n\n// :: MenuItem\n// Menu item for the `undo` command.\nexport let undoItem = new MenuItem({\n  title: \"Undo last change\",\n  run: undo,\n  enable: state => undo(state),\n  icon: icons.undo\n})\n\n// :: MenuItem\n// Menu item for the `redo` command.\nexport let redoItem = new MenuItem({\n  title: \"Redo last undone change\",\n  run: redo,\n  enable: state => redo(state),\n  icon: icons.redo\n})\n\n// :: (NodeType, Object)  MenuItem\n// Build a menu item for wrapping the selection in a given node type.\n// Adds `run` and `select` properties to the ones present in\n// `options`. `options.attrs` may be an object or a function.\nexport function wrapItem(nodeType, options) {\n  let passedOptions = {\n    run(state, dispatch) {\n      // FIXME if (options.attrs instanceof Function) options.attrs(state, attrs => wrapIn(nodeType, attrs)(state))\n      return wrapIn(nodeType, options.attrs)(state, dispatch)\n    },\n    select(state) {\n      return wrapIn(nodeType, options.attrs instanceof Function ? null : options.attrs)(state)\n    }\n  }\n  for (let prop in options) passedOptions[prop] = options[prop]\n  return new MenuItem(passedOptions)\n}\n\n// :: (NodeType, Object)  MenuItem\n// Build a menu item for changing the type of the textblock around the\n// selection to the given type. Provides `run`, `active`, and `select`\n// properties. Others must be given in `options`. `options.attrs` may\n// be an object to provide the attributes for the textblock node.\nexport function blockTypeItem(nodeType, options) {\n  let command = setBlockType(nodeType, options.attrs)\n  let passedOptions = {\n    run: command,\n    enable(state) { return command(state) },\n    active(state) {\n      let {$from, to, node} = state.selection\n      if (node) return node.hasMarkup(nodeType, options.attrs)\n      return to <= $from.end() && $from.parent.hasMarkup(nodeType, options.attrs)\n    }\n  }\n  for (let prop in options) passedOptions[prop] = options[prop]\n  return new MenuItem(passedOptions)\n}\n\n// Work around classList.toggle being broken in IE11\nfunction setClass(dom, cls, on) {\n  if (on) dom.classList.add(cls)\n  else dom.classList.remove(cls)\n}\n","import crel from \"crelt\"\nimport {Plugin} from \"prosemirror-state\"\n\nimport {renderGrouped} from \"./menu\"\n\nconst prefix = \"ProseMirror-menubar\"\n\nfunction isIOS() {\n  if (typeof navigator == \"undefined\") return false\n  let agent = navigator.userAgent\n  return !/Edge\\/\\d/.test(agent) && /AppleWebKit/.test(agent) && /Mobile\\/\\w+/.test(agent)\n}\n\n// :: (Object)  Plugin\n// A plugin that will place a menu bar above the editor. Note that\n// this involves wrapping the editor in an additional `<div>`.\n//\n//   options::-\n//   Supports the following options:\n//\n//     content:: [[MenuElement]]\n//     Provides the content of the menu, as a nested array to be\n//     passed to `renderGrouped`.\n//\n//     floating:: ?bool\n//     Determines whether the menu floats, i.e. whether it sticks to\n//     the top of the viewport when the editor is partially scrolled\n//     out of view.\nexport function menuBar(options) {\n  return new Plugin({\n    view(editorView) { return new MenuBarView(editorView, options) }\n  })\n}\n\nclass MenuBarView {\n  constructor(editorView, options) {\n    this.editorView = editorView\n    this.options = options\n\n    this.wrapper = crel(\"div\", {class: prefix + \"-wrapper\"})\n    this.menu = this.wrapper.appendChild(crel(\"div\", {class: prefix}))\n    this.menu.className = prefix\n    this.spacer = null\n\n    editorView.dom.parentNode.replaceChild(this.wrapper, editorView.dom)\n    this.wrapper.appendChild(editorView.dom)\n\n    this.maxHeight = 0\n    this.widthForMaxHeight = 0\n    this.floating = false\n\n    let {dom, update} = renderGrouped(this.editorView, this.options.content)\n    this.contentUpdate = update\n    this.menu.appendChild(dom)\n    this.update()\n\n    if (options.floating && !isIOS()) {\n      this.updateFloat()\n      let potentialScrollers = getAllWrapping(this.wrapper)\n      this.scrollFunc = (e) => {\n        let root = this.editorView.root\n        if (!(root.body || root).contains(this.wrapper)) {\n            potentialScrollers.forEach(el => el.removeEventListener(\"scroll\", this.scrollFunc))\n        } else {\n            this.updateFloat(e.target.getBoundingClientRect && e.target)\n        }\n      }\n      potentialScrollers.forEach(el => el.addEventListener('scroll', this.scrollFunc))\n    }\n  }\n\n  update() {\n    this.contentUpdate(this.editorView.state)\n\n    if (this.floating) {\n      this.updateScrollCursor()\n    } else {\n      if (this.menu.offsetWidth != this.widthForMaxHeight) {\n        this.widthForMaxHeight = this.menu.offsetWidth\n        this.maxHeight = 0\n      }\n      if (this.menu.offsetHeight > this.maxHeight) {\n        this.maxHeight = this.menu.offsetHeight\n        this.menu.style.minHeight = this.maxHeight + \"px\"\n      }\n    }\n  }\n\n  updateScrollCursor() {\n    let selection = this.editorView.root.getSelection()\n    if (!selection.focusNode) return\n    let rects = selection.getRangeAt(0).getClientRects()\n    let selRect = rects[selectionIsInverted(selection) ? 0 : rects.length - 1]\n    if (!selRect) return\n    let menuRect = this.menu.getBoundingClientRect()\n    if (selRect.top < menuRect.bottom && selRect.bottom > menuRect.top) {\n      let scrollable = findWrappingScrollable(this.wrapper)\n      if (scrollable) scrollable.scrollTop -= (menuRect.bottom - selRect.top)\n    }\n  }\n\n  updateFloat(scrollAncestor) {\n    let parent = this.wrapper, editorRect = parent.getBoundingClientRect(),\n        top = scrollAncestor ? Math.max(0, scrollAncestor.getBoundingClientRect().top) : 0\n\n    if (this.floating) {\n      if (editorRect.top >= top || editorRect.bottom < this.menu.offsetHeight + 10) {\n        this.floating = false\n        this.menu.style.position = this.menu.style.left = this.menu.style.top = this.menu.style.width = \"\"\n        this.menu.style.display = \"\"\n        this.spacer.parentNode.removeChild(this.spacer)\n        this.spacer = null\n      } else {\n        let border = (parent.offsetWidth - parent.clientWidth) / 2\n        this.menu.style.left = (editorRect.left + border) + \"px\"\n        this.menu.style.display = (editorRect.top > window.innerHeight ? \"none\" : \"\")\n        if (scrollAncestor) this.menu.style.top = top + \"px\"\n      }\n    } else {\n      if (editorRect.top < top && editorRect.bottom >= this.menu.offsetHeight + 10) {\n        this.floating = true\n        let menuRect = this.menu.getBoundingClientRect()\n        this.menu.style.left = menuRect.left + \"px\"\n        this.menu.style.width = menuRect.width + \"px\"\n        if (scrollAncestor) this.menu.style.top = top + \"px\"\n        this.menu.style.position = \"fixed\"\n        this.spacer = crel(\"div\", {class: prefix + \"-spacer\", style: `height: ${menuRect.height}px`})\n        parent.insertBefore(this.spacer, this.menu)\n      }\n    }\n  }\n\n  destroy() {\n    if (this.wrapper.parentNode)\n      this.wrapper.parentNode.replaceChild(this.editorView.dom, this.wrapper)\n  }\n}\n\n// Not precise, but close enough\nfunction selectionIsInverted(selection) {\n  if (selection.anchorNode == selection.focusNode) return selection.anchorOffset > selection.focusOffset\n  return selection.anchorNode.compareDocumentPosition(selection.focusNode) == Node.DOCUMENT_POSITION_FOLLOWING\n}\n\nfunction findWrappingScrollable(node) {\n  for (let cur = node.parentNode; cur; cur = cur.parentNode)\n    if (cur.scrollHeight > cur.clientHeight) return cur\n}\n\nfunction getAllWrapping(node) {\n    let res = [window]\n    for (let cur = node.parentNode; cur; cur = cur.parentNode)\n        res.push(cur)\n    return res\n}\n","import {findWrapping, liftTarget, canSplit, ReplaceAroundStep} from \"prosemirror-transform\"\nimport {Slice, Fragment, NodeRange} from \"prosemirror-model\"\n\nconst olDOM = [\"ol\", 0], ulDOM = [\"ul\", 0], liDOM = [\"li\", 0]\n\n// :: NodeSpec\n// An ordered list [node spec](#model.NodeSpec). Has a single\n// attribute, `order`, which determines the number at which the list\n// starts counting, and defaults to 1. Represented as an `<ol>`\n// element.\nexport const orderedList = {\n  attrs: {order: {default: 1}},\n  parseDOM: [{tag: \"ol\", getAttrs(dom) {\n    return {order: dom.hasAttribute(\"start\") ? +dom.getAttribute(\"start\") : 1}\n  }}],\n  toDOM(node) {\n    return node.attrs.order == 1 ? olDOM : [\"ol\", {start: node.attrs.order}, 0]\n  }\n}\n\n// :: NodeSpec\n// A bullet list node spec, represented in the DOM as `<ul>`.\nexport const bulletList = {\n  parseDOM: [{tag: \"ul\"}],\n  toDOM() { return ulDOM }\n}\n\n// :: NodeSpec\n// A list item (`<li>`) spec.\nexport const listItem = {\n  parseDOM: [{tag: \"li\"}],\n  toDOM() { return liDOM },\n  defining: true\n}\n\nfunction add(obj, props) {\n  let copy = {}\n  for (let prop in obj) copy[prop] = obj[prop]\n  for (let prop in props) copy[prop] = props[prop]\n  return copy\n}\n\n// :: (OrderedMap<NodeSpec>, string, ?string)  OrderedMap<NodeSpec>\n// Convenience function for adding list-related node types to a map\n// specifying the nodes for a schema. Adds\n// [`orderedList`](#schema-list.orderedList) as `\"ordered_list\"`,\n// [`bulletList`](#schema-list.bulletList) as `\"bullet_list\"`, and\n// [`listItem`](#schema-list.listItem) as `\"list_item\"`.\n//\n// `itemContent` determines the content expression for the list items.\n// If you want the commands defined in this module to apply to your\n// list structure, it should have a shape like `\"paragraph block*\"` or\n// `\"paragraph (ordered_list | bullet_list)*\"`. `listGroup` can be\n// given to assign a group name to the list node types, for example\n// `\"block\"`.\nexport function addListNodes(nodes, itemContent, listGroup) {\n  return nodes.append({\n    ordered_list: add(orderedList, {content: \"list_item+\", group: listGroup}),\n    bullet_list: add(bulletList, {content: \"list_item+\", group: listGroup}),\n    list_item: add(listItem, {content: itemContent})\n  })\n}\n\n// :: (NodeType, ?Object)  (state: EditorState, dispatch: ?(tr: Transaction))  bool\n// Returns a command function that wraps the selection in a list with\n// the given type an attributes. If `dispatch` is null, only return a\n// value to indicate whether this is possible, but don't actually\n// perform the change.\nexport function wrapInList(listType, attrs) {\n  return function(state, dispatch) {\n    let {$from, $to} = state.selection\n    let range = $from.blockRange($to), doJoin = false, outerRange = range\n    if (!range) return false\n    // This is at the top of an existing list item\n    if (range.depth >= 2 && $from.node(range.depth - 1).type.compatibleContent(listType) && range.startIndex == 0) {\n      // Don't do anything if this is the top of the list\n      if ($from.index(range.depth - 1) == 0) return false\n      let $insert = state.doc.resolve(range.start - 2)\n      outerRange = new NodeRange($insert, $insert, range.depth)\n      if (range.endIndex < range.parent.childCount)\n        range = new NodeRange($from, state.doc.resolve($to.end(range.depth)), range.depth)\n      doJoin = true\n    }\n    let wrap = findWrapping(outerRange, listType, attrs, range)\n    if (!wrap) return false\n    if (dispatch) dispatch(doWrapInList(state.tr, range, wrap, doJoin, listType).scrollIntoView())\n    return true\n  }\n}\n\nfunction doWrapInList(tr, range, wrappers, joinBefore, listType) {\n  let content = Fragment.empty\n  for (let i = wrappers.length - 1; i >= 0; i--)\n    content = Fragment.from(wrappers[i].type.create(wrappers[i].attrs, content))\n\n  tr.step(new ReplaceAroundStep(range.start - (joinBefore ? 2 : 0), range.end, range.start, range.end,\n                                new Slice(content, 0, 0), wrappers.length, true))\n\n  let found = 0\n  for (let i = 0; i < wrappers.length; i++) if (wrappers[i].type == listType) found = i + 1\n  let splitDepth = wrappers.length - found\n\n  let splitPos = range.start + wrappers.length - (joinBefore ? 2 : 0), parent = range.parent\n  for (let i = range.startIndex, e = range.endIndex, first = true; i < e; i++, first = false) {\n    if (!first && canSplit(tr.doc, splitPos, splitDepth)) {\n      tr.split(splitPos, splitDepth)\n      splitPos += 2 * splitDepth\n    }\n    splitPos += parent.child(i).nodeSize\n  }\n  return tr\n}\n\n// :: (NodeType)  (state: EditorState, dispatch: ?(tr: Transaction))  bool\n// Build a command that splits a non-empty textblock at the top level\n// of a list item by also splitting that list item.\nexport function splitListItem(itemType) {\n  return function(state, dispatch) {\n    let {$from, $to, node} = state.selection\n    if ((node && node.isBlock) || $from.depth < 2 || !$from.sameParent($to)) return false\n    let grandParent = $from.node(-1)\n    if (grandParent.type != itemType) return false\n    if ($from.parent.content.size == 0) {\n      // In an empty block. If this is a nested list, the wrapping\n      // list item should be split. Otherwise, bail out and let next\n      // command handle lifting.\n      if ($from.depth == 2 || $from.node(-3).type != itemType ||\n          $from.index(-2) != $from.node(-2).childCount - 1) return false\n      if (dispatch) {\n        let wrap = Fragment.empty, keepItem = $from.index(-1) > 0\n        // Build a fragment containing empty versions of the structure\n        // from the outer list item to the parent node of the cursor\n        for (let d = $from.depth - (keepItem ? 1 : 2); d >= $from.depth - 3; d--)\n          wrap = Fragment.from($from.node(d).copy(wrap))\n        // Add a second list item with an empty default start node\n        wrap = wrap.append(Fragment.from(itemType.createAndFill()))\n        let tr = state.tr.replace($from.before(keepItem ? null : -1), $from.after(-3), new Slice(wrap, keepItem ? 3 : 2, 2))\n        tr.setSelection(state.selection.constructor.near(tr.doc.resolve($from.pos + (keepItem ? 3 : 2))))\n        dispatch(tr.scrollIntoView())\n      }\n      return true\n    }\n    let nextType = $to.pos == $from.end() ? grandParent.contentMatchAt(0).defaultType : null\n    let tr = state.tr.delete($from.pos, $to.pos)\n    let types = nextType && [null, {type: nextType}]\n    if (!canSplit(tr.doc, $from.pos, 2, types)) return false\n    if (dispatch) dispatch(tr.split($from.pos, 2, types).scrollIntoView())\n    return true\n  }\n}\n\n// :: (NodeType)  (state: EditorState, dispatch: ?(tr: Transaction))  bool\n// Create a command to lift the list item around the selection up into\n// a wrapping list.\nexport function liftListItem(itemType) {\n  return function(state, dispatch) {\n    let {$from, $to} = state.selection\n    let range = $from.blockRange($to, node => node.childCount && node.firstChild.type == itemType)\n    if (!range) return false\n    if (!dispatch) return true\n    if ($from.node(range.depth - 1).type == itemType) // Inside a parent list\n      return liftToOuterList(state, dispatch, itemType, range)\n    else // Outer list node\n      return liftOutOfList(state, dispatch, range)\n  }\n}\n\nfunction liftToOuterList(state, dispatch, itemType, range) {\n  let tr = state.tr, end = range.end, endOfList = range.$to.end(range.depth)\n  if (end < endOfList) {\n    // There are siblings after the lifted items, which must become\n    // children of the last item\n    tr.step(new ReplaceAroundStep(end - 1, endOfList, end, endOfList,\n                                  new Slice(Fragment.from(itemType.create(null, range.parent.copy())), 1, 0), 1, true))\n    range = new NodeRange(tr.doc.resolve(range.$from.pos), tr.doc.resolve(endOfList), range.depth)\n  }\n  dispatch(tr.lift(range, liftTarget(range)).scrollIntoView())\n  return true\n}\n\nfunction liftOutOfList(state, dispatch, range) {\n  let tr = state.tr, list = range.parent\n  // Merge the list items into a single big item\n  for (let pos = range.end, i = range.endIndex - 1, e = range.startIndex; i > e; i--) {\n    pos -= list.child(i).nodeSize\n    tr.delete(pos - 1, pos + 1)\n  }\n  let $start = tr.doc.resolve(range.start), item = $start.nodeAfter\n  let atStart = range.startIndex == 0, atEnd = range.endIndex == list.childCount\n  let parent = $start.node(-1), indexBefore = $start.index(-1)\n  if (!parent.canReplace(indexBefore + (atStart ? 0 : 1), indexBefore + 1,\n                         item.content.append(atEnd ? Fragment.empty : Fragment.from(list))))\n    return false\n  let start = $start.pos, end = start + item.nodeSize\n  // Strip off the surrounding list. At the sides where we're not at\n  // the end of the list, the existing list is closed. At sides where\n  // this is the end, it is overwritten to its end.\n  tr.step(new ReplaceAroundStep(start - (atStart ? 1 : 0), end + (atEnd ? 1 : 0), start + 1, end - 1,\n                                new Slice((atStart ? Fragment.empty : Fragment.from(list.copy(Fragment.empty)))\n                                          .append(atEnd ? Fragment.empty : Fragment.from(list.copy(Fragment.empty))),\n                                          atStart ? 0 : 1, atEnd ? 0 : 1), atStart ? 0 : 1))\n  dispatch(tr.scrollIntoView())\n  return true\n}\n\n// :: (NodeType)  (state: EditorState, dispatch: ?(tr: Transaction))  bool\n// Create a command to sink the list item around the selection down\n// into an inner list.\nexport function sinkListItem(itemType) {\n  return function(state, dispatch) {\n    let {$from, $to} = state.selection\n    let range = $from.blockRange($to, node => node.childCount && node.firstChild.type == itemType)\n    if (!range) return false\n    let startIndex = range.startIndex\n    if (startIndex == 0) return false\n    let parent = range.parent, nodeBefore = parent.child(startIndex - 1)\n    if (nodeBefore.type != itemType) return false\n\n    if (dispatch) {\n      let nestedBefore = nodeBefore.lastChild && nodeBefore.lastChild.type == parent.type\n      let inner = Fragment.from(nestedBefore ? itemType.create() : null)\n      let slice = new Slice(Fragment.from(itemType.create(null, Fragment.from(parent.type.create(null, inner)))),\n                            nestedBefore ? 3 : 1, 0)\n      let before = range.start, after = range.end\n      dispatch(state.tr.step(new ReplaceAroundStep(before - (nestedBefore ? 3 : 1), after,\n                                                   before, after, slice, 1, true))\n               .scrollIntoView())\n    }\n    return true\n  }\n}\n","import {Plugin} from \"prosemirror-state\"\n\n// ::- Input rules are regular expressions describing a piece of text\n// that, when typed, causes something to happen. This might be\n// changing two dashes into an emdash, wrapping a paragraph starting\n// with `\"> \"` into a blockquote, or something entirely different.\nexport class InputRule {\n  // :: (RegExp, union<string, (state: EditorState, match: [string], start: number, end: number)  ?Transaction>)\n  // Create an input rule. The rule applies when the user typed\n  // something and the text directly in front of the cursor matches\n  // `match`, which should probably end with `$`.\n  //\n  // The `handler` can be a string, in which case the matched text, or\n  // the first matched group in the regexp, is replaced by that\n  // string.\n  //\n  // Or a it can be a function, which will be called with the match\n  // array produced by\n  // [`RegExp.exec`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/exec),\n  // as well as the start and end of the matched range, and which can\n  // return a [transaction](#state.Transaction) that describes the\n  // rule's effect, or null to indicate the input was not handled.\n  constructor(match, handler) {\n    this.match = match\n    this.handler = typeof handler == \"string\" ? stringHandler(handler) : handler\n  }\n}\n\nfunction stringHandler(string) {\n  return function(state, match, start, end) {\n    let insert = string\n    if (match[1]) {\n      let offset = match[0].lastIndexOf(match[1])\n      insert += match[0].slice(offset + match[1].length)\n      start += offset\n      let cutOff = start - end\n      if (cutOff > 0) {\n        insert = match[0].slice(offset - cutOff, offset) + insert\n        start = end\n      }\n    }\n    return state.tr.insertText(insert, start, end)\n  }\n}\n\nconst MAX_MATCH = 500\n\n// :: (config: {rules: [InputRule]})  Plugin\n// Create an input rules plugin. When enabled, it will cause text\n// input that matches any of the given rules to trigger the rule's\n// action.\nexport function inputRules({rules}) {\n  let plugin = new Plugin({\n    state: {\n      init() { return null },\n      apply(tr, prev) {\n        let stored = tr.getMeta(this)\n        if (stored) return stored\n        return tr.selectionSet || tr.docChanged ? null : prev\n      }\n    },\n\n    props: {\n      handleTextInput(view, from, to, text) {\n        return run(view, from, to, text, rules, plugin)\n      },\n      handleDOMEvents: {\n        compositionend: (view) => {\n          setTimeout(() => {\n            let {$cursor} = view.state.selection\n            if ($cursor) run(view, $cursor.pos, $cursor.pos, \"\", rules, plugin)\n          })\n        }\n      }\n    },\n\n    isInputRules: true\n  })\n  return plugin\n}\n\nfunction run(view, from, to, text, rules, plugin) {\n  if (view.composing) return false\n  let state = view.state, $from = state.doc.resolve(from)\n  if ($from.parent.type.spec.code) return false\n  let textBefore = $from.parent.textBetween(Math.max(0, $from.parentOffset - MAX_MATCH), $from.parentOffset,\n                                            null, \"\\ufffc\") + text\n  for (let i = 0; i < rules.length; i++) {\n    let match = rules[i].match.exec(textBefore)\n    let tr = match && rules[i].handler(state, match, from - (match[0].length - text.length), to)\n    if (!tr) continue\n    view.dispatch(tr.setMeta(plugin, {transform: tr, from, to, text}))\n    return true\n  }\n  return false\n}\n\n// :: (EditorState, ?(Transaction))  bool\n// This is a command that will undo an input rule, if applying such a\n// rule was the last thing that the user did.\nexport function undoInputRule(state, dispatch) {\n  let plugins = state.plugins\n  for (let i = 0; i < plugins.length; i++) {\n    let plugin = plugins[i], undoable\n    if (plugin.spec.isInputRules && (undoable = plugin.getState(state))) {\n      if (dispatch) {\n        let tr = state.tr, toUndo = undoable.transform\n        for (let j = toUndo.steps.length - 1; j >= 0; j--)\n          tr.step(toUndo.steps[j].invert(toUndo.docs[j]))\n        let marks = tr.doc.resolve(undoable.from).marks()\n        dispatch(tr.replaceWith(undoable.from, undoable.to, state.schema.text(undoable.text, marks)))\n      }\n      return true\n    }\n  }\n  return false\n}\n","import {InputRule} from \"./inputrules\"\n\n// :: InputRule Converts double dashes to an emdash.\nexport const emDash = new InputRule(/--$/, \"\")\n// :: InputRule Converts three dots to an ellipsis character.\nexport const ellipsis = new InputRule(/\\.\\.\\.$/, \"\")\n// :: InputRule Smart opening double quotes.\nexport const openDoubleQuote = new InputRule(/(?:^|[\\s\\{\\[\\(\\<'\"\\u2018\\u201C])(\")$/, \"\")\n// :: InputRule Smart closing double quotes.\nexport const closeDoubleQuote = new InputRule(/\"$/, \"\")\n// :: InputRule Smart opening single quotes.\nexport const openSingleQuote = new InputRule(/(?:^|[\\s\\{\\[\\(\\<'\"\\u2018\\u201C])(')$/, \"\")\n// :: InputRule Smart closing single quotes.\nexport const closeSingleQuote = new InputRule(/'$/, \"\")\n\n// :: [InputRule] Smart-quote related input rules.\nexport const smartQuotes = [openDoubleQuote, closeDoubleQuote, openSingleQuote, closeSingleQuote]\n","import {InputRule} from \"./inputrules\"\nimport {findWrapping, canJoin} from \"prosemirror-transform\"\n\n// :: (RegExp, NodeType, ?union<Object, ([string])  ?Object>, ?([string], Node)  bool)  InputRule\n// Build an input rule for automatically wrapping a textblock when a\n// given string is typed. The `regexp` argument is\n// directly passed through to the `InputRule` constructor. You'll\n// probably want the regexp to start with `^`, so that the pattern can\n// only occur at the start of a textblock.\n//\n// `nodeType` is the type of node to wrap in. If it needs attributes,\n// you can either pass them directly, or pass a function that will\n// compute them from the regular expression match.\n//\n// By default, if there's a node with the same type above the newly\n// wrapped node, the rule will try to [join](#transform.Transform.join) those\n// two nodes. You can pass a join predicate, which takes a regular\n// expression match and the node before the wrapped node, and can\n// return a boolean to indicate whether a join should happen.\nexport function wrappingInputRule(regexp, nodeType, getAttrs, joinPredicate) {\n  return new InputRule(regexp, (state, match, start, end) => {\n    let attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs\n    let tr = state.tr.delete(start, end)\n    let $start = tr.doc.resolve(start), range = $start.blockRange(), wrapping = range && findWrapping(range, nodeType, attrs)\n    if (!wrapping) return null\n    tr.wrap(range, wrapping)\n    let before = tr.doc.resolve(start - 1).nodeBefore\n    if (before && before.type == nodeType && canJoin(tr.doc, start - 1) &&\n        (!joinPredicate || joinPredicate(match, before)))\n      tr.join(start - 1)\n    return tr\n  })\n}\n\n// :: (RegExp, NodeType, ?union<Object, ([string])  ?Object>)  InputRule\n// Build an input rule that changes the type of a textblock when the\n// matched text is typed into it. You'll usually want to start your\n// regexp with `^` to that it is only matched at the start of a\n// textblock. The optional `getAttrs` parameter can be used to compute\n// the new node's attributes, and works the same as in the\n// `wrappingInputRule` function.\nexport function textblockTypeInputRule(regexp, nodeType, getAttrs) {\n  return new InputRule(regexp, (state, match, start, end) => {\n    let $start = state.doc.resolve(start)\n    let attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs\n    if (!$start.node(-1).canReplaceWith($start.index(-1), $start.indexAfter(-1), nodeType)) return null\n    return state.tr\n      .delete(start, end)\n      .setBlockType(start, start, nodeType, attrs)\n  })\n}\n","const prefix = \"ProseMirror-prompt\"\n\nexport function openPrompt(options) {\n  let wrapper = document.body.appendChild(document.createElement(\"div\"))\n  wrapper.className = prefix\n\n  let mouseOutside = e => { if (!wrapper.contains(e.target)) close() }\n  setTimeout(() => window.addEventListener(\"mousedown\", mouseOutside), 50)\n  let close = () => {\n    window.removeEventListener(\"mousedown\", mouseOutside)\n    if (wrapper.parentNode) wrapper.parentNode.removeChild(wrapper)\n  }\n\n  let domFields = []\n  for (let name in options.fields) domFields.push(options.fields[name].render())\n\n  let submitButton = document.createElement(\"button\")\n  submitButton.type = \"submit\"\n  submitButton.className = prefix + \"-submit\"\n  submitButton.textContent = \"OK\"\n  let cancelButton = document.createElement(\"button\")\n  cancelButton.type = \"button\"\n  cancelButton.className = prefix + \"-cancel\"\n  cancelButton.textContent = \"Cancel\"\n  cancelButton.addEventListener(\"click\", close)\n\n  let form = wrapper.appendChild(document.createElement(\"form\"))\n  if (options.title) form.appendChild(document.createElement(\"h5\")).textContent = options.title\n  domFields.forEach(field => {\n    form.appendChild(document.createElement(\"div\")).appendChild(field)\n  })\n  let buttons = form.appendChild(document.createElement(\"div\"))\n  buttons.className = prefix + \"-buttons\"\n  buttons.appendChild(submitButton)\n  buttons.appendChild(document.createTextNode(\" \"))\n  buttons.appendChild(cancelButton)\n\n  let box = wrapper.getBoundingClientRect()\n  wrapper.style.top = ((window.innerHeight - box.height) / 2) + \"px\"\n  wrapper.style.left = ((window.innerWidth - box.width) / 2) + \"px\"\n\n  let submit = () => {\n    let params = getValues(options.fields, domFields)\n    if (params) {\n      close()\n      options.callback(params)\n    }\n  }\n\n  form.addEventListener(\"submit\", e => {\n    e.preventDefault()\n    submit()\n  })\n\n  form.addEventListener(\"keydown\", e => {\n    if (e.keyCode == 27) {\n      e.preventDefault()\n      close()\n    } else if (e.keyCode == 13 && !(e.ctrlKey || e.metaKey || e.shiftKey)) {\n      e.preventDefault()\n      submit()\n    } else if (e.keyCode == 9) {\n      window.setTimeout(() => {\n        if (!wrapper.contains(document.activeElement)) close()\n      }, 500)\n    }\n  })\n\n  let input = form.elements[0]\n  if (input) input.focus()\n}\n\nfunction getValues(fields, domFields) {\n  let result = Object.create(null), i = 0\n  for (let name in fields) {\n    let field = fields[name], dom = domFields[i++]\n    let value = field.read(dom), bad = field.validate(value)\n    if (bad) {\n      reportInvalid(dom, bad)\n      return null\n    }\n    result[name] = field.clean(value)\n  }\n  return result\n}\n\nfunction reportInvalid(dom, message) {\n  // FIXME this is awful and needs a lot more work\n  let parent = dom.parentNode\n  let msg = parent.appendChild(document.createElement(\"div\"))\n  msg.style.left = (dom.offsetLeft + dom.offsetWidth + 2) + \"px\"\n  msg.style.top = (dom.offsetTop - 5) + \"px\"\n  msg.className = \"ProseMirror-invalid\"\n  msg.textContent = message\n  setTimeout(() => parent.removeChild(msg), 1500)\n}\n\n// ::- The type of field that `FieldPrompt` expects to be passed to it.\nexport class Field {\n  // :: (Object)\n  // Create a field with the given options. Options support by all\n  // field types are:\n  //\n  // **`value`**`: ?any`\n  //   : The starting value for the field.\n  //\n  // **`label`**`: string`\n  //   : The label for the field.\n  //\n  // **`required`**`: ?bool`\n  //   : Whether the field is required.\n  //\n  // **`validate`**`: ?(any)  ?string`\n  //   : A function to validate the given value. Should return an\n  //     error message if it is not valid.\n  constructor(options) { this.options = options }\n\n  // render:: (state: EditorState, props: Object)  dom.Node\n  // Render the field to the DOM. Should be implemented by all subclasses.\n\n  // :: (dom.Node)  any\n  // Read the field's value from its DOM node.\n  read(dom) { return dom.value }\n\n  // :: (any)  ?string\n  // A field-type-specific validation function.\n  validateType(_value) {}\n\n  validate(value) {\n    if (!value && this.options.required)\n      return \"Required field\"\n    return this.validateType(value) || (this.options.validate && this.options.validate(value))\n  }\n\n  clean(value) {\n    return this.options.clean ? this.options.clean(value) : value\n  }\n}\n\n// ::- A field class for single-line text fields.\nexport class TextField extends Field {\n  render() {\n    let input = document.createElement(\"input\")\n    input.type = \"text\"\n    input.placeholder = this.options.label\n    input.value = this.options.value || \"\"\n    input.autocomplete = \"off\"\n    return input\n  }\n}\n\n\n// ::- A field class for dropdown fields based on a plain `<select>`\n// tag. Expects an option `options`, which should be an array of\n// `{value: string, label: string}` objects, or a function taking a\n// `ProseMirror` instance and returning such an array.\nexport class SelectField extends Field {\n  render() {\n    let select = document.createElement(\"select\")\n    this.options.options.forEach(o => {\n      let opt = select.appendChild(document.createElement(\"option\"))\n      opt.value = o.value\n      opt.selected = o.value == this.options.value\n      opt.label = o.label\n    })\n    return select\n  }\n}\n","import { Schema, DOMParser } from \"prosemirror-model\";\nimport { EditorState, Plugin, PluginKey, Selection } from \"prosemirror-state\";\nimport { EditorView, DecorationSet, Decoration } from \"prosemirror-view\";\nimport { exampleSetup } from \"prosemirror-example-setup\";\n\nimport \"prosemirror-view/style/prosemirror.css\";\nimport \"prosemirror-example-setup/style/style.css\";\nimport \"./styles.css\";\n\nconst schema = new Schema({\n  marks: {\n    example: {\n      parseDOM: [\n        {\n          tag: \"test-mark\",\n        },\n      ],\n      toDOM: (mark) => [\"span\", { class: \"test-mark\" }],\n    },\n  },\n  nodes: {\n    doc: {\n      content: \"block+\",\n    },\n    paragraph: {\n      group: \"block\",\n      content: \"inline*\",\n      parseDOM: [{ tag: \"p\" }],\n      toDOM: () => [\"p\", 0],\n    },\n    text: {\n      group: \"inline\",\n    },\n  },\n});\n\nconst testDecoToDom = (decoClass, side) => (view, getPos) => {\n  const el = document.createElement(\"span\");\n  el.classList.add(decoClass, \"test-deco\");\n  el.innerHTML = \" \"\n  side <= 0 ? el.style.paddingLeft = '20px' : el.style.paddingRight = '20px'\n  return el;\n};\n\nconst pluginKey = new PluginKey(\"side-test-plugin\");\n\nconst noOfDecos = 3;\nconst decoStartPos = 6;\nconst MODIFY_OFFSET = \"MODIFY_OFFSET\";\nconst DECREMENT_OFFSET = \"DECREMENT\";\nconst INCREMENT_OFFSET = \"INCREMENT\";\n\nconst getSide = (cursorPos, offset, index) =>\n  cursorPos === decoStartPos && offset > index ? -1 : 1;\n\nconst createPluginDecorations = (state, decoClass, index) => {\n  const decos = new Array(noOfDecos).fill(undefined).map((_, index) => {\n    const { offset } = pluginKey.getState(state);\n    const orderOffset = (index + 1) / noOfDecos / 2;\n    const {\n      selection: { from, to },\n    } = state;\n    const isRange = from !== to;\n    const side = isRange ? orderOffset : getSide(from, offset, index);\n    const relativeSide = side + orderOffset;\n    return Decoration.widget(decoStartPos, testDecoToDom(decoClass, relativeSide), {\n      key: Math.random(),\n      side: relativeSide,\n      ignoreSelection: true\n    });\n  });\n\n  // For debugging purposes, to make the decoration sides visible\n  document.getElementById(\n    getDebugId(index)\n  ).innerHTML = `Widget 'side' properties, in render order: ${decos\n    .map((_) => _.spec.side.toString().substring(0, 6))\n    .join(\", \")}`;\n\n  return DecorationSet.create(state.doc, decos);\n};\n\nconst createPlugin = (decoClass, index) =>\n  new Plugin({\n    key: pluginKey,\n    props: {\n      decorations: (state) => createPluginDecorations(state, decoClass, index),\n    },\n    state: {\n      init: (_, state) => {\n        return { offset: 0 };\n      },\n      apply: (tr, plState, oldState, newState) => {\n        const { offset } = plState;\n        const modifyOffset = tr.getMeta(MODIFY_OFFSET);\n        if (!modifyOffset) {\n          return plState;\n        }\n        return {\n          offset: modifyOffset === INCREMENT_OFFSET ? offset + 1 : offset - 1,\n        };\n      },\n    },\n    appendTransaction: (trs, oldState, newState) => {\n      const { offset } = pluginKey.getState(newState);\n      const {\n        selection: { $cursor: $oldCursor },\n      } = oldState;\n      const {\n        selection: { $cursor },\n      } = newState;\n      if (!$cursor || !$oldCursor) {\n        return;\n      }\n      const movement = $cursor.pos - $oldCursor.pos;\n      if (\n        // Haven't moved\n        movement === 0 ||\n        // Just moved into deco position\n        $oldCursor.pos !== decoStartPos\n      ) {\n        return;\n      }\n      if (\n        (movement > 0 && offset < noOfDecos) ||\n        (movement < 0 && offset > 0)\n      ) {\n        const modifyOffset = movement > 0 ? INCREMENT_OFFSET : DECREMENT_OFFSET;\n        const tr = newState.tr\n          .setMeta(MODIFY_OFFSET, modifyOffset)\n          .setSelection(Selection.near(oldState.selection.$cursor));\n        return tr;\n      }\n      return;\n    },\n  });\n\nconst createStateFromContent = (content, decoClass, index) => {\n  const plugin = createPlugin(decoClass, index);\n  return EditorState.create({\n    doc: DOMParser.fromSchema(schema).parse(content),\n    plugins: [...exampleSetup({ schema, menuBar: false }), plugin],\n  });\n};\n\nconst getDebugId = (decoClass) => `debug-${decoClass}`;\n\nconst examples = [\n  [\n    \"Example with decorations only, inline\",\n    \"<p>An example document</p>\",\n    \"test-deco-inline\",\n  ],\n  [\n    \"Example with decorations only, inline-block\",\n    \"<p>An example document</p>\",\n    \"test-deco-inline-block\",\n  ],\n  [\n    \"Example with decorations and mark, inline\",\n    \"<p><test-mark>An ex</test-mark>ample document</p>\",\n    \"test-deco-inline\",\n  ],\n  [\n    \"Example with decorations and mark, inline-block\",\n    \"<p><test-mark>An ex</test-mark>ample document</p>\",\n    \"test-deco-inline-block\",\n  ],\n];\n\nconst root = document.getElementById(\"root\");\n\nexamples.forEach(([description, content, decoClass], index) => {\n  const docRootEl = document.createElement(\"div\");\n  docRootEl.classList.add(\"doc-root\");\n\n  const descriptionEl = document.createElement(\"div\");\n  descriptionEl.innerText = description;\n  descriptionEl.classList.add(\"description\");\n\n  const contentEl = document.createElement(\"div\");\n  contentEl.innerHTML = content;\n\n  const debugEl = document.createElement(\"div\");\n  debugEl.id = getDebugId(index);\n  debugEl.classList.add(\"debug\")\n\n  root.appendChild(descriptionEl);\n  root.appendChild(docRootEl);\n  root.appendChild(debugEl);\n\n  const state = createStateFromContent(contentEl, decoClass, index);\n\n  new EditorView(docRootEl, {\n    state,\n  });\n});\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}